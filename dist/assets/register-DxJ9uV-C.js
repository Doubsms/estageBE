import{r as h,bq as I,j as e,H as B,G as s,S as m,I as q,T as j,bs as w,br as A,Y as f}from"./index-zHPv1lze.js";import{F as R,c as W,E as D,a as N,b as g,A as O}from"./EyeInvisibleOutlined-BitrtgPg.js";import{I as u,O as p}from"./OutlinedInput-C5vYvqQm.js";import{F as d}from"./FormHelperText-BXMwkblB.js";import{I as z}from"./InputAdornment-BgDE6Kz5.js";import{L as E}from"./Link-DAa9g2LX.js";import{B as L}from"./Button-0T1tR8_c.js";import"./Container-iQUVt9w4.js";import"./useFormControl-BwsGWz84.js";import"./ButtonGroupButtonContext-BYVHV5Ft.js";const M=r=>new RegExp(/[0-9]/).test(r),T=r=>new RegExp(/[a-z]/).test(r)&&new RegExp(/[A-Z]/).test(r),$=r=>new RegExp(/[!#@$%^&*)(+=._-]/).test(r),U=r=>r<2?{label:"Poor",color:"error.main"}:r<3?{label:"Weak",color:"warning.main"}:r<4?{label:"Normal",color:"warning.dark"}:r<5?{label:"Good",color:"success.main"}:r<6?{label:"Strong",color:"success.dark"}:{label:"Poor",color:"error.main"},G=r=>{let t=0;return r.length>5&&(t+=1),r.length>7&&(t+=1),M(r)&&(t+=1),$(r)&&(t+=1),T(r)&&(t+=1),t};function H(){const[r,t]=h.useState(),[x,S]=h.useState(!1),k=I(),P=()=>{S(!x)},F=i=>{i.preventDefault()},b=i=>{const a=G(i);t(U(a))};h.useEffect(()=>{b("")},[]);const C=async(i,{setSubmitting:a,setErrors:o})=>{try{const c=await fetch("/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nomUtilisateur:i.firstname,email:i.email,password:i.password,fonction:i.fonction})});if(!c.ok){const l=await c.json();o({submit:l.error||"Erreur lors de l'enregistrement"}),f.error(l.error||"Erreur lors de l'enregistrement");return}const n=await c.json();f.success("Utilisateur créé avec succès !",{onClose:()=>{k("/login")}})}catch{o({submit:"Erreur de connexion, veuillez réessayer."}),f.error("Erreur de connexion, veuillez réessayer.")}finally{a(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(B,{}),e.jsx(R,{initialValues:{firstname:"",email:"",fonction:"",password:"",submit:null},validationSchema:W().shape({firstname:g().max(255).required("Nom d'utilisateur requis"),email:g().email("Doit être un email valide").max(255).required("Email requis"),password:g().max(255).required("Mot de passe requis")}),onSubmit:C,children:({errors:i,handleBlur:a,handleChange:o,handleSubmit:y,isSubmitting:c,touched:n,values:l})=>e.jsx("form",{noValidate:!0,onSubmit:y,children:e.jsxs(s,{container:!0,spacing:3,children:[e.jsxs(s,{item:!0,xs:12,children:[e.jsxs(m,{spacing:1,children:[e.jsx(u,{htmlFor:"firstname-signup",children:"Nom d'utilisateur*"}),e.jsx(p,{id:"firstname-login",type:"firstname",value:l.firstname,name:"firstname",onBlur:a,onChange:o,placeholder:"John",fullWidth:!0,error:!!(n.firstname&&i.firstname)})]}),n.firstname&&i.firstname&&e.jsx(d,{error:!0,id:"helper-text-firstname-signup",children:i.firstname})]}),e.jsxs(s,{item:!0,xs:12,children:[e.jsxs(m,{spacing:1,children:[e.jsx(u,{htmlFor:"company-signup",children:"Fonction"}),e.jsx(p,{fullWidth:!0,error:!!(n.fonction&&i.fonction),id:"company-signup",value:l.fonction,name:"fonction",onBlur:a,onChange:o,placeholder:"Chef Service Formation.",inputProps:{}})]}),n.company&&i.company&&e.jsx(d,{error:!0,id:"helper-text-company-signup",children:i.company})]}),e.jsxs(s,{item:!0,xs:12,children:[e.jsxs(m,{spacing:1,children:[e.jsx(u,{htmlFor:"email-signup",children:"Email*"}),e.jsx(p,{fullWidth:!0,error:!!(n.email&&i.email),id:"email-login",type:"email",value:l.email,name:"email",onBlur:a,onChange:o,placeholder:"example@gmail.com",inputProps:{}})]}),n.email&&i.email&&e.jsx(d,{error:!0,id:"helper-text-email-signup",children:i.email})]}),e.jsxs(s,{item:!0,xs:12,children:[e.jsxs(m,{spacing:1,children:[e.jsx(u,{htmlFor:"password-signup",children:"Mot de passe"}),e.jsx(p,{fullWidth:!0,error:!!(n.password&&i.password),id:"password-signup",type:x?"text":"password",value:l.password,name:"password",onBlur:a,onChange:v=>{o(v),b(v.target.value)},endAdornment:e.jsx(z,{position:"end",children:e.jsx(q,{"aria-label":"toggle password visibility",onClick:P,onMouseDown:F,edge:"end",color:"secondary",children:x?e.jsx(D,{}):e.jsx(N,{})})}),placeholder:"******",inputProps:{}})]}),n.password&&i.password&&e.jsx(d,{error:!0,id:"helper-text-password-signup",children:i.password})]}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(j,{variant:"body2",children:["En vous inscrivant, vous acceptez nos  ",e.jsx(E,{variant:"subtitle2",component:w,to:"#",children:"Conditions d'utilisation"}),"  et  ",e.jsx(E,{variant:"subtitle2",component:w,to:"#",children:"Politique de confidentialité"})]})}),i.submit&&e.jsx(s,{item:!0,xs:12,children:e.jsx(d,{error:!0,children:i.submit})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(A,{children:e.jsx(L,{disableElevation:!0,disabled:c,fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"primary",children:"Créer un compte"})})})]})})})]})}function re(){return e.jsx(O,{children:e.jsxs(s,{container:!0,spacing:3,children:[e.jsx(s,{item:!0,xs:12,children:e.jsxs(m,{direction:"row",justifyContent:"space-between",alignItems:"baseline",sx:{mb:{xs:-.5,sm:.5}},children:[e.jsx(j,{variant:"h3",children:"Sign up"}),e.jsx(j,{component:w,to:"/login",variant:"body1",sx:{textDecoration:"none"},color:"primary",children:"Already have an account?"})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(H,{})})]})})}export{re as default};
