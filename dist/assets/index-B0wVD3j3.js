import{l as ee,j as e,u as Ie,r as x,J as G,O as Me,aY as ze,aZ as qe,a_ as ft,aM as Xe,G as p,z as L,B as r,A as k,T as n,C as pe,w as he,F as ue,R as Ue,v as ae,L as rt,x as ke,aB as gt,V as Se,D as Je,I as Oe,K as Ce,N as bt,a$ as jt,U as vt,aX as yt,b2 as Et,W as It,X as Nt}from"./index-zHPv1lze.js";import{C as St}from"./ConsulterNotes-D5vYD3tO.js";import{S as Re}from"./Snackbar-XurLPfxZ.js";import{A as De}from"./Alert-D6te_eKs.js";import{F as $e}from"./FilterList-tzX0eq5I.js";import{B as W}from"./Button-0T1tR8_c.js";import{A as Tt}from"./Assignment-jETtBEfQ.js";import{C as oe}from"./CircularProgress-BHFhENdB.js";import{W as Ot}from"./Warning-Dm-AjjkC.js";import{b as Ct,A as At,a as Mt}from"./AccordionSummary-2JcKKmJQ.js";import{E as nt}from"./Event-DCg_30F7.js";import{E as Rt}from"./ExpandMore-DWiDQC_Y.js";import{T as Dt,a as Lt,b as wt,c as Ke,d as je,e as zt}from"./TableRow-70JfVjDg.js";import{T as Ee}from"./TextField-DNVhVnCv.js";import{C as Ft}from"./Check-DYQkY_Ur.js";import{C as Le}from"./Close-B5GqWx1j.js";import{d as le}from"./dayjs.min-BzR6NVRV.js";import{a as kt,D as Ut}from"./DialogContent-COvIddmc.js";import{D as $t}from"./DialogTitle-CCgKuUmv.js";import{D as Fe}from"./Delete-DRqEtRSt.js";import{D as Pt}from"./DialogContentText-B4ik-x_z.js";import{D as Bt}from"./DialogActions-CZ9LuKoL.js";import{b as Pe,c as Be,d as We}from"./Stepper-lJ9znjCt.js";import{A as Ge}from"./index-voob9auG.js";import{M as _e}from"./MenuBook-DDGUq44w.js";import{P as Qe}from"./People-RwhYgLWm.js";import{L as Wt}from"./LocalizationProvider-DMHyi95E.js";import{A as Gt}from"./fr-BWmqh5xn.js";import{D as _t}from"./DatePicker-_VewKJ-w.js";import{I as me}from"./InputAdornment-BgDE6Kz5.js";import{F as Ht,S as Vt}from"./Select-DCG_CkE0.js";import{I as Yt}from"./OutlinedInput-C5vYvqQm.js";import{M as qt}from"./MenuItem-D-1uk7AZ.js";import{L as Xt}from"./ListItem-CSuwil7H.js";import{P as xe}from"./Person-CVTBdQV4.js";import{S as Jt}from"./Save-ByVVUHNY.js";import{S as ye}from"./Skeleton-BAbB54dK.js";import{R as ot}from"./Refresh-HvTEdGt2.js";import{P as Ze}from"./Print-BhcHkGDV.js";import{B as at}from"./Badge-Q2tdgUxH.js";import{A as Kt}from"./Assessment-DAI052hb.js";import"./BarChart-CtMQudBV.js";import"./Autocomplete-DkJdCr17.js";import"./Close-DS868zx3.js";import"./DateRange-tTFtj54i.js";import"./CalendarToday-BYxDq_1X.js";import"./Download-CCo6S7zV.js";import"./TablePagination-Dk7TG7ya.js";import"./LastPage-aHJdqG80.js";import"./ButtonGroupButtonContext-BYVHV5Ft.js";import"./FormHelperText-BXMwkblB.js";import"./useFormControl-BwsGWz84.js";const He=ee(e.jsx("path",{d:"M17 11V3H7v4H3v14h8v-4h2v4h8V11zM7 19H5v-2h2zm0-4H5v-2h2zm0-4H5V9h2zm4 4H9v-2h2zm0-4H9V9h2zm0-4H9V5h2zm4 8h-2v-2h2zm0-4h-2V9h2zm0-4h-2V5h2zm4 12h-2v-2h2zm0-4h-2v-2h2z"}),"Apartment"),Qt=ee(e.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m-2 14-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9z"}),"AssignmentTurnedIn"),lt=ee(e.jsx("path",{d:"M13 7.83c.85-.3 1.53-.98 1.83-1.83H18l-3 7c0 1.66 1.57 3 3.5 3s3.5-1.34 3.5-3l-3-7h2V4h-6.17c-.41-1.17-1.52-2-2.83-2s-2.42.83-2.83 2H3v2h2l-3 7c0 1.66 1.57 3 3.5 3S9 14.66 9 13L6 6h3.17c.3.85.98 1.53 1.83 1.83V19H2v2h20v-2h-9zM20.37 13h-3.74l1.87-4.36zm-13 0H3.63L5.5 8.64zM12 6c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"Balance"),Zt=ee(e.jsx("path",{d:"M3 10h11v2H3zm0-2h11V6H3zm0 8h7v-2H3zm15.01-3.13.71-.71c.39-.39 1.02-.39 1.41 0l.71.71c.39.39.39 1.02 0 1.41l-.71.71zm-.71.71-5.3 5.3V21h2.12l5.3-5.3z"}),"EditNote"),et=ee(e.jsx("path",{fillRule:"evenodd",d:"M20 3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M10 17H5v-2h5zm0-4H5v-2h5zm0-4H5V7h5zm4.82 6L12 12.16l1.41-1.41 1.41 1.42L17.99 9l1.42 1.42z"}),"FactCheck"),tt=ee(e.jsx("path",{d:"M18 4H6v2l6.5 6L6 18v2h12v-3h-7l5-5-5-5h7z"}),"Functions"),ct=ee(e.jsx("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Grade"),es=ee(e.jsx("path",{d:"M22 9V7h-2v2h-2v2h2v2h2v-2h2V9zM8 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 1c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4m4.51-8.95C13.43 5.11 14 6.49 14 8s-.57 2.89-1.49 3.95C14.47 11.7 16 10.04 16 8s-1.53-3.7-3.49-3.95m4.02 9.78C17.42 14.66 18 15.7 18 17v3h2v-3c0-1.45-1.59-2.51-3.47-3.17"}),"GroupAdd"),Ve=ee(e.jsx("path",{d:"M15.41 16.59 10.83 12l4.58-4.59L14 6l-6 6 6 6z"}),"KeyboardArrowLeft"),ts=ee(e.jsx("path",{d:"M3 18h12v-2H3zM3 6v2h18V6zm0 7h18v-2H3z"}),"Notes"),ss=ee(e.jsx("path",{d:"M18 17H6v-2h12zm0-4H6v-2h12zm0-4H6V7h12zM3 22l1.5-1.5L6 22l1.5-1.5L9 22l1.5-1.5L12 22l1.5-1.5L15 22l1.5-1.5L18 22l1.5-1.5L21 22V2l-1.5 1.5L18 2l-1.5 1.5L15 2l-1.5 1.5L12 2l-1.5 1.5L9 2 7.5 3.5 6 2 4.5 3.5 3 2z"}),"Receipt"),Te=ee(e.jsx("path",{d:"M19.8 18.4 14 10.67V6.5l1.35-1.69c.26-.33.03-.81-.39-.81H9.04c-.42 0-.65.48-.39.81L10 6.5v4.17L4.2 18.4c-.49.66-.02 1.6.8 1.6h14c.82 0 1.29-.94.8-1.6"}),"Science"),is=ee(e.jsx("path",{d:"m23 12-2.44-2.79.34-3.69-3.61-.82-1.89-3.2L12 2.96 8.6 1.5 6.71 4.69 3.1 5.5l.34 3.7L1 12l2.44 2.79-.34 3.7 3.61.82L8.6 22.5l3.4-1.47 3.4 1.46 1.89-3.19 3.61-.82-.34-3.69zm-12.91 4.72-3.8-3.81 1.48-1.48 2.32 2.33 5.85-5.87 1.48 1.48z"}),"Verified"),st=ee(e.jsx("path",{d:"M9.68 13.69 12 11.93l2.31 1.76-.88-2.85L15.75 9h-2.84L12 6.19 11.09 9H8.25l2.31 1.84zM20 10c0-4.42-3.58-8-8-8s-8 3.58-8 8c0 2.03.76 3.87 2 5.28V23l6-2 6 2v-7.72c1.24-1.41 2-3.25 2-5.28m-8-6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6"}),"WorkspacePremium"),rs=()=>{const l=Ie(),[w,re]=x.useState([]),[Y,q]=x.useState(!1),[U,se]=x.useState(null),[f,X]=x.useState({open:!1,message:"",severity:"success"}),[ce,_]=x.useState({}),R="",N={headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}},I=(o,d="success")=>{X({open:!0,message:o,severity:d})},E=(o,d)=>{d!=="clickaway"&&X(v=>({...v,open:!1}))},$=o=>!o||!Array.isArray(o)?0:o.reduce((d,v)=>{const g=parseFloat(v.COEFFICENT)||0;return d+g},0),u=o=>!o||!Array.isArray(o)?0:o.filter(d=>(parseFloat(d.COEFFICENT)||0)>0).length,te=o=>!o||!Array.isArray(o)?0:o.length,P=(o,d)=>{const v=parseFloat(o)||0,g=parseFloat(d)||0;return g===0?0:Math.round(v/g*100)},H=async()=>{q(!0);try{const o=await fetch(`${R}/listemodulesCoefficient`,{method:"GET",headers:N.headers});if(o.ok){const v=((await o.json()).formations||[]).map(g=>{const A=$(g.MODULES),z=u(g.MODULES),S=te(g.MODULES);return{...g,TOTAL_COEFFICIENTS:A,MODULES_RENSEIGNES:z,TOTAL_MODULES:S,MODULES:(g.MODULES||[]).map(F=>({...F,COEFFICENT:parseFloat(F.COEFFICENT)||0,POURCENTAGE:P(F.COEFFICENT,A)}))}});re(v)}else throw new Error("√âchec du chargement des coefficients")}catch(o){console.error("Erreur de chargement des coefficients:",o),I("Erreur de chargement des coefficients","error"),re([])}finally{q(!1)}},J=async(o,d,v,g)=>{if(d===""||isNaN(d)){I("Veuillez saisir un coefficient valide","warning");return}const A=parseFloat(d);if(A<0||A>100){I("Le coefficient doit √™tre compris entre 0 et 100","warning");return}se(o);try{const z=await fetch(`${R}/updatecoefficient/${o}`,{method:"PATCH",headers:N.headers,body:JSON.stringify({coefficient:A})});if(z.ok){const S=await z.json();I(`‚úÖ Coefficient de "${v}" mis √† jour`,"success"),re(F=>F.map(C=>{if(C.IDFORMATION===g){const s=C.MODULES.map(y=>y.IDMODULE===o?{...y,COEFFICENT:A}:y),m=$(s),i=s.map(y=>({...y,POURCENTAGE:P(y.COEFFICENT,m)})),c=u(i);return{...C,MODULES:i,TOTAL_COEFFICIENTS:m,MODULES_RENSEIGNES:c}}return C})),_(F=>({...F,[o]:void 0}))}else{const S=await z.json();I(S.error||"√âchec de la mise √† jour","error")}}catch{I("Erreur r√©seau","error")}finally{se(null)}},ve=(o,d)=>{_(v=>({...v,[o]:d}))},K=o=>{_(d=>({...d,[o]:void 0}))},fe=(o,d)=>{_(v=>({...v,[o]:(d||0).toString()}))},ne=o=>{const d=parseFloat(o)||0;return d>=30?"success":d>=20?"primary":d>=10?"warning":"default"},de=o=>{const d=parseFloat(o)||0;return d===0?"Aucun coefficient d√©fini":d<100?`Manque ${(100-d).toFixed(1)} points`:d>100?`Exc√©dent de ${(d-100).toFixed(1)} points`:"Total parfait (100)"};return x.useEffect(()=>{H()},[]),e.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsx(Re,{open:f.open,autoHideDuration:4e3,onClose:E,anchorOrigin:{vertical:"top",horizontal:"center"},TransitionComponent:Me,TransitionProps:{direction:"down"},sx:{mt:"20px",zIndex:9999},children:e.jsx(De,{onClose:E,severity:f.severity,sx:{fontWeight:500,fontSize:"1.05rem",borderRadius:2,minWidth:300,textAlign:"center",justifyContent:"center",backgroundColor:f.severity==="success"?"#e8f5e9":f.severity==="error"?"#ffebee":f.severity==="warning"?"#fff8e1":"#e3f2fd",color:f.severity==="success"?"#2e7d32":f.severity==="error"?"#c62828":f.severity==="warning"?"#f57f17":"#0277bd",boxShadow:2,"& .MuiAlert-icon":{color:"inherit"},"& .MuiAlert-message":{width:"100%"}},iconMapping:{success:e.jsx(Xe,{size:24}),error:e.jsx(ft,{size:24}),warning:e.jsx(qe,{size:24}),info:e.jsx(ze,{size:24})},children:f.message})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{item:!0,xs:12,children:e.jsx(L,{sx:{p:1,borderRadius:4,background:"linear-gradient(45deg, #c6daf767, #91adf36f)",color:"black",boxShadow:l.shadows[3]},children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(k,{sx:{bgcolor:"rgba(244, 247, 249, 0.93)",mr:2,width:60,height:60},children:e.jsx(lt,{sx:{fontSize:32,color:"blue"}})}),e.jsxs(r,{children:[e.jsx(n,{variant:"h4",fontWeight:700,sx:{color:"blue"},children:"Gestion des Coefficients"}),e.jsx(n,{variant:"body1",sx:{opacity:.9},children:"D√©finissez les coefficients des modules pour les formations passerelles"})]})]})})}),e.jsx(p,{item:!0,xs:12,children:e.jsxs(p,{container:!0,spacing:2,children:[e.jsx(p,{item:!0,xs:12,md:4,children:e.jsx(pe,{sx:{borderRadius:3,bgcolor:"primary.light",color:"white"},children:e.jsx(he,{children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(ue,{sx:{fontSize:40,mr:2}}),e.jsxs(r,{children:[e.jsx(n,{variant:"h4",fontWeight:700,children:w.length}),e.jsx(n,{variant:"body2",children:"Formations passerelles"})]})]})})})}),e.jsx(p,{item:!0,xs:12,md:4,children:e.jsx(pe,{sx:{borderRadius:3,bgcolor:"info.light",color:"white"},children:e.jsx(he,{children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(tt,{sx:{fontSize:40,mr:2}}),e.jsxs(r,{children:[e.jsx(n,{variant:"h4",fontWeight:700,children:w.reduce((o,d)=>o+(d.MODULES?.length||0),0)}),e.jsx(n,{variant:"body2",children:"Modules au total"})]})]})})})}),e.jsx(p,{item:!0,xs:12,md:4,children:e.jsx(pe,{sx:{borderRadius:3,bgcolor:"#20c51a48",color:"white"},children:e.jsx(he,{children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(et,{sx:{fontSize:40,mr:2}}),e.jsxs(r,{children:[e.jsx(n,{variant:"h4",fontWeight:700,children:w.reduce((o,d)=>o+(d.MODULES_RENSEIGNES||0),0)}),e.jsx(n,{variant:"body2",children:"Modules avec coefficient"})]})]})})})})]})}),e.jsx(p,{item:!0,xs:12,children:e.jsxs(L,{sx:{p:3,borderRadius:4,boxShadow:l.shadows[3],borderLeft:`5px solid ${l.palette.primary.main}`},children:[e.jsxs(r,{display:"flex",alignItems:"center",mb:3,children:[e.jsx($e,{sx:{mr:1,color:l.palette.primary.main}}),e.jsx(n,{variant:"h6",fontWeight:600,flexGrow:1,children:"Coefficients par formation"}),e.jsx(W,{variant:"outlined",startIcon:e.jsx(Tt,{}),onClick:H,disabled:Y,children:"Rafra√Æchir"})]}),Y?e.jsx(r,{display:"flex",justifyContent:"center",alignItems:"center",height:400,children:e.jsx(oe,{size:60})}):w.length===0?e.jsxs(r,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:300,children:[e.jsx(Ot,{sx:{fontSize:60,color:"text.secondary",mb:2}}),e.jsx(n,{variant:"h6",color:"textSecondary",children:"Aucune formation passerelle trouv√©e"}),e.jsx(n,{variant:"body2",color:"textSecondary",children:"Les formations avec modules appara√Ætront ici"})]}):w.map(o=>{const d=parseFloat(o.TOTAL_COEFFICIENTS)||0,v=Math.abs(d-100)<=5;return o.TOTAL_MODULES>0&&Math.round(o.MODULES_RENSEIGNES/o.TOTAL_MODULES*100),e.jsxs(Ct,{sx:{mb:2,borderRadius:"12px !important",overflow:"hidden","&:before":{display:"none"},boxShadow:l.shadows[2]},children:[e.jsx(At,{expandIcon:e.jsx(Rt,{}),sx:{bgcolor:"background.default",borderBottom:"1px solid",borderColor:"divider"},children:e.jsxs(p,{container:!0,alignItems:"center",spacing:2,children:[e.jsx(p,{item:!0,xs:12,md:4,children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(ue,{sx:{mr:1,color:l.palette.primary.main}}),e.jsx(n,{variant:"subtitle1",fontWeight:600,children:o.FORMATION_INTITULE})]})}),e.jsx(p,{item:!0,xs:12,md:3,children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(nt,{sx:{mr:1,fontSize:20,color:"text.secondary"}}),e.jsx(n,{variant:"body2",children:o.ANNEE1||o.ANNEE2||o.ANNEE3||"N/A"})]})}),e.jsx(p,{item:!0,xs:6,md:3,children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(tt,{sx:{mr:1,fontSize:20,color:"text.secondary"}}),e.jsxs(n,{variant:"body2",children:[o.MODULES?.length||0," module(s)"]})]})}),e.jsx(p,{item:!0,xs:6,md:2,children:e.jsx(Ue,{color:o.MODULES_RENSEIGNES===o.TOTAL_MODULES?"success":o.MODULES_RENSEIGNES>0?"warning":"error",variant:"dot",anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(ae,{label:`${o.MODULES_RENSEIGNES||0}/${o.TOTAL_MODULES||0}`,color:o.MODULES_RENSEIGNES===o.TOTAL_MODULES?"success":o.MODULES_RENSEIGNES>0?"warning":"default",size:"small",icon:e.jsx(et,{}),sx:{fontWeight:"bold"}})})})]})}),e.jsxs(Mt,{sx:{p:2},children:[e.jsx(Dt,{children:e.jsxs(Lt,{size:"small",children:[e.jsx(wt,{children:e.jsxs(Ke,{sx:{bgcolor:"action.hover"},children:[e.jsx(je,{width:"50%",children:"Module"}),e.jsx(je,{width:"20%",align:"center",children:"Coefficient"}),e.jsx(je,{width:"30%",align:"center",children:"Actions"})]})}),e.jsx(zt,{children:o.MODULES?.map(g=>{const A=ce[g.IDMODULE]!==void 0,z=A?ce[g.IDMODULE]:(g.COEFFICENT||0).toString(),S=g.POURCENTAGE||0,F=parseFloat(g.COEFFICENT)||0;return e.jsxs(Ke,{hover:!0,children:[e.jsx(je,{children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(Te,{sx:{mr:1,color:l.palette.info.main,fontSize:20}}),e.jsxs(r,{children:[e.jsx(n,{variant:"body2",fontWeight:500,children:g.INTITULE}),e.jsxs(r,{display:"flex",alignItems:"center",mt:.5,children:[e.jsx(rt,{variant:"determinate",value:S,sx:{width:100,height:6,borderRadius:3,mr:1,bgcolor:"grey.200","& .MuiLinearProgress-bar":{bgcolor:S>=30?"success.main":S>=20?"primary.main":S>=10?"warning.main":"error.main"}}}),e.jsxs(n,{variant:"caption",color:"textSecondary",children:[S,"% du total"]})]})]})]})}),e.jsx(je,{align:"center",children:A?e.jsx(Ee,{size:"small",value:z,onChange:C=>ve(g.IDMODULE,C.target.value),type:"number",inputProps:{min:0,max:100,step:.5,style:{textAlign:"center",width:80}},variant:"outlined",autoFocus:!0}):e.jsx(ae,{label:F.toFixed(1),color:ne(F),size:"medium",sx:{fontWeight:"bold",minWidth:60}})}),e.jsx(je,{align:"center",children:A?e.jsxs(r,{display:"flex",justifyContent:"center",gap:1,children:[e.jsx(W,{size:"small",variant:"contained",color:"success",startIcon:e.jsx(Ft,{}),onClick:()=>J(g.IDMODULE,parseFloat(z),g.INTITULE,o.IDFORMATION),disabled:U===g.IDMODULE,children:U===g.IDMODULE?e.jsx(oe,{size:20}):"Valider"}),e.jsx(W,{size:"small",variant:"outlined",color:"error",startIcon:e.jsx(Le,{}),onClick:()=>K(g.IDMODULE),disabled:U===g.IDMODULE,children:"Annuler"})]}):e.jsx(ke,{title:"Modifier le coefficient",children:e.jsx(W,{size:"small",variant:"outlined",startIcon:e.jsx(gt,{}),onClick:()=>fe(g.IDMODULE,g.COEFFICENT||0),children:"Modifier"})})})]},g.IDMODULE)})})]})}),d!==100&&e.jsx(r,{display:"flex",alignItems:"center",justifyContent:"flex-end",mt:2,p:1,bgcolor:v?"success.lighter":d===0?"grey.100":"warning.lighter",borderRadius:2,children:d===0?e.jsxs(e.Fragment,{children:[e.jsx(ze,{size:20,color:l.palette.info.main}),e.jsx(n,{variant:"caption",color:"info.main",ml:1,children:"Aucun coefficient d√©fini pour cette formation"})]}):v?e.jsxs(e.Fragment,{children:[e.jsx(Xe,{size:20,color:l.palette.success.main}),e.jsxs(n,{variant:"caption",color:"success.main",ml:1,children:["Total √©quilibr√© : ",d.toFixed(1),"/100"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(qe,{size:20,color:l.palette.warning.main}),e.jsx(n,{variant:"caption",color:"warning.main",ml:1,children:de(d)})]})})]})]},o.IDFORMATION)})]})}),e.jsx(p,{item:!0,xs:12,children:e.jsx(L,{sx:{p:2,borderRadius:4,bgcolor:"info.lighter",border:"1px solid",borderColor:"info.main"},children:e.jsxs(r,{display:"flex",alignItems:"flex-start",children:[e.jsx(ze,{size:24,color:l.palette.info.main,style:{marginRight:12}}),e.jsxs(r,{children:[e.jsx(n,{variant:"subtitle2",color:"info.main",gutterBottom:!0,children:"Guide de d√©finition des coefficients"}),e.jsxs(n,{variant:"body2",color:"textSecondary",children:["‚Ä¢ Les coefficients nuls ou non d√©finis sont consid√©r√©s comme ",e.jsx("strong",{children:"0"}),e.jsx("br",{}),"‚Ä¢ Le pourcentage affich√© est calcul√© par rapport au ",e.jsx("strong",{children:"total des coefficients de la formation"}),e.jsx("br",{}),"‚Ä¢ Utilisez des valeurs d√©cimales (ex: 15.5) pour plus de pr√©cision",e.jsx("br",{}),"‚Ä¢ ",e.jsxs("strong",{children:[w.reduce((o,d)=>o+(d.MODULES_RENSEIGNES||0),0)," modules"]})," ont d√©j√† un coefficient renseign√© sur ",e.jsx("strong",{children:w.reduce((o,d)=>o+(d.TOTAL_MODULES||0),0)})," au total"]})]})]})})})]})]})},ns=()=>{const l=Ie(),[w,re]=x.useState([]),[Y,q]=x.useState([]),[U,se]=x.useState([]),[f,X]=x.useState([]),[ce,_]=x.useState([]),[R,O]=x.useState({formations:!1,modules:!1,apprenants:!1,submission:!1}),[N,I]=x.useState(null),[E,$]=x.useState(null),[u,te]=x.useState(0),[P,H]=x.useState({}),[J,ve]=x.useState(le()),[K,fe]=x.useState("Examen"),[ne,de]=x.useState(""),[o,d]=x.useState(!1),[v,g]=x.useState(null),[A,z]=x.useState({open:!1,message:"",severity:"success"}),S="",C={headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}},s=["Examen","Contr√¥le continu","Projet","Travaux pratiques","QCM","Soutenance"],m=async()=>{O(t=>({...t,formations:!0}));try{const t=await fetch(`${S}/listemodulesCoefficient`,{method:"GET",headers:C.headers});if(t.ok){const a=await t.json();re(a.formations||[])}}catch{h("Erreur de chargement des formations","error")}finally{O(t=>({...t,formations:!1}))}},i=async t=>{O(a=>({...a,modules:!0}));try{const a=await fetch(`${S}/listemodulesCoefficient`,{method:"GET",headers:C.headers});if(a.ok){const b=(await a.json()).formations?.find(be=>be.IDFORMATION===t);q(b?.MODULES||[])}}catch{h("Erreur de chargement des modules","error")}finally{O(a=>({...a,modules:!1}))}},c=async()=>{O(t=>({...t,apprenants:!0}));try{const t=await fetch(`${S}/listepersonelformescentreexcellence`,{method:"GET",headers:C.headers});if(t.ok){const a=await t.json();se(a),X(a)}}catch{h("Erreur de chargement des apprenants","error")}finally{O(t=>({...t,apprenants:!1}))}},y=async()=>{try{const t=await fetch(`${S}/listeNotes`,{method:"GET",headers:C.headers});if(t.ok){const a=await t.json();_(a)}}catch(t){console.error("Erreur de chargement des notes:",t)}};x.useEffect(()=>{m(),c(),y()},[]),x.useEffect(()=>{if(!E)return;const t=U.filter(a=>a.IDFORMATIONM===N?.IDFORMATION);if(ne.trim()==="")X(t);else{const a=ne.toLowerCase(),j=t.filter(b=>`${b.NOM} ${b.PRENOM}`.toLowerCase().includes(a)||Ye(b).toLowerCase().includes(a));X(j)}},[ne,U,N,E]);const h=(t,a="success")=>{z({open:!0,message:t,severity:a})},D=()=>{z(t=>({...t,open:!1}))},Q=t=>{I(t),i(t.IDFORMATION),te(1),$(null),H({}),de("")},ie=t=>{$(t),te(2);const a=ce.filter(b=>b.IDMODULE===t.IDMODULE),j={};a.forEach(b=>{j[b.IDPERSONNEL]=b.NOTE?.toString()||""}),H(j)},V=()=>{te(t=>Math.max(0,t-1)),u===1&&$(null),u===2&&I(null)},T=(t,a)=>{H(j=>({...j,[t]:a}))},Z=async t=>{const a=P[t];if(!a||a.trim()===""){h("Veuillez saisir une note","warning");return}const j=parseFloat(a);if(isNaN(j)||j<0||j>20){h("La note doit √™tre comprise entre 0 et 20","warning");return}O(b=>({...b,submission:!0}));try{(await fetch(`${S}/nouvelleNote`,{method:"POST",headers:C.headers,body:JSON.stringify({IDPERSONNEL:t,IDMODULE:E.IDMODULE,IDFORMATION:N.IDFORMATION,NOTE:j,NOTE_SUR:20,DATE_EVALUATION:J.format("YYYY-MM-DD"),TYPE_EVALUATION:K})})).ok&&(h("Note enregistr√©e","success"),y())}catch{h("Erreur r√©seau","error")}finally{O(b=>({...b,submission:!1}))}},M=async()=>{const t=[];if(f.forEach(a=>{const j=P[a.IDPERSONNEL];if(j&&j.trim()!==""){const b=parseFloat(j);!isNaN(b)&&b>=0&&b<=20&&t.push({IDPERSONNEL:a.IDPERSONNEL,IDFORMATION:N.IDFORMATION,IDMODULE:E.IDMODULE,NOTE:b,NOTE_SUR:20,DATE_EVALUATION:J.format("YYYY-MM-DD"),TYPE_EVALUATION:K})}}),t.length===0){h("Aucune note valide","warning");return}O(a=>({...a,submission:!0}));try{const a=await fetch(`${S}/nouvelleNoteGroupe`,{method:"POST",headers:C.headers,body:JSON.stringify({notes:t})});if(a.ok){const j=await a.json();h(`${t.length} note(s) enregistr√©e(s) avec succ√®s`,"success"),y();const b={...P};t.forEach(be=>{b[be.IDPERSONNEL]=be.NOTE.toString()}),H(b)}else{const j=await a.json();console.error("‚ùå Erreur backend:",j),h(j.error||"Erreur lors de l'enregistrement group√©","error")}}catch(a){console.error("‚ùå Erreur r√©seau:",a),h("Erreur r√©seau","error")}finally{O(a=>({...a,submission:!1}))}},B=t=>{const a=ce.find(j=>j.IDMODULE===E?.IDMODULE&&j.IDPERSONNEL===t);a&&(g({id:a.IDNOTE,idPersonnel:t,nomApprenant:pt(t)}),d(!0))},ge=async()=>{if(v){O(t=>({...t,submission:!0}));try{const t=await fetch(`${S}/supprimerNote/${v.id}`,{method:"DELETE",headers:C.headers});if(t.ok)h(`üóëÔ∏è Note supprim√©e pour ${v.nomApprenant}`,"success"),y(),H(a=>({...a,[v.idPersonnel]:""})),d(!1),g(null);else{const a=await t.json();h(a.error||"√âchec de la suppression","error")}}catch{h("Erreur r√©seau","error")}finally{O(t=>({...t,submission:!1}))}}},dt=t=>ce.some(a=>a.IDMODULE===E?.IDMODULE&&a.IDPERSONNEL===t),xt=t=>ce.find(a=>a.IDMODULE===E?.IDMODULE&&a.IDPERSONNEL===t),pt=t=>{const a=U.find(j=>j.IDPERSONNEL===t);return a?`${a.NOM} ${a.PRENOM}${a.NOMMARI?` (${a.NOMMARI})`:""}`:"Inconnu"},Ye=t=>t.STRUCTURE_HIERARCHY?t.STRUCTURE_HIERARCHY.split(" / ")[0]:t.SERVICECENTRAL||"Direction G√©n√©rale du Budget",ht=[{label:"Formation",icon:e.jsx(ue,{})},{label:"Module",icon:e.jsx(Te,{})},{label:"Saisie",icon:e.jsx(ct,{})}],Ne=Object.values(P).filter(Boolean).length,we=f.length>0?Ne/f.length*100:0,mt=()=>e.jsx(r,{sx:{px:0,py:1},children:[1,2,3,4,5].map(t=>e.jsxs(r,{sx:{display:"flex",alignItems:"center",py:1.5,borderBottom:"1px solid rgba(0,0,0,0.04)",px:0},children:[e.jsx(ye,{variant:"circular",width:44,height:44,sx:{mr:2}}),e.jsxs(r,{sx:{flex:1},children:[e.jsx(ye,{variant:"text",width:"60%",height:24}),e.jsx(ye,{variant:"text",width:"40%",height:20})]}),e.jsx(ye,{variant:"rounded",width:70,height:36,sx:{borderRadius:2,mr:1}}),e.jsx(ye,{variant:"circular",width:36,height:36})]},t))});return e.jsxs(G.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[e.jsx(Re,{open:A.open,autoHideDuration:3e3,onClose:D,anchorOrigin:{vertical:"top",horizontal:"center"},TransitionComponent:Me,sx:{mt:8,zIndex:9999},children:e.jsx(De,{onClose:D,severity:A.severity,variant:"filled",sx:{borderRadius:3},children:A.message})}),e.jsxs(kt,{open:o,onClose:()=>d(!1),"aria-labelledby":"delete-dialog-title","aria-describedby":"delete-dialog-description",PaperProps:{sx:{borderRadius:3,boxShadow:"0 8px 32px rgba(0,0,0,0.08)",width:"100%",maxWidth:450}},children:[e.jsx($t,{id:"delete-dialog-title",sx:{pb:1},children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(k,{sx:{bgcolor:"error.light",mr:1.5,width:40,height:40},children:e.jsx(Fe,{fontSize:"small"})}),e.jsx(n,{variant:"h6",fontWeight:600,children:"Confirmer la suppression"})]})}),e.jsxs(Ut,{children:[e.jsxs(Pt,{id:"delete-dialog-description",sx:{color:"text.primary"},children:["√ätes-vous s√ªr de vouloir supprimer la note de ",e.jsx("strong",{children:v?.nomApprenant})," ?"]}),e.jsx(r,{sx:{mt:2,p:2,bgcolor:"rgba(211, 47, 47, 0.04)",borderRadius:2},children:e.jsx(n,{variant:"body2",color:"text.secondary",children:"Cette action est irr√©versible. La note sera d√©finitivement supprim√©e de la base de donn√©es."})})]}),e.jsxs(Bt,{sx:{p:2,pt:0},children:[e.jsx(W,{onClick:()=>d(!1),variant:"outlined",sx:{borderRadius:2},children:"Annuler"}),e.jsx(W,{onClick:ge,variant:"contained",color:"error",disabled:R.submission,startIcon:R.submission?e.jsx(oe,{size:16}):e.jsx(Fe,{}),sx:{borderRadius:2},children:R.submission?"Suppression...":"Supprimer"})]})]}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{item:!0,xs:12,children:e.jsx(L,{sx:{p:2.5,borderRadius:3,bgcolor:"rgba(255,255,255,0.8)",backdropFilter:"blur(8px)",border:"1px solid rgba(25,118,210,0.08)",boxShadow:"0 4px 20px rgba(0,0,0,0.02)"},children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(k,{sx:{bgcolor:"rgba(25,118,210,0.04)",color:l.palette.primary.main,width:56,height:56,mr:2},children:e.jsx(Qt,{sx:{fontSize:28}})}),e.jsxs(r,{children:[e.jsx(n,{variant:"h5",fontWeight:600,children:"Saisie des notes"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Centre d'Excellence ‚Ä¢ Formations passerelles"})]})]})})}),e.jsx(p,{item:!0,xs:12,md:4,children:e.jsxs(L,{sx:{p:3,borderRadius:3,bgcolor:"rgba(255,255,255,0.6)",backdropFilter:"blur(4px)",border:"1px solid rgba(0,0,0,0.03)",height:"fit-content"},children:[e.jsx(Pe,{activeStep:u,orientation:"vertical",children:ht.map((t,a)=>e.jsx(Be,{children:e.jsx(We,{StepIconComponent:()=>e.jsx(k,{sx:{width:32,height:32,bgcolor:u>=a?l.palette.primary.main:"rgba(0,0,0,0.04)",color:u>=a?"white":"text.secondary"},children:t.icon}),children:e.jsx(n,{variant:"subtitle2",fontWeight:600,children:t.label})})},t.label))}),u>0&&e.jsx(W,{startIcon:e.jsx(Ve,{}),onClick:V,sx:{mt:2},size:"small",children:"Retour"}),N&&u>0&&e.jsx(Se,{in:!0,children:e.jsxs(r,{mt:3,p:2,bgcolor:"rgba(25,118,210,0.02)",borderRadius:2,children:[e.jsx(n,{variant:"caption",color:"text.secondary",children:"Formation active"}),e.jsx(n,{variant:"body2",fontWeight:600,noWrap:!0,children:N.FORMATION_INTITULE}),E&&e.jsxs(n,{variant:"caption",color:"primary.main",sx:{mt:.5,display:"block"},children:["Module: ",E.INTITULE]})]})})]})}),e.jsx(p,{item:!0,xs:12,md:8,children:e.jsxs(Ge,{mode:"wait",children:[u===0&&e.jsx(G.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:e.jsxs(L,{sx:{p:3,borderRadius:3,bgcolor:"rgba(255,255,255,0.6)",backdropFilter:"blur(4px)",border:"1px solid rgba(0,0,0,0.03)"},children:[e.jsxs(r,{display:"flex",alignItems:"center",mb:3,children:[e.jsx(_e,{sx:{mr:1,color:l.palette.primary.main}}),e.jsx(n,{variant:"h6",fontWeight:600,children:"Formations passerelles"})]}),R.formations?e.jsx(r,{display:"flex",justifyContent:"center",py:4,children:e.jsx(oe,{size:40})}):e.jsx(p,{container:!0,spacing:2,children:w.map(t=>{const a=U.filter(j=>j.IDFORMATIONM===t.IDFORMATION).length;return e.jsx(p,{item:!0,xs:12,children:e.jsx(pe,{onClick:()=>Q(t),sx:{borderRadius:2,cursor:"pointer",transition:"all 0.2s",border:"1px solid rgba(0,0,0,0.04)","&:hover":{borderColor:l.palette.primary.main,boxShadow:"0 4px 16px rgba(25,118,210,0.08)",bgcolor:"rgba(25,118,210,0.01)"}},children:e.jsx(he,{sx:{p:2.5},children:e.jsxs(r,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(k,{sx:{bgcolor:"rgba(25,118,210,0.04)",color:l.palette.primary.main,mr:2},children:e.jsx(ue,{})}),e.jsxs(r,{children:[e.jsx(n,{variant:"subtitle1",fontWeight:600,children:t.FORMATION_INTITULE}),e.jsxs(r,{display:"flex",alignItems:"center",gap:2,mt:.5,children:[e.jsxs(n,{variant:"caption",color:"text.secondary",children:[t.MODULES?.length||0," module(s)"]}),e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(Qe,{sx:{fontSize:14,color:"text.secondary",mr:.5}}),e.jsxs(n,{variant:"caption",color:"text.secondary",children:[a," apprenant(s)"]})]})]})]})]}),e.jsx(ae,{label:`${t.MODULES_RENSEIGNES||0}/${t.TOTAL_MODULES||0}`,size:"small",variant:"outlined"})]})})})},t.IDFORMATION)})})]})},"step1"),u===1&&N&&e.jsx(G.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:e.jsxs(L,{sx:{p:3,borderRadius:3,bgcolor:"rgba(255,255,255,0.6)",backdropFilter:"blur(4px)",border:"1px solid rgba(0,0,0,0.03)"},children:[e.jsxs(r,{mb:2,children:[e.jsx(n,{variant:"caption",color:"text.secondary",children:"Formation s√©lectionn√©e"}),e.jsx(n,{variant:"subtitle1",fontWeight:600,children:N.FORMATION_INTITULE})]}),e.jsx(Je,{sx:{my:2}}),e.jsxs(r,{display:"flex",alignItems:"center",mb:2,children:[e.jsx(Te,{sx:{mr:1,color:l.palette.info.main}}),e.jsx(n,{variant:"h6",fontWeight:600,children:"Modules √† √©valuer"})]}),R.modules?e.jsx(r,{display:"flex",justifyContent:"center",py:4,children:e.jsx(oe,{size:40})}):e.jsx(p,{container:!0,spacing:2,children:Y.map(t=>e.jsx(p,{item:!0,xs:12,sm:6,children:e.jsx(pe,{onClick:()=>ie(t),sx:{borderRadius:2,cursor:"pointer",border:"1px solid rgba(0,0,0,0.04)",transition:"all 0.2s","&:hover":{borderColor:l.palette.info.main,boxShadow:"0 4px 16px rgba(2,136,209,0.08)"}},children:e.jsx(he,{sx:{p:2},children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(k,{sx:{bgcolor:"rgba(2,136,209,0.04)",color:l.palette.info.main,mr:1.5,width:40,height:40},children:e.jsx(Te,{fontSize:"small"})}),e.jsxs(r,{flex:1,children:[e.jsx(n,{variant:"subtitle2",fontWeight:600,noWrap:!0,children:t.INTITULE}),e.jsxs(n,{variant:"caption",color:"text.secondary",children:["Coeff. ",t.COEFFICENT?.toFixed(1)||0]})]}),e.jsx(ae,{size:"small",label:`${t.POURCENTAGE||0}%`,sx:{height:24,fontSize:"0.7rem"}})]})})})},t.IDMODULE))})]})},"step2"),u===2&&E&&e.jsx(G.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:e.jsxs(L,{sx:{p:3,borderRadius:3,bgcolor:"rgba(255,255,255,0.6)",backdropFilter:"blur(4px)",border:"1px solid rgba(0,0,0,0.03)"},children:[e.jsxs(p,{container:!0,spacing:2,sx:{mb:2},children:[e.jsxs(p,{item:!0,xs:6,children:[e.jsx(n,{variant:"caption",color:"text.secondary",children:"Formation"}),e.jsx(n,{variant:"subtitle2",fontWeight:600,noWrap:!0,children:N.FORMATION_INTITULE})]}),e.jsxs(p,{item:!0,xs:6,children:[e.jsx(n,{variant:"caption",color:"text.secondary",children:"Module"}),e.jsx(n,{variant:"subtitle2",fontWeight:600,noWrap:!0,children:E.INTITULE})]})]}),e.jsx(Je,{sx:{my:2}}),e.jsxs(p,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(p,{item:!0,xs:12,md:6,children:e.jsx(Wt,{dateAdapter:Gt,children:e.jsx(_t,{label:"Date d'√©valuation",value:J,onChange:ve,slotProps:{textField:{size:"small",fullWidth:!0,InputProps:{startAdornment:e.jsx(me,{position:"start",children:e.jsx(nt,{sx:{fontSize:18,color:"text.secondary"}})})}}}})})}),e.jsx(p,{item:!0,xs:12,md:6,children:e.jsxs(Ht,{fullWidth:!0,size:"small",children:[e.jsx(Yt,{children:"Type d'√©valuation"}),e.jsx(Vt,{value:K,onChange:t=>fe(t.target.value),label:"Type d'√©valuation",startAdornment:e.jsx(me,{position:"start",children:e.jsx(ts,{sx:{fontSize:18,color:"text.secondary"}})}),children:s.map(t=>e.jsx(qt,{value:t,children:t},t))})]})})]}),e.jsx(r,{mb:2,children:e.jsx(Ee,{fullWidth:!0,size:"small",placeholder:"Rechercher un apprenant par nom ou structure...",value:ne,onChange:t=>de(t.target.value),InputProps:{startAdornment:e.jsx(me,{position:"start",children:e.jsx(Ce,{sx:{fontSize:18,color:"text.secondary"}})}),endAdornment:ne&&e.jsx(me,{position:"end",children:e.jsx(Oe,{size:"small",onClick:()=>de(""),children:e.jsx(Le,{fontSize:"small"})})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:3,bgcolor:"rgba(0,0,0,0.01)"}}})}),e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(Qe,{sx:{fontSize:18,color:"text.secondary",mr:1}}),e.jsxs(n,{variant:"body2",color:"text.secondary",children:[f.length," apprenant(s)"]})]}),e.jsx(ae,{size:"small",label:`${Ne} note(s) saisie(s)`,color:"primary",variant:"outlined"})]}),e.jsx(r,{sx:{maxHeight:400,overflow:"auto",pr:1},children:R.apprenants?e.jsx(Se,{in:R.apprenants,timeout:500,children:e.jsx(r,{children:e.jsx(mt,{})})}):f.length===0?e.jsx(Se,{in:!0,timeout:500,children:e.jsxs(r,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:6,children:[e.jsx(k,{sx:{width:60,height:60,bgcolor:"rgba(0,0,0,0.04)",mb:2},children:e.jsx(Ce,{sx:{fontSize:30,color:"text.secondary"}})}),e.jsx(n,{variant:"body1",color:"text.secondary",gutterBottom:!0,children:"Aucun apprenant trouv√©"}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"Essayez de modifier votre recherche"})]})}):e.jsx(Se,{in:!0,timeout:500,children:e.jsx(bt,{sx:{py:0},children:f.map((t,a)=>{const j=P[t.IDPERSONNEL]||"",b=dt(t.IDPERSONNEL),be=xt(t.IDPERSONNEL);return e.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:a*.03},children:e.jsxs(Xt,{sx:{px:0,py:1.5,borderBottom:"1px solid rgba(0,0,0,0.04)",alignItems:"center"},children:[e.jsx(jt,{children:e.jsx(k,{sx:{bgcolor:b?"rgba(46,125,50,0.04)":"rgba(0,0,0,0.02)",color:b?l.palette.success.main:l.palette.text.secondary,width:44,height:44},children:e.jsx(xe,{})})}),e.jsx(vt,{primary:e.jsxs(r,{display:"flex",alignItems:"center",gap:1,children:[e.jsxs(n,{variant:"subtitle2",fontWeight:600,children:[t.NOM," ",t.PRENOM]}),b&&e.jsx(ae,{label:`${be?.NOTE||""}/20`,size:"small",color:"success",variant:"outlined",sx:{height:20,fontSize:"0.65rem",fontWeight:"bold"}})]}),secondary:e.jsxs(r,{display:"flex",alignItems:"center",mt:.25,children:[e.jsx(He,{sx:{fontSize:14,color:"text.secondary",mr:.5}}),e.jsx(n,{variant:"caption",color:"text.secondary",noWrap:!0,sx:{maxWidth:200},children:Ye(t)})]})}),e.jsxs(yt,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ee,{size:"small",placeholder:"Note",value:j,onChange:ut=>T(t.IDPERSONNEL,ut.target.value),inputProps:{style:{width:60,textAlign:"center",padding:"8px 4px",fontSize:"0.9rem"},min:0,max:20,step:.5},type:"number",sx:{"& .MuiOutlinedInput-root":{borderRadius:2,bgcolor:"rgba(0,0,0,0.01)"}}}),e.jsx(ke,{title:b?"Mettre √† jour":"Enregistrer",children:e.jsx(W,{variant:"contained",size:"small",onClick:()=>Z(t.IDPERSONNEL),disabled:R.submission||!j,sx:{minWidth:36,width:36,height:36,borderRadius:2,p:0,bgcolor:b?l.palette.warning.main:l.palette.primary.main,"&:hover":{bgcolor:b?l.palette.warning.dark:l.palette.primary.dark}},children:R.submission?e.jsx(oe,{size:16,color:"inherit"}):b?e.jsx(Et,{size:16}):e.jsx(Jt,{fontSize:"small"})})}),b&&e.jsx(ke,{title:"Supprimer la note",children:e.jsx(Oe,{size:"small",onClick:()=>B(t.IDPERSONNEL),sx:{width:36,height:36,borderRadius:2,bgcolor:"rgba(211, 47, 47, 0.04)",color:l.palette.error.main,"&:hover":{bgcolor:"rgba(211, 47, 47, 0.08)"}},children:e.jsx(Fe,{fontSize:"small"})})})]})]})},t.IDPERSONNEL)})})})}),e.jsxs(r,{mt:3,children:[e.jsxs(r,{display:"flex",alignItems:"center",mb:2,children:[e.jsx(r,{flex:1,mr:2,children:e.jsx(rt,{variant:"determinate",value:we,sx:{height:6,borderRadius:3,bgcolor:"rgba(0,0,0,0.04)","& .MuiLinearProgress-bar":{bgcolor:we===100?l.palette.success.main:l.palette.primary.main}}})}),e.jsxs(n,{variant:"caption",fontWeight:600,children:[Math.round(we),"%"]})]}),e.jsxs(r,{display:"flex",justifyContent:"flex-end",gap:1,children:[e.jsx(W,{variant:"outlined",size:"small",onClick:()=>{H({}),h("Saisie r√©initialis√©e","info")},children:"R√©initialiser"}),e.jsxs(W,{variant:"contained",size:"small",onClick:M,disabled:R.submission||Ne===0,startIcon:R.submission?e.jsx(oe,{size:16}):e.jsx(es,{}),sx:{bgcolor:l.palette.success.main,"&:hover":{bgcolor:l.palette.success.dark}},children:["Enregistrer groupe (",Ne,")"]})]})]})]})},"step3")]})})]})]})},Ae="/assets/Logo_DGB-DVQzqnN7.png";le.locale("fr");const os=()=>{const l=Ie();x.useRef();const[w,re]=x.useState([]),[Y,q]=x.useState([]),[U,se]=x.useState([]),[f,X]=x.useState(null),[ce,_]=x.useState(null),[R,O]=x.useState([]),[N,I]=x.useState({formations:!1,apprenants:!1,modules:!1,releve:!1}),[E,$]=x.useState(""),[u,te]=x.useState(0),[P,H]=x.useState({open:!1,message:"",severity:"success"}),J="",K={headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}},fe={TB:"Tr√®s Bien",B:"Bien",AB:"Assez Bien",Passable:"Passable",Insuffisant:"Insuffisant",Faible:"Faible"},ne=async()=>{I(i=>({...i,formations:!0}));try{const i=await fetch(`${J}/listemodulesCoefficient`,{method:"GET",headers:K.headers});if(i.ok){const c=await i.json();re(c.formations||[])}}catch{C("Erreur de chargement des formations","error")}finally{I(i=>({...i,formations:!1}))}},de=async()=>{I(i=>({...i,apprenants:!0}));try{const i=await fetch(`${J}/listepersonelformescentreexcellence`,{method:"GET",headers:K.headers});if(i.ok){const c=await i.json();q(c)}}catch{C("Erreur de chargement des apprenants","error")}finally{I(i=>({...i,apprenants:!1}))}},o=async i=>{I(c=>({...c,modules:!0}));try{const c=await fetch(`${J}/listemodulesCoefficient`,{method:"GET",headers:K.headers});if(c.ok){const h=(await c.json()).formations?.find(D=>D.IDFORMATION===i);O(h?.MODULES||[])}}catch(c){console.error("Erreur de chargement des modules:",c)}finally{I(c=>({...c,modules:!1}))}};x.useEffect(()=>{ne(),de()},[]),x.useEffect(()=>{f?o(f.IDFORMATION):O([])},[f]),x.useEffect(()=>{if(!f){se([]);return}const i=Y.filter(c=>c.IDFORMATIONM===f.IDFORMATION);if(E.trim()==="")se(i);else{const c=E.toLowerCase(),y=i.filter(h=>`${h.NOM} ${h.PRENOM}`.toLowerCase().includes(c)||h.MATRICULE?.toLowerCase().includes(c)||F(h).toLowerCase().includes(c));se(y)}},[E,Y,f]);const d=i=>{X(i),te(1),_(null),$("")},v=()=>{te(i=>Math.max(0,i-1)),u===1&&X(null)},g=()=>{te(0),X(null),_(null),$("")},A=async i=>{I(c=>({...c,releve:!0}));try{const c=await fetch(`${J}/releveNotes/${i.IDPERSONNEL}`,{method:"GET",headers:K.headers});if(c.ok){const y=await c.json(),h=y.EVALUATIONS||[],D={};h.forEach(T=>{D[T.IDMODULE]={note:parseFloat(T.NOTE)||T.note||null,appreciation:T.APPRECIATION,date_evaluation:T.DATE_EVALUATION,type_evaluation:T.TYPE_EVALUATION}});const Q=R.map(T=>{const Z=D[T.IDMODULE]||{},M=Z.note||null,B=T.COEFFICENT||1,ge=M!==null?(M*B).toFixed(2):"-";return{...T,note:M,coefficient:B,noteXCoef:ge,appreciation:Z.appreciation,date_evaluation:Z.date_evaluation}}),ie=[{formation_id:f.IDFORMATION,formation_intitule:f.FORMATION_INTITULE,evaluations:Q}],V={...y,evaluations:h,notesByFormation:ie,modulesAvecNotes:Q};_(V),z(V,i)}else throw new Error("Erreur lors du chargement")}catch(c){console.error("Erreur:",c),C("Erreur lors du chargement du relev√©","error")}finally{I(c=>({...c,releve:!1}))}},z=(i,c)=>{const y=S(i),h=document.createElement("iframe");h.style.position="absolute",h.style.width="0",h.style.height="0",h.style.border="none",h.style.visibility="hidden",document.body.appendChild(h);const D=h.contentWindow.document;D.open(),D.write(y),D.close(),h.contentWindow.focus(),h.contentWindow.print(),setTimeout(()=>{document.body.removeChild(h)},1e3)},S=(i,c)=>{if(!i)return"";const y=i.notesByFormation||[];let h=0,D=0,Q=0;y.forEach(V=>{V.evaluations.forEach(T=>{T.note!==null&&(h+=T.coefficient,D+=T.note*T.coefficient,Q++)})});const ie=h>0?(D/h).toFixed(2):"N/A";return`
      <!DOCTYPE html>
      <html>
        <head>
          <meta charset="UTF-8">
          <title>Relev√© de notes - ${i.NOM} ${i.PRENOM}</title>
          <style>
            @page { size: A4; margin: 1.5cm; }
            body { 
              font-family: 'Times New Roman', Times, serif; 
              line-height: 1.4; 
              color: #2c3e50; 
              background: white; 
              font-size: 11px;
              margin: 0;
              padding: 0;
            }
            .header {
              display: flex;
              align-items: center;
              justify-content: space-between;
              margin-bottom: 20px;
              padding-bottom: 15px;
              border-bottom: 2px solid #1a237e;
            }
            .logo { width: 90px; height: 90px; }
            .logo img { width: 100%; height: auto; object-fit: contain; }
            .title { text-align: right; }
            .title h1 { color: #1a237e; margin: 0; font-size: 18px; font-weight: bold; }
            .title h2 { color: #0d47a1; margin: 5px 0; font-size: 14px; font-weight: normal; }
            .info-section {
              margin-bottom: 20px;
              padding: 12px;
              background: #f8f9fa;
              border-radius: 6px;
              border-left: 4px solid #1a237e;
            }
            .info-grid {
              display: grid;
              grid-template-columns: repeat(3, 1fr);
              gap: 10px;
            }
            .info-item { margin-bottom: 5px; }
            .info-label { 
              font-weight: bold; 
              color: #0d47a1; 
              font-size: 10px; 
              text-transform: uppercase; 
            }
            .info-value { 
              font-size: 11px; 
              color: #2c3e50; 
            }
            .formation-title {
              background: #e8eaf6;
              padding: 8px 12px;
              margin: 15px 0 5px 0;
              border-radius: 4px;
              font-weight: bold;
              color: #1a237e;
              font-size: 12px;
            }
            table {
              width: 100%;
              border-collapse: collapse;
              margin: 8px 0;
              font-size: 10px;
            }
            th {
              background: #1a237e;
              color: white;
              padding: 8px 6px;
              text-align: left;
              font-weight: 600;
            }
            td {
              padding: 6px;
              border-bottom: 1px solid #e0e0e0;
            }
            tr:nth-child(even) { background: #f8f9fa; }
            .total-row {
              background: #e8eaf6 !important;
              font-weight: bold;
            }
            .badge {
              display: inline-block;
              padding: 2px 8px;
              border-radius: 12px;
              font-size: 9px;
              font-weight: bold;
            }
            .badge-success { background: #e8f5e9; color: #2e7d32; }
            .badge-warning { background: #fff3e0; color: #ed6c02; }
            .badge-error { background: #ffebee; color: #d32f2f; }
            .badge-default { background: #f5f5f5; color: #9e9e9e; }
            .stats-section {
              display: flex;
              justify-content: space-around;
              margin: 20px 0;
              padding: 15px;
              background: linear-gradient(135deg, #e3f2fd, #bbdefb);
              border-radius: 8px;
            }
            .stat-item { text-align: center; }
            .stat-value { 
              font-size: 20px; 
              font-weight: bold; 
              color: #0d47a1; 
            }
            .stat-label { 
              font-size: 9px; 
              color: #2c3e50; 
              margin-top: 3px; 
            }
            .footer {
              margin-top: 40px;
              text-align: center;
              font-style: italic;
              color: #666;
              border-top: 1px solid #ddd;
              padding-top: 15px;
              font-size: 9px;
            }
            .signature {
              margin-top: 30px;
              display: flex;
              justify-content: space-between;
            }
            .signature-box {
              text-align: center;
              width: 180px;
              Margin-top: 20px;
            }
            .signature-line {
              margin-top: 60px;
              border-top: 1px solid #2c3e50;
              padding-top: 8px;
              font-size: 10px;
            }
          </style>
        </head>
        <body>
          <!-- En-t√™te avec logo et titre bilingue -->
          <div class="header">
            <div class="logo">
              <img src="${Ae}" alt="Logo DGB" />
            </div>
            <div class="title">
              <h1>CENTRE D'EXCELLENCE DGB</h1>
              <h2>DGB CENTRE OF EXCELLENCE</h2>
              <h2 style="margin-top: 10px; color: #1a237e;">RELEV√â DE NOTES / TRANSCRIPT</h2>
            </div>
          </div>
          
          <!-- Informations apprenant -->
          <div class="info-section">
            <div class="info-grid">
              <div class="info-item">
                <div class="info-label">Nom & Pr√©noms</div>
                <div class="info-value">${i.NOM||""} ${i.PRENOM||""}</div>
              </div>
              <div class="info-item">
                <div class="info-label">Matricule</div>
                <div class="info-value">${i.MATRICULE||"N/A"}</div>
              </div>
              <div class="info-item">
                <div class="info-label">Grade</div>
                <div class="info-value">${i.GRADE||"N/A"}</div>
              </div>
              <div class="info-item">
                <div class="info-label">Fonction</div>
                <div class="info-value">${i.FONCTION||"N/A"}</div>
              </div>
              <div class="info-item">
                <div class="info-label">Structure</div>
                <div class="info-value">${i.NOMSTRUCTURE_PARENT||i.NOMSTRUCTURE||""} (${i.ABBREVIATION_PARENT||i.ABBREVIATION||""})</div>
              </div>
              <div class="info-item">
                <div class="info-label">Date</div>
                <div class="info-value">${le().format("DD/MM/YYYY")}</div>
              </div>
            </div>
          </div>

          <!-- Tableau des notes - TOUS les modules sont affich√©s -->
          ${y.map(V=>{let T=0,Z=0;return`
              <div class="formation-title">
                üìò ${V.formation_intitule}
              </div>
              <table>
                <thead>
                  <tr>
                    <th width="40%">Module / √âvaluation</th>
                    <th width="15%" align="center">Coefficient</th>
                    <th width="15%" align="center">Note/20</th>
                    <th width="15%" align="center">Note √ó Coef</th>
                    <th width="15%" align="center">Appr√©ciation</th>
                  </tr>
                </thead>
                <tbody>
                  ${V.evaluations.map(M=>{const B=M.note,ge=M.APPRECIATION||(B>=16?"TB":B>=14?"B":B>=12?"AB":B>=10?"Passable":B>=8?"Insuffisant":"Faible");return B!==null&&(T+=M.coefficient,Z+=B*M.coefficient),B!==null?`
                        <tr>
                          <td>${M.INTITULE||M.MODULE_INTITULE||"Module"}</td>
                          <td style="text-align: center;">${M.coefficient.toFixed(1)}</td>
                          <td style="text-align: center;">
                            <span class="badge badge-${B>=12?"success":B>=10?"warning":"error"}">
                              ${B.toFixed(2)}
                            </span>
                          </td>
                          <td style="text-align: center; font-weight: bold;">
                            ${M.noteXCoef}
                          </td>
                          <td style="text-align: center;">
                            ${fe[ge]||ge}
                          </td>
                        </tr>
                      `:`
                        <tr>
                          <td>${M.INTITULE||M.MODULE_INTITULE||"Module"}</td>
                          <td style="text-align: center;">${M.coefficient.toFixed(1)}</td>
                          <td style="text-align: center;">
                            <span class="badge badge-default" style="background: #f5f5f5; color: #9e9e9e;">
                              --
                            </span>
                          </td>
                          <td style="text-align: center; font-weight: bold; color: #9e9e9e;">
                            --
                          </td>
                          <td style="text-align: center; color: #9e9e9e;">
                            Non not√©
                          </td>
                        </tr>
                      `}).join("")}
                  
                  </tbody>
              </table>
            `}).join("")}

          <!-- Ligne des totaux g√©n√©raux -->
          <div style="margin-top: 20px; padding: 10px; background: #e8eaf6; border-radius: 4px; font-weight: bold;">
            <table style="width: 100%; margin: 0; background: transparent;">
              <tr>
                <td style="width: 40%; text-align: right;">TOTAUX G√âN√âRAUX :</td>
                <td style="width: 15%; text-align: center;">${h.toFixed(1)}</td>
                <td style="width: 15%; text-align: center;">-</td>
                <td style="width: 15%; text-align: center;">${D.toFixed(2)}</td>
                <td style="width: 15%; text-align: center;"></td>
              </tr>
            </table>
          </div>

          <!-- Statistiques g√©n√©rales -->
          <div class="stats-section">
            <div class="stat-item">
              <div class="stat-value">${ie}</div>
              <div class="stat-label">Moyenne</div>
            </div>
            <div class="stat-item">
              <div class="stat-value">${Q} / ${R.length}</div>
              <div class="stat-label">Notes valides</div>
            </div>
          </div>

          <!-- Signature -->
          <div class="signature">
            <div class="signature-box">
              <div>Fait √† Yaound√©, le ${le().format("DD/MM/YYYY")}</div>
              <div class="signature-line">Le Chef de Centre</div>
            </div>
            <div class="signature-box">
              <div class="signature-line">L'Apprenant</div>
            </div>
          </div>

          <!-- Pied de page bilingue -->
          <div class="footer">
            <p>Relev√© g√©n√©r√© le ${le().format("DD/MM/YYYY √† HH:mm")} ‚Ä¢ Generated on ${le().format("MM/DD/YYYY [at] HH:mm")}</p>
            
          </div>
        </body>
      </html>
    `},F=i=>i.STRUCTURE_HIERARCHY?i.STRUCTURE_HIERARCHY.split(" / ")[0]:i.SERVICECENTRAL||"Direction G√©n√©rale du Budget",C=(i,c="success")=>{H({open:!0,message:i,severity:c})},s=()=>{H(i=>({...i,open:!1}))},m=[{label:"Formation",icon:e.jsx(ue,{}),description:"S√©lectionnez la formation"},{label:"Apprenant",icon:e.jsx(xe,{}),description:"Cliquez pour imprimer"}];return e.jsxs(G.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[e.jsx(Re,{open:P.open,autoHideDuration:3e3,onClose:s,anchorOrigin:{vertical:"top",horizontal:"center"},TransitionComponent:Me,sx:{mt:8,zIndex:9999},children:e.jsx(De,{onClose:s,severity:P.severity,variant:"filled",sx:{borderRadius:3},children:P.message})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{item:!0,xs:12,children:e.jsx(L,{sx:{p:2.5,borderRadius:3,bgcolor:"rgba(255,255,255,0.8)",backdropFilter:"blur(8px)",border:"1px solid rgba(25,118,210,0.08)"},children:e.jsxs(r,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(r,{sx:{mr:2},children:e.jsx("img",{src:Ae,alt:"Logo DGB",style:{width:"60px",height:"auto"}})}),e.jsxs(r,{children:[e.jsx(n,{variant:"h5",fontWeight:600,sx:{color:l.palette.primary.main},children:"Relev√© de notes"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Impression automatique ‚Ä¢ Centre d'Excellence DGB"})]})]}),u===1&&e.jsx(W,{variant:"outlined",startIcon:e.jsx(ot,{}),onClick:g,size:"small",sx:{borderRadius:2},children:"Nouvelle recherche"})]})})}),e.jsx(p,{item:!0,xs:12,children:e.jsx(L,{sx:{p:2,borderRadius:3,bgcolor:"rgba(255,255,255,0.6)",backdropFilter:"blur(4px)"},children:e.jsx(Pe,{activeStep:u,alternativeLabel:!0,children:m.map((i,c)=>e.jsx(Be,{children:e.jsxs(We,{StepIconComponent:()=>e.jsx(Ue,{color:"primary",variant:u>c?"dot":"standard",invisible:u<=c,children:e.jsx(k,{sx:{width:44,height:44,bgcolor:u>=c?l.palette.primary.main:"rgba(0,0,0,0.04)",color:u>=c?"white":"text.secondary",border:u===c?`3px solid ${l.palette.primary.light}`:"none"},children:i.icon})}),children:[e.jsx(n,{variant:"body2",fontWeight:u===c?700:400,children:i.label}),e.jsx(n,{variant:"caption",color:"text.secondary",children:i.description})]})},i.label))})})}),e.jsx(p,{item:!0,xs:12,children:e.jsxs(Ge,{mode:"wait",children:[u===0&&e.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsxs(L,{sx:{p:3,borderRadius:3,bgcolor:"rgba(255,255,255,0.6)",backdropFilter:"blur(4px)"},children:[e.jsxs(r,{display:"flex",alignItems:"center",mb:3,children:[e.jsx($e,{sx:{mr:1,color:l.palette.primary.main}}),e.jsx(n,{variant:"h6",fontWeight:600,children:"S√©lectionner une formation"})]}),N.formations?e.jsx(r,{display:"flex",justifyContent:"center",py:6,children:e.jsx(oe,{size:60})}):e.jsx(p,{container:!0,spacing:2,children:w.map(i=>{const c=Y.filter(y=>y.IDFORMATIONM===i.IDFORMATION).length;return e.jsx(p,{item:!0,xs:12,md:6,children:e.jsx(pe,{onClick:()=>d(i),sx:{borderRadius:2,cursor:"pointer",transition:"all 0.2s",border:"1px solid rgba(0,0,0,0.04)","&:hover":{borderColor:l.palette.primary.main,boxShadow:"0 8px 24px rgba(25,118,210,0.12)",transform:"translateY(-2px)"}},children:e.jsx(he,{sx:{p:3},children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(k,{sx:{bgcolor:"rgba(25,118,210,0.04)",color:l.palette.primary.main,width:56,height:56,mr:2},children:e.jsx(_e,{sx:{fontSize:28}})}),e.jsxs(r,{flex:1,children:[e.jsx(n,{variant:"h6",fontWeight:600,gutterBottom:!0,children:i.FORMATION_INTITULE}),e.jsxs(r,{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",children:[e.jsx(ae,{size:"small",icon:e.jsx(ue,{}),label:`${i.MODULES?.length||0} modules`,variant:"outlined"}),e.jsx(ae,{size:"small",icon:e.jsx(xe,{}),label:`${c} apprenants`,color:"primary",variant:"outlined"})]})]})]})})})},i.IDFORMATION)})})]})},"step1"),u===1&&f&&e.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsxs(L,{sx:{p:3,borderRadius:3,bgcolor:"rgba(255,255,255,0.6)",backdropFilter:"blur(4px)"},children:[e.jsxs(r,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3,children:[e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(xe,{sx:{mr:1,color:l.palette.primary.main}}),e.jsx(n,{variant:"h6",fontWeight:600,children:"S√©lectionner un apprenant"})]}),e.jsx(W,{variant:"text",startIcon:e.jsx(Ve,{}),onClick:v,size:"small",children:"Changer de formation"})]}),e.jsxs(r,{sx:{mb:3,p:2,bgcolor:"rgba(25,118,210,0.02)",borderRadius:2,borderLeft:`4px solid ${l.palette.primary.main}`},children:[e.jsx(n,{variant:"caption",color:"text.secondary",children:"Formation s√©lectionn√©e"}),e.jsx(n,{variant:"subtitle1",fontWeight:600,children:f.FORMATION_INTITULE}),e.jsxs(n,{variant:"caption",color:"primary.main",sx:{mt:.5,display:"flex",alignItems:"center"},children:[e.jsx(Ze,{sx:{fontSize:14,mr:.5}})," Le clic sur un apprenant imprime automatiquement son relev√©"]})]}),e.jsx(r,{mb:3,children:e.jsx(Ee,{fullWidth:!0,size:"medium",placeholder:"Rechercher par nom, pr√©nom, matricule ou structure...",value:E,onChange:i=>$(i.target.value),InputProps:{startAdornment:e.jsx(me,{position:"start",children:e.jsx(Ce,{sx:{color:l.palette.text.secondary}})}),endAdornment:E&&e.jsx(me,{position:"end",children:e.jsx(Oe,{size:"small",onClick:()=>$(""),children:e.jsx(Le,{fontSize:"small"})})}),sx:{borderRadius:3,bgcolor:"rgba(0,0,0,0.01)"}}})}),N.apprenants?e.jsx(r,{display:"flex",justifyContent:"center",py:6,children:e.jsx(oe,{})}):e.jsx(r,{sx:{maxHeight:450,overflow:"auto",pr:1},children:U.length===0?e.jsxs(r,{display:"flex",flexDirection:"column",alignItems:"center",py:8,children:[e.jsx(k,{sx:{width:80,height:80,bgcolor:"rgba(0,0,0,0.04)",mb:2},children:e.jsx(xe,{sx:{fontSize:40,color:l.palette.text.secondary}})}),e.jsx(n,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"Aucun apprenant trouv√©"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Aucun apprenant n'est inscrit √† cette formation"})]}):e.jsx(p,{container:!0,spacing:2,children:U.map((i,c)=>e.jsx(p,{item:!0,xs:12,children:e.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:c*.05},children:e.jsx(pe,{onClick:()=>A(i),sx:{cursor:"pointer",transition:"all 0.2s",border:"1px solid rgba(0,0,0,0.04)",bgcolor:N.releve?"rgba(25,118,210,0.02)":"white","&:hover":{bgcolor:"rgba(25,118,210,0.08)",borderColor:l.palette.primary.main,transform:"scale(1.01)"}},children:e.jsx(he,{sx:{py:2,"&:last-child":{pb:2}},children:e.jsxs(r,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsxs(k,{sx:{width:48,height:48,mr:2,bgcolor:l.palette.primary.main,color:"white"},children:[i.NOM?.charAt(0),i.PRENOM?.charAt(0)]}),e.jsxs(r,{children:[e.jsxs(n,{variant:"subtitle1",fontWeight:600,children:[i.NOM," ",i.PRENOM]}),e.jsxs(r,{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap",children:[e.jsxs(n,{variant:"caption",color:"text.secondary",children:[e.jsx(at,{sx:{fontSize:14,mr:.5,verticalAlign:"middle"}}),i.MATRICULE||"N/A"]}),e.jsxs(n,{variant:"caption",color:"text.secondary",children:[e.jsx(He,{sx:{fontSize:14,mr:.5,verticalAlign:"middle"}}),F(i)]})]})]})]}),e.jsx(W,{variant:"contained",startIcon:e.jsx(Ze,{}),size:"small",disabled:N.releve,sx:{bgcolor:l.palette.success.main,"&:hover":{bgcolor:l.palette.success.dark},borderRadius:2},children:N.releve?"Impression...":"Imprimer"})]})})})})},i.IDPERSONNEL))})})]})},"step2")]})})]})]})};le.locale("fr");const as=()=>{const l=Ie(),[w,re]=x.useState([]),[Y,q]=x.useState([]),[U,se]=x.useState([]),[f,X]=x.useState(null),[ce,_]=x.useState(null),[R,O]=x.useState(null),[N,I]=x.useState({formations:!1,apprenants:!1,attestation:!1}),[E,$]=x.useState(""),[u,te]=x.useState(0),[P,H]=x.useState({open:!1,message:"",severity:"success"}),J="",K={headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}},fe=async()=>{I(s=>({...s,formations:!0}));try{const s=await fetch(`${J}/listemodulesCoefficient`,{method:"GET",headers:K.headers});if(s.ok){const m=await s.json();re(m.formations||[])}}catch{S("Erreur de chargement des formations","error")}finally{I(s=>({...s,formations:!1}))}},ne=async()=>{I(s=>({...s,apprenants:!0}));try{const s=await fetch(`${J}/listepersonelformescentreexcellence`,{method:"GET",headers:K.headers});if(s.ok){const m=await s.json();q(m)}}catch{S("Erreur de chargement des apprenants","error")}finally{I(s=>({...s,apprenants:!1}))}};x.useEffect(()=>{fe(),ne()},[]),x.useEffect(()=>{if(!f){se([]);return}const s=Y.filter(m=>m.IDFORMATIONM===f.IDFORMATION);if(E.trim()==="")se(s);else{const m=E.toLowerCase(),i=s.filter(c=>`${c.NOM} ${c.PRENOM}`.toLowerCase().includes(m)||c.MATRICULE?.toLowerCase().includes(m)||z(c).toLowerCase().includes(m));se(i)}},[E,Y,f]);const de=s=>{X(s),te(1),_(null),O(null),$("")},o=()=>{te(s=>Math.max(0,s-1)),u===1&&X(null),u===2&&(_(null),O(null))},d=()=>{te(0),X(null),_(null),O(null),$("")},v=async s=>{I(m=>({...m,attestation:!0}));try{const m=await fetch(`${J}/releveNotes/${s.IDPERSONNEL}`,{method:"GET",headers:K.headers});if(m.ok){const i=await m.json(),y=(i.EVALUATIONS||[]).filter(Z=>Z.formation_id===f.IDFORMATION),h=y.map(Z=>parseFloat(Z.NOTE)||Z.note).filter(Boolean),D=h.length>0?(h.reduce((Z,M)=>Z+M,0)/h.length).toFixed(2):"N/A";let Q="",ie="#1a237e";const V=parseFloat(D);isNaN(V)||(V>=16?(Q="TR√àS BIEN",ie="#2e7d32"):V>=14?(Q="BIEN",ie="#2e7d32"):V>=12?(Q="ASSEZ BIEN",ie="#1976d2"):V>=10?(Q="PASSABLE",ie="#ed6c02"):(Q="INSUFFISANT",ie="#d32f2f"));const T={...i,formation:f,moyenne:D,mention:Q,mentionColor:ie,notesValides:h.length,totalModules:y.length,dateEmission:le().format("DD/MM/YYYY"),numeroAttestation:`ATT-${f.IDFORMATION}-${s.IDPERSONNEL}-${le().format("YYYYMMDD")}`};_(s),O(T),setTimeout(()=>{g(T)},200)}else throw new Error("Erreur lors du chargement")}catch(m){console.error("Erreur:",m),S("Erreur lors du chargement de l'attestation","error")}finally{I(m=>({...m,attestation:!1}))}},g=s=>{const m=A(s),i=document.createElement("iframe");i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.border="none",i.style.visibility="hidden",document.body.appendChild(i);const c=i.contentWindow.document;c.open(),c.write(m),c.close(),i.contentWindow.focus(),i.contentWindow.print(),setTimeout(()=>{document.body.removeChild(i)},1e3)},A=s=>{if(!s)return"";const m=s.NOMSTRUCTURE_PARENT||s.NOMSTRUCTURE||"Direction G√©n√©rale du Budget",i=s.ABBREVIATION_PARENT||s.ABBREVIATION||"DGB",c=s.formation?.ANNEE1?`${s.formation.ANNEE1}${s.formation.ANNEE2?`-${s.formation.ANNEE2}`:""}${s.formation.ANNEE3?`-${s.formation.ANNEE3}`:""}`:le().format("YYYY");return`
      <!DOCTYPE html>
      <html>
        <head>
          <meta charset="UTF-8">
          <title>Attestation - ${s.NOM} ${s.PRENOM}</title>
          <style>
            @page { 
              size: A4 landscape;
              margin: 1cm; /* ‚úÖ Marges r√©duites */
            }
            body { 
              font-family: 'Times New Roman', Times, serif;
              line-height: 1.3; /* ‚úÖ Interligne r√©duit */
              color: #2c3e50;
              background: white;
              font-size: 12px; /* ‚úÖ Police r√©duite */
              margin: 0;
              padding: 0;
            }
            .container {
              width: 100%;
              height: 100%;
              display: flex;
              flex-direction: column;
              justify-content: space-between;
            }
            
            /* ‚úÖ En-t√™te compact */
            .header {
              display: flex;
              align-items: center;
              justify-content: space-between;
              margin-bottom: 15px;
              padding-bottom: 10px;
              border-bottom: 2px solid #1a237e;
            }
            .logo { width: 70px; height: 70px; }
            .logo img { width: 100%; height: auto; }
            .title { text-align: right; }
            .title h1 { 
              color: #1a237e; 
              margin: 0; 
              font-size: 18px; 
              font-weight: bold;
            }
            .title h2 { 
              color: #0d47a1; 
              margin: 2px 0; 
              font-size: 13px; 
              font-weight: normal;
            }
            
            /* ‚úÖ Num√©ro d'attestation compact */
            .attestation-number {
              text-align: right;
              font-size: 10px;
              color: #666;
              margin-bottom: 5px;
              display: flex;
              justify-content: flex-end;
              align-items: center;
              gap: 10px;
            }
            .verification-badge {
              background: #e8f5e9;
              color: #2e7d32;
              padding: 3px 10px;
              border-radius: 20px;
              font-size: 10px;
              font-weight: bold;
            }
            
            /* ‚úÖ Titre principal r√©duit */
            .attestation-title {
              text-align: center;
              margin: 5px 0 10px;
            }
            .attestation-title h1 {
              font-size: 26px;
              font-weight: bold;
              color: #1a237e;
              text-transform: uppercase;
              letter-spacing: 3px;
              margin: 0;
            }
            .attestation-title h2 {
              font-size: 16px;
              font-weight: normal;
              color: #0d47a1;
              margin: 2px 0 0;
              font-style: italic;
            }
            
            /* ‚úÖ Cadre d√©coratif compact */
            .decorative-border {
              border: 1.5px solid #1a237e;
              padding: 15px;
              margin: 5px 0 10px;
              border-radius: 8px;
              background: linear-gradient(to bottom, #ffffff, #f8f9fa);
              position: relative;
            }
            .decorative-border::before {
              content: '';
              position: absolute;
              top: 5px;
              left: 5px;
              right: 5px;
              bottom: 5px;
              border: 1px dashed #1a237e;
              border-radius: 5px;
              pointer-events: none;
            }
            
            /* ‚úÖ Corps compact */
            .attestation-body {
              text-align: center;
            }
            .attestation-text {
              margin: 5px 0;
            }
            .highlight {
              font-size: 18px;
              font-weight: bold;
              color: #1a237e;
              text-transform: uppercase;
              border-bottom: 2px solid #1a237e;
              display: inline-block;
              padding-bottom: 3px;
              margin: 5px 0;
            }
            .mention {
              font-size: 20px;
              font-weight: bold;
              color: ${s.mentionColor||"#1a237e"};
              margin: 5px 0;
              text-transform: uppercase;
              letter-spacing: 2px;
              background: ${s.mentionColor?`${s.mentionColor}10`:"#1a237e10"};
              padding: 5px 15px;
              border-radius: 40px;
              display: inline-block;
            }
            
            /* ‚úÖ Nom de l'apprenant */
            .apprenant-name {
              font-size: 24px;
              font-weight: bold;
              color: #1a237e;
              margin: 5px 0;
            }
            
            /* ‚úÖ Grille de statistiques compacte */
            .stats-grid {
              display: flex;
              justify-content: center;
              gap: 20px;
              margin: 10px 0;
            }
            .stat-item {
              text-align: center;
              min-width: 100px;
            }
            .stat-value {
              font-size: 24px;
              font-weight: bold;
              color: #1a237e;
              line-height: 1.2;
            }
            .stat-label {
              font-size: 10px;
              color: #0d47a1;
              text-transform: uppercase;
            }
            
            /* ‚úÖ Informations compactes */
            .info-compact {
              display: grid;
              grid-template-columns: 3fr 1fr;
              gap: 10px;
              margin-left: 45px;
              padding: 10px;
              background: #f8f9fa;
              border-radius: 6px;
            }
            .info-row {
              display: flex;
              align-items: baseline;
            }
            .info-label {
              font-weight: bold;
              color: #0d47a1;
              width: 100px;
              font-size: 11px;
              text-transform: uppercase;
            }
            .info-value {
              font-size: 12px;
            }
            
            /* ‚úÖ Signatures compactes */
            .signature-section {
              display: flex;
              justify-content: space-between;
              margin-top: 15px;
              padding-top: 10px;
              border-top: 1px solid #ccc;
            }
            .signature-box {
              text-align: center;
              width: 200px;
            }
            .signature-title {
              font-weight: bold;
              color: #0d47a1;
              font-size: 12px;
            }
            .signature-line {
              margin-top: 50px;
              border-top: 1px solid #2c3e50;
              padding-top: 5px;
              font-size: 11px;
            }
            
            /* ‚úÖ Pied de page compact */
            .footer {
              text-align: center;
              font-style: italic;
              color: #666;
              border-top: 1px solid #ddd;
              padding-top: 8px;
              margin-top: 10px;
              font-size: 9px;
            }
            .footer p {
              margin: 2px 0;
            }
          </style>
        </head>
        <body>
          <div class="container">
            
            <!-- En-t√™te compact -->
            <div class="header">
              <div class="logo">
                <img src="${Ae}" alt="Logo DGB" />
              </div>
              <div class="title">
                <h1>CENTRE D'EXCELLENCE DGB</h1>
                <h2>DGB CENTRE OF EXCELLENCE</h2>
              </div>
            </div>
            
            <!-- Num√©ro d'attestation -->
            <div class="attestation-number">
              <span>N¬∞ ${s.numeroAttestation}</span>
              <span class="verification-badge">‚úì DOCUMENT OFFICIEL</span>
            </div>
            
            <!-- Titre -->
            <div class="attestation-title">
              <h1>ATTESTATION DE FORMATION</h1>
              <h2>CERTIFICATE OF COMPLETION</h2>
            </div>
            
            <!-- Cadre principal -->
            <div class="decorative-border">
              
              <!-- Corps -->
              <div class="attestation-body">
                <div style="font-size: 14px; margin-bottom: 5px;">
                  La Direction G√©n√©rale du Budget certifie que
                </div>
                
                <div class="apprenant-name">
                  ${s.NOM} ${s.PRENOM}
                </div>
                
                <div style="font-size: 12px; margin: 5px 0;">
                  <span style="background: #f0f4fa; padding: 4px 15px; border-radius: 20px;">
                    ${s.MATRICULE||"N/A"}
                  </span>
                </div>
                
                <div style="font-size: 14px; margin: 8px 0 5px;">
                  a suivi avec succ√®s la 
                </div>
                
                <div class="highlight">
                  ${s.formation?.FORMATION_INTITULE||"FORMATION"}
                </div>
                
                <div style="font-size: 12px; margin: 8px 0; color: #0d47a1;">
                  üìÖ P√©riode / Period: <span style="font-weight: bold;">${c}</span>
                </div>
                
                <!-- Statistiques compactes -->
                <div class="stats-grid">
                  <div class="stat-item">
                    <div class="stat-value">${s.moyenne}</div>
                    <div class="stat-label">Moyenne</div>
                    <div style="font-size: 9px;">/20</div>
                  </div>
                  <div class="stat-item">
                    <div class="stat-value" style="color: ${s.mentionColor};">${s.mention||"-"}</div>
                    <div class="stat-label">Mention</div>
                  </div>
                  <div class="stat-item">
                    <div class="stat-value">${s.notesValides||0}</div>
                    <div class="stat-label">Modules</div>
                    <div style="font-size: 9px;">valid√©s</div>
                  </div>
                </div>
                
                <!-- Informations structure -->
                <div class="info-compact">
                  <div class="info-row">
                    <span class="info-label">Structure:</span>
                    <span class="info-value">${m} (${i})</span>
                  </div>
                  <div class="info-row">
                    <span class="info-label">Fonction:</span>
                    <span class="info-value">${s.FONCTION||"Agent"}</span>
                  </div>
                  <div class="info-row">
                    <span class="info-label">Grade:</span>
                    <span class="info-value">${s.GRADE||"N/A"}</span>
                  </div>
                  <div class="info-row">
                    <span class="info-label">Date:</span>
                    <span class="info-value">${s.dateEmission}</span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Signatures -->
            <div class="signature-section">
              <div class="signature-box">
                <div class="signature-title">LE CHEF DE CENTRE</div>
                <div class="signature-line">Dr. EDOU ALO'O Cyril</div>
              </div>
              <div class="signature-box">
                <div class="signature-title">L'APPRENANT</div>
                <div class="signature-line">${s.NOM} ${s.PRENOM}</div>
              </div>
            </div>
            
            <!-- Lieu et date -->
            <div style="text-align: center; font-size: 11px; margin-top: 8px;">
              Fait √† Yaound√©, le ${s.dateEmission}
            </div>
            
            <!-- Pied de page compact -->
            <div class="footer">
              <p>Centre d'Excellence DGB ‚Ä¢ DGB Centre of Excellence</p>
            </div>
          </div>
        </body>
      </html>
    `},z=s=>s.STRUCTURE_HIERARCHY?s.STRUCTURE_HIERARCHY.split(" / ")[0]:s.SERVICECENTRAL||"Direction G√©n√©rale du Budget",S=(s,m="success")=>{H({open:!0,message:s,severity:m})},F=()=>{H(s=>({...s,open:!1}))},C=[{label:"Formation",icon:e.jsx(ue,{}),description:"S√©lectionnez la formation"},{label:"Apprenant",icon:e.jsx(xe,{}),description:"G√©n√©rez l'attestation"}];return e.jsxs(G.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[e.jsx(Re,{open:P.open,autoHideDuration:3e3,onClose:F,anchorOrigin:{vertical:"top",horizontal:"center"},TransitionComponent:Me,sx:{mt:8,zIndex:9999},children:e.jsx(De,{onClose:F,severity:P.severity,variant:"filled",sx:{borderRadius:3},children:P.message})}),e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{item:!0,xs:12,children:e.jsx(L,{sx:{p:2.5,borderRadius:3,bgcolor:"rgba(255,255,255,0.8)",backdropFilter:"blur(8px)",border:"1px solid rgba(25,118,210,0.08)"},children:e.jsxs(r,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(r,{sx:{mr:2},children:e.jsx("img",{src:Ae,alt:"Logo DGB",style:{width:"60px",height:"auto"}})}),e.jsxs(r,{children:[e.jsx(n,{variant:"h5",fontWeight:600,sx:{color:l.palette.primary.main},children:"Attestation de formation"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Format paysage ‚Ä¢ Impression 1 page"})]})]}),u===1&&e.jsx(W,{variant:"outlined",startIcon:e.jsx(ot,{}),onClick:d,size:"small",sx:{borderRadius:2},children:"Nouvelle recherche"})]})})}),e.jsx(p,{item:!0,xs:12,children:e.jsx(L,{sx:{p:2,borderRadius:3,bgcolor:"rgba(255,255,255,0.6)",backdropFilter:"blur(4px)"},children:e.jsx(Pe,{activeStep:u,alternativeLabel:!0,children:C.map((s,m)=>e.jsx(Be,{children:e.jsxs(We,{StepIconComponent:()=>e.jsx(Ue,{color:"primary",variant:u>m?"dot":"standard",invisible:u<=m,children:e.jsx(k,{sx:{width:44,height:44,bgcolor:u>=m?l.palette.primary.main:"rgba(0,0,0,0.04)",color:u>=m?"white":"text.secondary",border:u===m?`3px solid ${l.palette.primary.light}`:"none"},children:s.icon})}),children:[e.jsx(n,{variant:"body2",fontWeight:u===m?700:400,children:s.label}),e.jsx(n,{variant:"caption",color:"text.secondary",children:s.description})]})},s.label))})})}),e.jsx(p,{item:!0,xs:12,children:e.jsxs(Ge,{mode:"wait",children:[u===0&&e.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsxs(L,{sx:{p:3,borderRadius:3,bgcolor:"rgba(255,255,255,0.6)",backdropFilter:"blur(4px)"},children:[e.jsxs(r,{display:"flex",alignItems:"center",mb:3,children:[e.jsx($e,{sx:{mr:1,color:l.palette.primary.main}}),e.jsx(n,{variant:"h6",fontWeight:600,children:"S√©lectionner une formation"})]}),N.formations?e.jsx(r,{display:"flex",justifyContent:"center",py:6,children:e.jsx(oe,{size:60})}):e.jsx(p,{container:!0,spacing:2,children:w.map(s=>{const m=Y.filter(i=>i.IDFORMATIONM===s.IDFORMATION).length;return e.jsx(p,{item:!0,xs:12,md:6,children:e.jsx(pe,{onClick:()=>de(s),sx:{borderRadius:2,cursor:"pointer",transition:"all 0.2s",border:"1px solid rgba(0,0,0,0.04)","&:hover":{borderColor:l.palette.primary.main,boxShadow:"0 8px 24px rgba(25,118,210,0.12)",transform:"translateY(-2px)"}},children:e.jsx(he,{sx:{p:3},children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(k,{sx:{bgcolor:"rgba(25,118,210,0.04)",color:l.palette.primary.main,width:56,height:56,mr:2},children:e.jsx(_e,{sx:{fontSize:28}})}),e.jsxs(r,{flex:1,children:[e.jsx(n,{variant:"h6",fontWeight:600,gutterBottom:!0,children:s.FORMATION_INTITULE}),e.jsxs(r,{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",children:[e.jsx(ae,{size:"small",icon:e.jsx(ue,{}),label:`${s.MODULES?.length||0} modules`,variant:"outlined"}),e.jsx(ae,{size:"small",icon:e.jsx(xe,{}),label:`${m} apprenants`,color:"primary",variant:"outlined"})]})]})]})})})},s.IDFORMATION)})})]})},"step1"),u===1&&f&&e.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsxs(L,{sx:{p:3,borderRadius:3,bgcolor:"rgba(255,255,255,0.6)",backdropFilter:"blur(4px)"},children:[e.jsxs(r,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3,children:[e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(xe,{sx:{mr:1,color:l.palette.primary.main}}),e.jsx(n,{variant:"h6",fontWeight:600,children:"S√©lectionner un apprenant"})]}),e.jsx(W,{variant:"text",startIcon:e.jsx(Ve,{}),onClick:o,size:"small",children:"Changer de formation"})]}),e.jsxs(r,{sx:{mb:3,p:2,bgcolor:"rgba(25,118,210,0.02)",borderRadius:2,borderLeft:`4px solid ${l.palette.primary.main}`},children:[e.jsx(n,{variant:"caption",color:"text.secondary",children:"Formation s√©lectionn√©e"}),e.jsx(n,{variant:"subtitle1",fontWeight:600,children:f.FORMATION_INTITULE}),e.jsxs(n,{variant:"caption",color:"primary.main",sx:{mt:.5,display:"flex",alignItems:"center"},children:[e.jsx(st,{sx:{fontSize:14,mr:.5}})," Impression 1 page"]})]}),e.jsx(r,{mb:3,children:e.jsx(Ee,{fullWidth:!0,size:"medium",placeholder:"Rechercher par nom, pr√©nom, matricule ou structure...",value:E,onChange:s=>$(s.target.value),InputProps:{startAdornment:e.jsx(me,{position:"start",children:e.jsx(Ce,{sx:{color:l.palette.text.secondary}})}),endAdornment:E&&e.jsx(me,{position:"end",children:e.jsx(Oe,{size:"small",onClick:()=>$(""),children:e.jsx(Le,{fontSize:"small"})})}),sx:{borderRadius:3,bgcolor:"rgba(0,0,0,0.01)"}}})}),N.apprenants?e.jsx(r,{display:"flex",justifyContent:"center",py:6,children:e.jsx(oe,{})}):e.jsx(r,{sx:{maxHeight:450,overflow:"auto",pr:1},children:U.length===0?e.jsxs(r,{display:"flex",flexDirection:"column",alignItems:"center",py:8,children:[e.jsx(k,{sx:{width:80,height:80,bgcolor:"rgba(0,0,0,0.04)",mb:2},children:e.jsx(xe,{sx:{fontSize:40,color:l.palette.text.secondary}})}),e.jsx(n,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"Aucun apprenant trouv√©"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Aucun apprenant n'est inscrit √† cette formation"})]}):e.jsx(p,{container:!0,spacing:2,children:U.map((s,m)=>e.jsx(p,{item:!0,xs:12,children:e.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:m*.05},children:e.jsx(pe,{onClick:()=>v(s),sx:{cursor:"pointer",transition:"all 0.2s",border:"1px solid rgba(0,0,0,0.04)",bgcolor:N.attestation?"rgba(25,118,210,0.02)":"white","&:hover":{bgcolor:"rgba(25,118,210,0.08)",borderColor:l.palette.primary.main,transform:"scale(1.01)"}},children:e.jsx(he,{sx:{py:2,"&:last-child":{pb:2}},children:e.jsxs(r,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsxs(k,{sx:{width:48,height:48,mr:2,bgcolor:l.palette.primary.main,color:"white"},children:[s.NOM?.charAt(0),s.PRENOM?.charAt(0)]}),e.jsxs(r,{children:[e.jsxs(n,{variant:"subtitle1",fontWeight:600,children:[s.NOM," ",s.PRENOM]}),e.jsxs(r,{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap",children:[e.jsxs(n,{variant:"caption",color:"text.secondary",children:[e.jsx(at,{sx:{fontSize:14,mr:.5,verticalAlign:"middle"}}),s.MATRICULE||"N/A"]}),e.jsxs(n,{variant:"caption",color:"text.secondary",children:[e.jsx(He,{sx:{fontSize:14,mr:.5,verticalAlign:"middle"}}),z(s)]})]})]})]}),e.jsx(W,{variant:"contained",startIcon:e.jsx(st,{}),size:"small",disabled:N.attestation,sx:{bgcolor:l.palette.primary.main,"&:hover":{bgcolor:l.palette.primary.dark},borderRadius:2},children:N.attestation?"G√©n√©ration...":"Attestation"})]})})})})},s.IDPERSONNEL))})})]})},"step2")]})})]})]})},it=[{id:"consulter",label:"Consulter",icon:e.jsx(Kt,{}),component:e.jsx(St,{}),description:"Visualiser toutes les notes"},{id:"saisie",label:"Saisie",icon:e.jsx(Zt,{}),component:e.jsx(ns,{}),description:"Enregistrer de nouvelles notes"},{id:"coefficients",label:"Coefficients",icon:e.jsx(lt,{}),component:e.jsx(rs,{}),description:"G√©rer les coefficients des modules"},{id:"releve",label:"Relev√©",icon:e.jsx(ss,{}),component:e.jsx(os,{}),description:"G√©n√©rer le relev√© de notes"},{id:"attestation",label:"Attestation",icon:e.jsx(is,{}),component:e.jsx(as,{}),description:"G√©n√©rer les attestations de formation"}],oi=()=>{const l=Ie(),[w,re]=x.useState(0),Y=(q,U)=>{re(U)};return e.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs(p,{container:!0,spacing:3,children:[e.jsx(p,{item:!0,xs:12,children:e.jsx(L,{sx:{p:1,borderRadius:4,background:"linear-gradient(45deg, #c6daf767, #91adf36f)",color:"black",boxShadow:l.shadows[3]},children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(k,{sx:{bgcolor:"rgba(244, 247, 249, 0.93)",mr:2,width:60,height:60},children:e.jsx(ct,{sx:{fontSize:32,color:"blue"}})}),e.jsxs(r,{children:[e.jsx(n,{variant:"h4",fontWeight:700,sx:{color:"blue"},children:"Gestion des √âvaluations"}),e.jsx(n,{variant:"body1",sx:{opacity:.9},children:"Centre d'Excellence ‚Ä¢ Notes, coefficients et attestations"})]})]})})}),e.jsx(p,{item:!0,xs:12,children:e.jsx(L,{sx:{p:2,borderRadius:4,boxShadow:l.shadows[3],backgroundColor:"#fff"},children:e.jsx(It,{value:w,onChange:Y,variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,sx:{"& .MuiTab-root":{minHeight:64,flexDirection:"row",alignItems:"center",justifyContent:"flex-start",gap:1,px:3,py:1,mx:.5,borderRadius:3,textTransform:"none",fontSize:"1rem",fontWeight:500,color:"text.secondary",transition:"all 0.2s ease-in-out","&:hover":{backgroundColor:"rgba(25, 118, 210, 0.04)",color:"primary.main"},"&.Mui-selected":{color:"primary.main",backgroundColor:"rgba(25, 118, 210, 0.08)",fontWeight:600}},"& .MuiTabs-indicator":{height:3,borderRadius:3,backgroundColor:l.palette.primary.main}},children:it.map(q=>e.jsx(Nt,{icon:q.icon,label:e.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",ml:.5},children:[e.jsx(n,{variant:"body1",fontWeight:"inherit",children:q.label}),e.jsx(n,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:q.description})]}),iconPosition:"start"},q.id))})})}),e.jsx(p,{item:!0,xs:12,children:e.jsx(G.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.3},children:it[w].component},w)})]})})};export{oi as default};
