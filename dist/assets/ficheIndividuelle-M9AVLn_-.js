import{r as i,j as e,B as t,H as q,s as h,T as s,L as X,N as Z,Q as J,ah as K,U as ee,ai as w,aj as A,ak as re,al as oe,Z as te,Y as se,z as ne,G as f,w as g,am as O,an as ae,ao as ie,ap as le,aq as de,C as ce,v as xe}from"./index-zHPv1lze.js";import{a as fe}from"./index-C3O71W1x.js";import{R as he}from"./index-BJqg444i.js";import{T as pe}from"./TextField-DNVhVnCv.js";import{P as me}from"./Pagination-BeHNtj-4.js";import{a as be,D as ue}from"./DialogContent-COvIddmc.js";import{D as ge}from"./DialogActions-CZ9LuKoL.js";import{B as D}from"./Button-0T1tR8_c.js";import{L as je}from"./ListItem-CSuwil7H.js";import"./OutlinedInput-C5vYvqQm.js";import"./useFormControl-BwsGWz84.js";import"./Select-DCG_CkE0.js";import"./FormHelperText-BXMwkblB.js";import"./LastPage-aHJdqG80.js";import"./ButtonGroupButtonContext-BYVHV5Ft.js";const Ce=h(ne)(({theme:r})=>({padding:"24px",borderRadius:"16px",backgroundColor:"#fafafa",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.08)",border:"1px solid #e8e8e8"})),ye=h(je)(({theme:r})=>({backgroundColor:"#ffffff",borderRadius:"12px",marginBottom:"12px",transition:"all 0.3s ease",border:"1px solid #e3e3e3",padding:"16px","&:hover":{backgroundColor:"#f8f9fa",transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.1)",borderColor:"#d1d5db"}})),j=h(ce)(({theme:r})=>({backgroundColor:"#ffffff",borderRadius:"12px",marginBottom:"16px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)",border:"1px solid #e8e8e8",transition:"all 0.2s ease","&:hover":{boxShadow:"0 4px 16px rgba(0, 0, 0, 0.1)"}})),Re=h(xe)(({theme:r})=>({backgroundColor:"#f0f4f8",color:"#4a5568",fontWeight:"500",border:"1px solid #e2e8f0","&.service-central":{backgroundColor:"#e6f3ff",color:"#0066cc",border:"1px solid #b3d9ff"},"&.service-deconcentre":{backgroundColor:"#f0f9ff",color:"#0369a1",border:"1px solid #bae6fd"}})),l=({icon:r,label:a,value:n,color:x="#6b7280"})=>e.jsxs(t,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(r,{style:{color:x,fontSize:"18px",marginRight:"12px",minWidth:"18px"}}),e.jsxs(s,{variant:"body2",sx:{color:"#4a5568",fontWeight:"500",minWidth:"140px"},children:[a,":"]}),e.jsx(s,{variant:"body2",sx:{color:"#2d3748",fontWeight:"400",ml:1},children:n})]}),F=({personnel:r})=>r?e.jsx(t,{sx:{marginBottom:3},children:e.jsxs(f,{container:!0,spacing:2,children:[e.jsx(f,{item:!0,xs:6,md:6,children:e.jsx(j,{children:e.jsxs(g,{sx:{pb:"16px !important"},children:[e.jsx(s,{variant:"h6",sx:{color:"#2d3748",fontWeight:"600",mb:2,fontSize:"1.1rem"},children:"Informations Personnelles"}),e.jsx(l,{icon:w,label:"Matricule",value:r.MATRICULE,color:"#6366f1"}),e.jsx(l,{icon:A,label:"Téléphone",value:r.TELEPHONE,color:"#10b981"}),e.jsx(l,{icon:O,label:"Sexe",value:r.SEXE,color:"#8b5cf6"})]})})}),e.jsx(f,{item:!0,xs:6,children:e.jsx(j,{children:e.jsxs(g,{sx:{pb:"16px !important"},children:[e.jsx(s,{variant:"h6",sx:{color:"#2d3748",fontWeight:"600",mb:1,fontSize:"1.1rem"},children:"Etudes et Grade"}),e.jsxs(t,{sx:{display:"flex",flexWrap:"wrap",mb:0},children:[e.jsx(l,{icon:ae,label:"Niveau d'Étude",value:r.NIVEAUETUDE,color:"#7c3aed"}),e.jsx(l,{icon:O,label:"Grade",value:r.GRADE,color:"#dc2626"}),e.jsx(l,{icon:ie,label:"Catégorie",value:r.CATEGORIE,color:"#ef4444"})]}),e.jsx(t,{sx:{mt:2},children:e.jsx(Re,{label:r.SERVICECENTRAL,className:r.SERVICECENTRAL,size:"small"})})]})})}),e.jsx(f,{item:!0,xs:12,children:e.jsx(j,{children:e.jsxs(g,{sx:{pb:"16px !important"},children:[e.jsx(s,{variant:"h6",sx:{color:"#2d3748",fontWeight:"600",mb:2,fontSize:"1.1rem"},children:"Informations Professionnelles"}),e.jsx(l,{icon:le,label:"Fonction",value:r.FONCTION,color:"#f59e0b"}),e.jsx(l,{icon:de,label:"Structure",value:r.STRUCTURE_HIERARCHY||"Non définie",color:"#06b6d4"})]})})})]})}):null,W=r=>{if(!r||r==="0000-00-00"||r==="Invalid date")return"—";const a=new Date(r);return isNaN(a.getTime())?"—":a.toLocaleDateString("fr-FR")},z=({formations:r})=>e.jsx(t,{sx:{marginTop:2},children:e.jsx(t,{sx:{overflow:"auto",borderRadius:"8px",border:"1px solid #e5e7eb"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",backgroundColor:"#ffffff"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f8fafc"},children:[e.jsx("th",{style:d.tableHeader,children:"Formation"}),e.jsx("th",{style:d.tableHeader,children:"Date de Début"}),e.jsx("th",{style:d.tableHeader,children:"Date de Fin"})]})}),e.jsx("tbody",{children:r.map((a,n)=>e.jsxs("tr",{style:{backgroundColor:n%2===0?"#ffffff":"#f9fafb"},children:[e.jsx("td",{style:d.tableCell,children:a.title}),e.jsx("td",{style:d.tableCell,children:W(a.startDate)}),e.jsx("td",{style:d.tableCell,children:W(a.endDate)})]},n))})]})})}),d={tableHeader:{border:"1px solid #e5e7eb",padding:"12px 16px",textAlign:"left",backgroundColor:"#f8fafc",fontWeight:"600",color:"#374151",fontSize:"0.875rem"},tableCell:{border:"1px solid #e5e7eb",padding:"12px 16px",color:"#4b5563",fontSize:"0.875rem"}},Ie=te.forwardRef(({personnel:r,formations:a},n)=>r?e.jsxs(t,{ref:n,sx:{padding:3,backgroundColor:"#ffffff"},children:[e.jsxs(t,{sx:{textAlign:"center",mb:4,borderBottom:"2px solid #e5e7eb",pb:3},children:[e.jsx(s,{variant:"h4",sx:{fontWeight:"700",textTransform:"uppercase",color:"#1f2937",letterSpacing:"0.5px"},children:"Fiche d'Identification"}),e.jsx(s,{variant:"h5",sx:{fontWeight:"600",color:"#4f46e5",mt:2,textTransform:"uppercase"},children:`${r.NOM} ${r.PRENOM}`})]}),e.jsx(F,{personnel:r}),e.jsxs(t,{sx:{mt:4},children:[e.jsxs(s,{variant:"h6",sx:{fontWeight:"600",color:"#1f2937",mb:2,borderBottom:"1px solid #e5e7eb",pb:1},children:["Formations Suivies (",a.length,")"]}),e.jsx(z,{formations:a})]})]}):null),ze=()=>{const[r,a]=i.useState(!1),[n,x]=i.useState(null),[B,$]=i.useState([]),[C,H]=i.useState(""),[U,y]=i.useState(!1),R=i.useRef(),[I,G]=i.useState(1),p=6,V=async()=>{y(!0);const o=localStorage.getItem("token"),c="";try{const u=(await fe.get(`${c}/listepersonelformes`,{headers:{Authorization:`Bearer ${o}`}})).data.sort((P,M)=>{const k=(P.NOM||"").replace(/\s+/g,"").toLowerCase(),N=(M.NOM||"").replace(/\s+/g,"").toLowerCase();if(k<N)return-1;if(k>N)return 1;const T=(P.PRENOM||"").replace(/\s+/g,"").toLowerCase(),L=(M.PRENOM||"").replace(/\s+/g,"").toLowerCase();return T<L?-1:T>L?1:0});$(u)}catch{se.error("Erreur lors de la récupération des personnels.")}finally{y(!1)}};i.useEffect(()=>{V()},[]);const Y=o=>{x(o),a(!0)},v=()=>{a(!1),x(null)},m=i.useMemo(()=>n?.FORMATIONS_DETAILS?n.FORMATIONS_DETAILS.split("|||").map(o=>{const[c,b,u]=(o||"").split(";;;");return{title:c?.trim()||"—",startDate:b||"",endDate:u||""}}):[],[n]),S=B.filter(o=>`${o.NOM} ${o.PRENOM} ${o.NOMMARI||""}`.toLowerCase().includes(C.toLowerCase())),E=I*p,_=E-p,Q=S.slice(_,E);return e.jsxs(t,{sx:{padding:3,minHeight:"100vh",backgroundColor:"#f7f8fa"},children:[e.jsx(q,{}),e.jsxs(Ce,{style:{minHeight:"80vh"},children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,pb:2,borderBottom:"1px solid #e5e7eb"},children:[e.jsx(s,{variant:"h4",sx:{color:"#1f2937",fontWeight:"700",letterSpacing:"0.5px"},children:"Personnels Formés"}),e.jsx(pe,{variant:"outlined",placeholder:"Rechercher un personnel...",size:"small",value:C,onChange:o=>H(o.target.value),sx:{width:"300px","& .MuiOutlinedInput-root":{backgroundColor:"#ffffff",borderRadius:"8px","& fieldset":{borderColor:"#d1d5db"},"&:hover fieldset":{borderColor:"#9ca3af"},"&.Mui-focused fieldset":{borderColor:"#6366f1"}}}})]}),U&&e.jsx(X,{sx:{marginBottom:3,bgcolor:"#e5e7eb","& .MuiLinearProgress-bar":{backgroundColor:"#6366f1"}}}),e.jsx(Z,{sx:{padding:0},children:Q.map(o=>e.jsxs(ye,{button:!0,onClick:()=>Y(o),children:[e.jsx(J,{sx:{minWidth:"56px"},children:e.jsx(t,{sx:{backgroundColor:"#f0f4f8",borderRadius:"50%",width:48,height:48,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(K,{style:{color:"#6366f1",fontSize:"20px"}})})}),e.jsx(ee,{primary:e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(s,{sx:{fontWeight:"600",color:"#1f2937",fontSize:"1rem"},children:`${o.NOM||""} ${o.PRENOM||""}${o.NOMMARI?" Épse. "+o.NOMMARI:""}`.trim()||"Nom inconnu"}),e.jsxs(t,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(A,{style:{color:"#6b7280",fontSize:"14px",marginRight:"6px"}}),e.jsx(s,{sx:{color:"#6b7280",fontSize:"0.875rem"},children:o.TELEPHONE})]})]}),secondary:e.jsxs(t,{sx:{display:"flex",alignItems:"center",mt:1},children:[e.jsx(w,{style:{color:"#9ca3af",fontSize:"14px",marginRight:"6px"}}),e.jsxs(s,{sx:{color:"#9ca3af",fontSize:"0.875rem"},children:["Matricule: ",o.MATRICULE]})]})})]},o.IDPERSONNEL))}),e.jsx(t,{sx:{display:"flex",justifyContent:"center",mt:4},children:e.jsx(me,{count:Math.ceil(S.length/p),page:I,onChange:(o,c)=>G(c),color:"primary",sx:{"& .MuiPaginationItem-root":{color:"#6b7280","&.Mui-selected":{backgroundColor:"#6366f1",color:"#ffffff"},"&:hover":{backgroundColor:"#f3f4f6"}}}})})]}),e.jsxs(be,{open:r,onClose:v,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:"16px",backgroundColor:"#fafafa"}},children:[e.jsx(ge,{sx:{position:"absolute",right:8,top:8,zIndex:1},children:e.jsx(D,{onClick:v,sx:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",width:"40px",height:"40px",minWidth:"40px",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{backgroundColor:"#f3f4f6",borderColor:"#d1d5db"}},children:e.jsx(re,{style:{color:"#6b7280",fontSize:"20px"}})})}),e.jsx(ue,{sx:{backgroundColor:"#fafafa",pt:4,pb:3},children:n?e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{textAlign:"center",mb:4,pb:3,borderBottom:"1px solid #e5e7eb"},children:[e.jsx(s,{variant:"h4",sx:{color:"#1f2937",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Fiche d'Identification"}),e.jsx(s,{variant:"h5",sx:{color:"#4f46e5",fontWeight:"600",mt:2,textTransform:"uppercase"},children:`${n.NOM} ${n.PRENOM}`})]}),e.jsx(F,{personnel:n}),e.jsxs(t,{sx:{mt:4},children:[e.jsxs(s,{variant:"h6",sx:{color:"#1f2937",fontWeight:"600",mb:2,borderBottom:"1px solid #e5e7eb",pb:1},children:["Formations Suivies (",m.length,")"]}),e.jsx(z,{formations:m})]}),e.jsx(t,{sx:{mt:4,display:"flex",justifyContent:"center"},children:e.jsx(he,{trigger:()=>e.jsx(D,{variant:"contained",sx:{backgroundColor:"#6366f1",color:"#ffffff",borderRadius:"8px",padding:"12px 24px",fontWeight:"600",textTransform:"none","&:hover":{backgroundColor:"#4f46e5"}},startIcon:e.jsx(oe,{}),children:"Imprimer la fiche"}),content:()=>R.current})}),e.jsx("div",{style:{display:"none"},children:e.jsx(Ie,{ref:R,personnel:n,formations:m})})]}):e.jsx(s,{children:"Aucun détail sélectionné."})})]})]})};export{ze as default};
