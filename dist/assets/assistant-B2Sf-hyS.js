import{l as ct,j as e,n as vt,aD as At,aE as Ft,t as It,r as o,z as Y,T as t,B as r,D as J,v as V,Z as te,F as he,G as W,C as Q,w as K,s as me,y as oe,A as zt,I as dt,R as kt,x as Wt,aB as Rt,V as Et,ac as Ct,aF as Tt,am as Dt,aG as Nt,aH as Mt,H as wt,Y as rt}from"./index-zHPv1lze.js";import{a as Z}from"./index-C3O71W1x.js";import{d as F}from"./dayjs.min-BzR6NVRV.js";import{C as q}from"./CircularProgress-BHFhENdB.js";import{Q as ee,E as _}from"./QueryStats-CBn45aSn.js";import{C as be}from"./CalendarToday-BYxDq_1X.js";import{T as ae,a as le,b as ce,c as G,d as a,e as de}from"./TableRow-70JfVjDg.js";import{E as pe}from"./Event-DCg_30F7.js";import{S as re}from"./Snackbar-XurLPfxZ.js";import{A as se}from"./Alert-D6te_eKs.js";import{B as ne}from"./Business-DP4Oq-gt.js";import{D as st}from"./DateRange-tTFtj54i.js";import{P as ve}from"./People-RwhYgLWm.js";import{b as Ge,A as Ve,a as Xe}from"./AccordionSummary-2JcKKmJQ.js";import{E as Je}from"./ExpandMore-DWiDQC_Y.js";import{T as Ie}from"./Timeline-BXnwFYdk.js";import{B as ge}from"./Badge-Q2tdgUxH.js";import{W as fe,P as ke,A as Ke,a as Ze}from"./Work-BOwzzg0q.js";import{P as We}from"./Person-CVTBdQV4.js";import{W as Be,M as Ue,S as $e,D as Oe,P as ye,L as Ee,T as Qe,a as nt}from"./Woman-m6hDNIwy.js";import{G as je}from"./Groups-DO3ZmRBj.js";import{W as Ae}from"./Warning-Dm-AjjkC.js";import{G as qe}from"./Group-CKNX0Zix.js";import{L as et}from"./LocationOn-We7TmFLi.js";import{C as xe}from"./react-apexcharts.min-rkE0FX8L.js";import{M as Fe,F as Ce}from"./Male-D6PrUK3l.js";import{T as Re}from"./TrendingUp-CnKnPJ6F.js";import{A as xt}from"./Assignment-jETtBEfQ.js";import{A as $t}from"./Assessment-DAI052hb.js";import{E as ut,a as _e}from"./EventBusy-Bj-M0_Ng.js";import{C as Ot}from"./CheckCircle-BB09QyVE.js";import{S as Pt}from"./Schedule-WrpPNihg.js";import{F as Lt,S as Yt}from"./Select-DCG_CkE0.js";import{I as Ht}from"./OutlinedInput-C5vYvqQm.js";import{M as Pe}from"./MenuItem-D-1uk7AZ.js";import{S as Bt}from"./Send-kcxa8VWl.js";import{a as ht,D as ft}from"./DialogContent-COvIddmc.js";import{D as mt}from"./DialogTitle-CCgKuUmv.js";import{C as gt}from"./Close-B5GqWx1j.js";import{D as bt}from"./DialogActions-CZ9LuKoL.js";import{B as Te}from"./Button-0T1tR8_c.js";import{D as pt,B as Ut,S as _t,C as Gt,E as Vt}from"./Store-C2vOdZMk.js";import{R as Xt}from"./Refresh-HvTEdGt2.js";import{S as Jt}from"./Settings-B2J8IDH3.js";import{T as Kt}from"./TextField-DNVhVnCv.js";import{I as Zt}from"./InputAdornment-BgDE6Kz5.js";import{C as Qt}from"./Cancel-ogBAkz-m.js";import{S as qt}from"./Save-ByVVUHNY.js";import"./Close-DS868zx3.js";import"./useFormControl-BwsGWz84.js";import"./ButtonGroupButtonContext-BYVHV5Ft.js";import"./FormHelperText-BXMwkblB.js";const jt=ct(e.jsx("path",{d:"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2zm1-9h1V4H2v1h1zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2zm5-6v2h14V5zm0 14h14v-2H7zm0-6h14v-2H7z"}),"FormatListNumbered"),er=ct(e.jsx("path",{d:"m20.38 8.57-1.23 1.85a8 8 0 0 1-.22 7.58H5.07A8 8 0 0 1 15.58 6.85l1.85-1.23A10 10 0 0 0 3.35 19a2 2 0 0 0 1.72 1h13.85a2 2 0 0 0 1.74-1 10 10 0 0 0-.27-10.44zm-9.79 6.84a2 2 0 0 0 2.83 0l5.66-8.49-8.49 5.66a2 2 0 0 0 0 2.83"}),"Speed");var De={},ot;function tr(){if(ot)return De;ot=1;var n=vt();Object.defineProperty(De,"__esModule",{value:!0}),De.default=void 0;var l=n(At()),s=Ft();return De.default=(0,l.default)((0,s.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send"),De}var rr=tr();const sr=It(rr),nr="/assets/logoprincipal-dP-GVAGl.png",or=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),ir=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(!1),[b,C]=o.useState([]),[f,R]=o.useState(!1),[j,k]=o.useState(""),[P,E]=o.useState("success");o.useEffect(()=>{let x=null,c=null;s&&(s.date_debut&&(x=F(s.date_debut)),s.date_fin&&(c=F(s.date_fin))),x||(x=F().subtract(1,"month")),c||(c=F()),$(x),N(c),n&&n.results?(C(n.results),M(`${n.results.length} formations trouv√©es`,"success")):l&&I(l)},[s,n,l]);const I=async x=>{if(!x)return;w(!0);const c=localStorage.getItem("token"),h="";try{const i=await Z.post(`${h}/personnaliserrequette`,{query:x},{headers:{Authorization:`Bearer ${c}`}});i.data&&Array.isArray(i.data)?(C(i.data),M(`${i.data.length} formations trouv√©es`,"success")):(C([]),M("Aucune formation trouv√©e.","info"))}catch(i){const d=i.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";M(d,"error")}finally{w(!1)}},M=(x,c)=>{k(x),E(c),R(!0)},O=()=>{R(!1)},v=x=>F(x).format("DD/MM/YYYY"),u=()=>B||"Liste des Formations par P√©riode",m=()=>z&&y?`Du ${v(z)} au ${v(y)}`:"P√©riode inconnue";return T?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:800,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des formations..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:800,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(ee,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:u()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:m()})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[b.length," formation(s) trouv√©e(s)"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"R√©sultats pour la p√©riode s√©lectionn√©e"})]}),e.jsx(V,{label:`${v(z)} ‚Üí ${v(y)}`,color:"primary",variant:"outlined",icon:e.jsx(be,{fontSize:"small"}),sx:{fontSize:"0.9rem",fontWeight:500,py:1}})]}),e.jsx(J,{sx:{my:2}}),e.jsx(ae,{sx:{border:"1px solid",borderColor:"#f0f0f0",borderRadius:2},children:e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",width:"50px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Intitul√©"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"B√©n√©ficiaires"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Date"})]})}),e.jsx(de,{children:b.length>0?b.map((x,c)=>e.jsxs(G,{hover:!0,sx:{"&:last-child td":{borderBottom:0}},children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:c+1}),e.jsx(a,{sx:{fontWeight:"bold"},children:x.INTITULE?x.INTITULE.toUpperCase():"-"}),e.jsx(a,{children:x.CIBLES||"-"}),e.jsx(a,{children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(pe,{fontSize:"small",color:"action",sx:{mr:1}}),v(x.DATE)]})})]},c)):e.jsx(G,{children:e.jsxs(a,{colSpan:4,align:"center",sx:{py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucune formation trouv√©e pour cette p√©riode"})]})})})]})})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:f,onClose:O,autoHideDuration:5e3,children:e.jsx(or,{onClose:O,severity:P,iconMapping:{success:e.jsx(pe,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:j})})})]})},ar=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),lr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(!1),[y,N]=o.useState([]),[T,w]=o.useState(!1),[b,C]=o.useState(""),[f,R]=o.useState("success"),[j,k]=o.useState(null),P="";o.useEffect(()=>{(async()=>{if(n&&n.results){N(n.results),k(n.structureInfo),I(`${n.results.length} formations trouv√©es`,"success");return}if(l&&s?.IDselectedStructure){$(!0);try{const m=l.replace("${IDselectedStructure}",`'${s.IDselectedStructure}'`),x=localStorage.getItem("token"),c=await Z.post(`${P}/personnaliserrequette`,{query:m},{headers:{Authorization:`Bearer ${x}`}});c.data&&Array.isArray(c.data)?(N(c.data),E(s.IDselectedStructure),I(`${c.data.length} formations trouv√©es`,"success")):(N([]),I("Aucune formation trouv√©e","info"))}catch(m){const x=m.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";I(x,"error")}finally{$(!1)}}})()},[n,l,s,P]);const E=async u=>{try{const m=localStorage.getItem("token"),x=await Z.get(`${P}/structure/${u}`,{headers:{Authorization:`Bearer ${m}`}});x.data&&k(x.data)}catch(m){console.error("Erreur lors de la r√©cup√©ration des informations de la structure:",m)}},I=(u,m)=>{C(u),R(m),w(!0)},M=()=>{w(!1)},O=u=>new Date(u).toLocaleDateString("fr-FR"),v=()=>B||"Formations par Structure";return z?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:800,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des formations..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:800,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(ne,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:v()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:j?.NOMSTRUCTURE||"Structure s√©lectionn√©e"})]})]}),e.jsx(J,{sx:{my:3}}),j&&e.jsxs(r,{sx:{mt:2,p:2,bgcolor:"#f0f8ff",borderRadius:2,border:"1px solid #e0e0e0",mb:3},children:[e.jsxs(t,{variant:"subtitle1",sx:{display:"flex",alignItems:"center"},children:[e.jsx(ne,{sx:{mr:1,color:"primary.main"}}),"Informations de la structure:"]}),e.jsx(t,{variant:"h6",sx:{ml:3,mt:1},children:j.NOMSTRUCTURE}),j.ABBREVIATION&&e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{ml:3},children:["Abr√©viation: ",j.ABBREVIATION]})]}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[y.length," formation(s) trouv√©e(s)"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Liste des formations b√©n√©fici√©es"})]}),j&&e.jsx(V,{label:j.ABBREVIATION||j.NOMSTRUCTURE,color:"primary",variant:"outlined",icon:e.jsx(ne,{fontSize:"small"}),sx:{fontSize:"0.9rem",fontWeight:500,py:1}})]}),e.jsx(J,{sx:{my:2}}),e.jsx(ae,{sx:{border:"1px solid",borderColor:"#f0f0f0",borderRadius:2},children:e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",width:"50px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Intitul√©"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"B√©n√©ficiaires"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Date"})]})}),e.jsx(de,{children:y.length>0?y.map((u,m)=>e.jsxs(G,{hover:!0,sx:{"&:last-child td":{borderBottom:0}},children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:m+1}),e.jsx(a,{sx:{fontWeight:"bold"},children:u.INTITULE?u.INTITULE.toUpperCase():"-"}),e.jsx(a,{children:u.CIBLES||"-"}),e.jsx(a,{children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(pe,{fontSize:"small",color:"action",sx:{mr:1}}),O(u.DATE)]})})]},m)):e.jsx(G,{children:e.jsxs(a,{colSpan:4,align:"center",sx:{py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucune formation trouv√©e pour cette structure"})]})})})]})})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:T,onClose:M,autoHideDuration:5e3,children:e.jsx(ar,{onClose:M,severity:f,iconMapping:{success:e.jsx(ne,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:b})})})]})},cr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),dr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(!1),[y,N]=o.useState([]),[T,w]=o.useState(!1),[b,C]=o.useState(""),[f,R]=o.useState("success"),[j,k]=o.useState(null),P="";o.useEffect(()=>{(async()=>{if(n&&n.results){N(n.results),k(n.structureInfo),I(`${n.results.length} formations trouv√©es`,"success");return}if(l&&s){const{IDselectedStructure:c,date_debut:h,date_fin:i}=s;if(!c||!h||!i){I("Param√®tres manquants pour ex√©cuter la requ√™te","error");return}$(!0);try{const d=L=>new Date(L).toISOString().split("T")[0],S=l.replace("${IDselectedStructure}",`'${c}'`).replace("${dateDebutFormatted}",`'${d(h)}'`).replace("${dateFinFormatted}",`'${d(i)}'`),A=localStorage.getItem("token"),g=await Z.post(`${P}/personnaliserrequette`,{query:S},{headers:{Authorization:`Bearer ${A}`}});g.data&&Array.isArray(g.data)?(N(g.data),E(c),I(`${g.data.length} formations trouv√©es`,"success")):(N([]),I("Aucune formation trouv√©e pour cette p√©riode et structure","info"))}catch(d){const S=d.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";I(S,"error")}finally{$(!1)}}})()},[n,l,s,P]);const E=async x=>{try{const c=localStorage.getItem("token"),h=await Z.get(`${P}/structure/${x}`,{headers:{Authorization:`Bearer ${c}`}});h.data&&k(h.data)}catch(c){console.error("Erreur lors de la r√©cup√©ration des informations de la structure:",c),I("Erreur lors du chargement des informations de la structure","error")}},I=(x,c)=>{C(x),R(c),w(!0)},M=()=>{w(!1)},O=x=>new Date(x).toLocaleDateString("fr-FR"),v=()=>B||"Formations par P√©riode et Structure",u=()=>s?.date_debut&&s?.date_fin?`du ${O(s.date_debut)} au ${O(s.date_fin)}`:"P√©riode non d√©finie",m=y.reduce((x,c)=>x+(parseInt(c.NOMBRE_PARTICIPANTS)||0),0);return z?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:300},children:[e.jsx(q,{size:50,color:"primary",sx:{mb:3}}),e.jsxs(t,{variant:"h6",color:"text.secondary",textAlign:"center",children:["Chargement des formations...",e.jsxs(r,{component:"p",fontSize:"body2.fontSize",mt:1,children:["Structure: ",s?.IDselectedStructure||"Non sp√©cifi√©e"]})]})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(st,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:v()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:j?.NOMSTRUCTURE||"Structure s√©lectionn√©e"})]})]}),e.jsx(J,{sx:{my:3}}),j&&e.jsx(r,{sx:{mt:2,p:3,bgcolor:"#f0f8ff",borderRadius:2,border:"1px solid #e0e0e0",mb:3},children:e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(ne,{sx:{mr:1,color:"primary.main"}}),"Structure:"]}),e.jsx(t,{variant:"h6",sx:{ml:3,mb:1},children:j.NOMSTRUCTURE}),j.ABBREVIATION&&e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{ml:3},children:["Abr√©viation: ",j.ABBREVIATION]})]}),e.jsxs(r,{textAlign:"right",children:[e.jsxs(t,{variant:"subtitle1",sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[e.jsx(st,{sx:{mr:1,color:"primary.main"}}),"P√©riode:"]}),e.jsx(t,{variant:"body1",sx:{ml:3,fontWeight:500},children:u()})]})]})}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[y.length," formation(s) trouv√©e(s)"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Liste des formations r√©alis√©es"})]}),e.jsxs(r,{display:"flex",gap:1,children:[j&&e.jsx(V,{label:j.ABBREVIATION||j.NOMSTRUCTURE,color:"primary",variant:"outlined",icon:e.jsx(ne,{fontSize:"small"}),sx:{fontSize:"0.9rem",fontWeight:500,py:1}}),m>0&&e.jsx(V,{label:`${m} participants`,color:"secondary",variant:"outlined",sx:{fontSize:"0.9rem",fontWeight:500,py:1}})]})]}),e.jsx(J,{sx:{my:2}}),e.jsx(ae,{sx:{border:"1px solid",borderColor:"#f0f0f0",borderRadius:2},children:e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",width:"50px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Intitul√©"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"B√©n√©ficiaires"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Date"})]})}),e.jsx(de,{children:y.length>0?y.map((x,c)=>e.jsxs(G,{hover:!0,sx:{"&:last-child td":{borderBottom:0}},children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:c+1}),e.jsx(a,{sx:{fontWeight:"bold"},children:x.INTITULE?x.INTITULE.toUpperCase():"-"}),e.jsx(a,{children:x.CIBLES||"-"}),e.jsx(a,{children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(pe,{fontSize:"small",color:"action",sx:{mr:1}}),O(x.DATE)]})})]},c)):e.jsx(G,{children:e.jsxs(a,{colSpan:4,align:"center",sx:{py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucune formation trouv√©e pour cette p√©riode et structure"})]})})})]})})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:T,onClose:M,autoHideDuration:5e3,children:e.jsx(cr,{onClose:M,severity:f,iconMapping:{success:e.jsx(ne,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:b})})})]})},xr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),ur=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(!1),[b,C]=o.useState([]),[f,R]=o.useState(!1),[j,k]=o.useState(""),[P,E]=o.useState("success");o.useEffect(()=>{let x=null,c=null;s&&(s.date_debut&&(x=F(s.date_debut)),s.date_fin&&(c=F(s.date_fin))),x||(x=F().subtract(1,"month")),c||(c=F()),$(x),N(c),n&&Array.isArray(n)?(C(n),M(`${n.length} formation(s) trouv√©e(s)`,"success")):l&&I(l)},[s,n,l]);const I=async x=>{if(!x)return;w(!0);const c=localStorage.getItem("token"),h="";try{const i=await Z.post(`${h}/personnaliserrequette`,{query:x},{headers:{Authorization:`Bearer ${c}`}});i.data&&Array.isArray(i.data)?(C(i.data),M(`${i.data.length} formation(s) trouv√©e(s)`,"success")):(C([]),M("Aucune formation trouv√©e.","info"))}catch(i){const d=i.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";M(d,"error")}finally{w(!1)}},M=(x,c)=>{k(x),E(c),R(!0)},O=()=>{R(!1)},v=x=>F(x).format("DD/MM/YYYY"),u=()=>B||"Liste des Formations Improvis√©es sur une P√©riode",m=()=>z&&y?`Du ${v(z)} au ${v(y)}`:"P√©riode inconnue";return T?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:800,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des formations improvis√©es..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:800,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(ee,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:u()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:m()})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[b.length," formation(s) trouv√©e(s)"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Formations improvis√©es (non pr√©vues)"})]}),e.jsx(V,{label:`${v(z)} ‚Üí ${v(y)}`,color:"warning",variant:"outlined",icon:e.jsx(be,{fontSize:"small"}),sx:{fontSize:"0.9rem",fontWeight:500,py:1}})]}),e.jsx(J,{sx:{my:2}}),e.jsx(ae,{sx:{border:"1px solid",borderColor:"#f0f0f0",borderRadius:2},children:e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",width:"50px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Intitul√©"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"B√©n√©ficiaires"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Date"})]})}),e.jsx(de,{children:b.length>0?b.map((x,c)=>e.jsxs(G,{hover:!0,sx:{"&:last-child td":{borderBottom:0}},children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:c+1}),e.jsx(a,{sx:{fontWeight:"bold"},children:x.INTITULE?x.INTITULE.toUpperCase():"-"}),e.jsx(a,{children:x.CIBLES||"-"}),e.jsx(a,{children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(pe,{fontSize:"small",color:"action",sx:{mr:1}}),v(x.DATE)]})})]},c)):e.jsx(G,{children:e.jsxs(a,{colSpan:4,align:"center",sx:{py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucune formation improvis√©e trouv√©e pour cette p√©riode"})]})})})]})})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:f,onClose:O,autoHideDuration:5e3,children:e.jsx(xr,{onClose:O,severity:P,iconMapping:{success:e.jsx(pe,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:j})})})]})},hr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),fr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(!1),[y,N]=o.useState([]),[T,w]=o.useState(!1),[b,C]=o.useState(""),[f,R]=o.useState("success"),j="",k=(x,c)=>{let h=x;return Object.keys(c).forEach(i=>{const d=new RegExp(`\\$\\{${i}\\}`,"g"),S=c[i];S!=null&&(h=h.replace(d,S))}),h},P=()=>{if(!s?.personnelIds)return[];let x=s.personnelIds;if(typeof x=="string")try{x.trim().startsWith("[")?x=JSON.parse(x):x=x.split(",").map(c=>c.trim())}catch{x=x.replace(/[\[\]"]/g,"").split(",").map(h=>h.trim())}return Array.isArray(x)?x:[x]},E=async x=>{if(!x)return;$(!0);const c=localStorage.getItem("token");try{const h=k(x,s);console.log("üöÄ Requ√™te SQL finale:",h);const i=await Z.post(`${j}/personnaliserrequette`,{query:h},{headers:{Authorization:`Bearer ${c}`}});i.data&&Array.isArray(i.data)?(N(i.data),I(`${i.data.length} formation(s) trouv√©e(s)`,"success")):(N([]),I("Aucune formation trouv√©e pour les personnels s√©lectionn√©s.","info"))}catch(h){const i=h.response?.data?.message||"Erreur lors de l‚Äôex√©cution de la requ√™te.";console.error("‚ùå Erreur API:",h),I(i,"error")}finally{$(!1)}},I=(x,c)=>{C(x),R(c),w(!0)},M=()=>{w(!1)},O=x=>F(x).format("DD/MM/YYYY"),v=()=>B||"Formations Individuelles par Personnel",u=x=>{const c=x.NOM?.trim()||"",h=x.PRENOM?.trim()||"",i=x.NOMMARI?.trim();let d=`${c} ${h}`.trim();return i&&(d+=` √âpse. ${i}`),d},m=y.reduce((x,c)=>{const h=`${c.IDPERSONNEL}_${c.NOM}_${c.PRENOM}`;return x[h]||(x[h]={personnel:{IDPERSONNEL:c.IDPERSONNEL,NOM:c.NOM,PRENOM:c.PRENOM,NOMMARI:c.NOMMARI,FONCTION:c.FONCTION,GRADE:c.GRADE,Structure:c.Structure||c.NOMSTRUCTURE},formations:[]}),x[h].formations.push({Formation:c.Formation||c.INTITULE,DateFormation:c.DateFormation||c.DATE}),x},{});return o.useEffect(()=>{if(P().length===0){I("Aucun personnel s√©lectionn√©.","warning");return}l?E(l):n?.sql_query&&E(n.sql_query)},[]),z?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des formations..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(ve,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:v()}),e.jsxs(t,{variant:"body1",color:"text.secondary",children:[P().length," personnel(s) s√©lectionn√©(s)"]})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[y.length," formation(s) trouv√©e(s)"]}),e.jsx(V,{label:`${P().length} personnel(s)`,color:"primary",variant:"outlined",icon:e.jsx(ve,{fontSize:"small"}),sx:{fontSize:"0.9rem",fontWeight:500,py:1}})]}),e.jsx(J,{sx:{my:2}}),Object.keys(m).length>0?Object.entries(m).map(([x,{personnel:c,formations:h}])=>e.jsxs(Ge,{defaultExpanded:!0,children:[e.jsxs(Ve,{expandIcon:e.jsx(Je,{}),children:[e.jsxs(r,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(t,{variant:"subtitle1",fontWeight:"bold",children:u(c)}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:[c.FONCTION," ‚Ä¢ ",c.Structure," ‚Ä¢ ",c.GRADE]})]}),e.jsx(V,{icon:e.jsx(ee,{}),label:`${h.length} formation(s)`,size:"small",color:"primary",sx:{ml:"auto"}})]}),e.jsx(Xe,{children:e.jsx(ae,{sx:{border:"1px solid #f0f0f0",borderRadius:1,maxHeight:300},children:e.jsxs(le,{size:"small",children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#f9f9f9"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.9rem"},children:"Formation"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.9rem"},children:"Date"})]})}),e.jsx(de,{children:h.map((i,d)=>e.jsxs(G,{children:[e.jsx(a,{children:i.Formation||"-"}),e.jsx(a,{children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(pe,{fontSize:"small",color:"action",sx:{mr:1}}),O(i.DateFormation)]})})]},d))})]})})})]},x)):e.jsxs(r,{sx:{textAlign:"center",py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucune formation trouv√©e pour les personnels s√©lectionn√©s"})]})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:T,onClose:M,autoHideDuration:5e3,children:e.jsx(hr,{onClose:M,severity:f,iconMapping:{success:e.jsx(ve,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:b})})})]})},mr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),gr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(!1),[b,C]=o.useState([]),[f,R]=o.useState(!1),[j,k]=o.useState(""),[P,E]=o.useState("success");o.useEffect(()=>{let x=null,c=null;s&&(s.date_debut&&(x=F(s.date_debut)),s.date_fin&&(c=F(s.date_fin))),x||(x=F().subtract(1,"month")),c||(c=F()),$(x),N(c),n&&Array.isArray(n)?(C(n),M(`${n.length} formation(s) non r√©alis√©e(s) trouv√©e(s)`,"success")):l&&I(l)},[s,n,l]);const I=async x=>{if(!x)return;w(!0);const c=localStorage.getItem("token"),h="";try{const i=await Z.post(`${h}/personnaliserrequette`,{query:x},{headers:{Authorization:`Bearer ${c}`}});i.data&&Array.isArray(i.data)?(C(i.data),M(`${i.data.length} formation(s) non r√©alis√©e(s) trouv√©e(s)`,"success")):(C([]),M("Aucune formation non r√©alis√©e trouv√©e.","info"))}catch(i){const d=i.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";M(d,"error")}finally{w(!1)}},M=(x,c)=>{k(x),E(c),R(!0)},O=()=>{R(!1)},v=x=>F(x).format("DD/MM/YYYY"),u=()=>B||"Formations Non R√©alis√©es sur une P√©riode",m=()=>z&&y?`Du ${v(z)} au ${v(y)}`:"P√©riode inconnue";return T?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:800,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des formations non r√©alis√©es..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:800,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(ee,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:u()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:m()})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[b.length," formation(s) non r√©alis√©e(s)"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Formations pr√©vues mais non tenues"})]}),e.jsx(V,{label:`${v(z)} ‚Üí ${v(y)}`,color:"warning",variant:"outlined",icon:e.jsx(be,{fontSize:"small"}),sx:{fontSize:"0.9rem",fontWeight:500,py:1}})]}),e.jsx(J,{sx:{my:2}}),e.jsx(ae,{sx:{border:"1px solid",borderColor:"#f0f0f0",borderRadius:2},children:e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",width:"50px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Intitul√©"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"B√©n√©ficiaires"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Date pr√©vue"})]})}),e.jsx(de,{children:b.length>0?b.map((x,c)=>e.jsxs(G,{hover:!0,sx:{"&:last-child td":{borderBottom:0}},children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:c+1}),e.jsx(a,{sx:{fontWeight:"bold"},children:x.INTITULE?x.INTITULE.toUpperCase():"-"}),e.jsx(a,{children:x.CIBLES||"-"}),e.jsx(a,{children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(pe,{fontSize:"small",color:"action",sx:{mr:1}}),v(x.DATE)||"Non Tenue"]})})]},c)):e.jsx(G,{children:e.jsxs(a,{colSpan:4,align:"center",sx:{py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucune formation non r√©alis√©e trouv√©e pour cette p√©riode"})]})})})]})})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:f,onClose:O,autoHideDuration:5e3,children:e.jsx(mr,{onClose:O,severity:P,iconMapping:{success:e.jsx(pe,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:j})})})]})},br=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),pr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(""),[b,C]=o.useState(""),[f,R]=o.useState(!1),[j,k]=o.useState([]),[P,E]=o.useState(!1),[I,M]=o.useState(""),[O,v]=o.useState("success");o.useEffect(()=>{let i=null,d=null;s&&(s.date_debut&&(i=F(s.date_debut)),s.date_fin&&(d=F(s.date_fin)),s.IDselectedStructure&&s.IDselectedStructure),i||(i=F().subtract(1,"month")),d||(d=F()),$(i),N(d)},[s]),o.useEffect(()=>{if(!l||!s?.IDselectedStructure)return;(async()=>{R(!0);const d=localStorage.getItem("token"),S="";let A=l.replace(/\$\{selectedStructure\.IDSTRUCTURE\}/g,s.IDselectedStructure).replace(/\$\{dateDebutFormatted\}/g,F(s.date_debut).format("YYYY")).replace(/\$\{dateFinFormatted\}/g,F(s.date_fin).format("YYYY"));try{const g=await Z.post(`${S}/personnaliserrequette`,{query:A},{headers:{Authorization:`Bearer ${d}`}});Array.isArray(g.data)?(k(g.data),g.data.length>0&&g.data[0].Structure&&w(g.data[0].Structure),u(`${g.data.length} formation(s) trouv√©e(s)`,"success")):(k([]),u("Aucune formation trouv√©e.","info"))}catch(g){const L=g.response?.data?.message||"Erreur lors de l‚Äôex√©cution de la requ√™te.";u(L,"error")}finally{R(!1)}})()},[l,s]),o.useEffect(()=>{n&&Array.isArray(n)&&(k(n),n.length>0&&n[0].Structure&&w(n[0].Structure),u(`${n.length} formation(s) trouv√©e(s)`,"success"))},[n]);const u=(i,d)=>{M(i),v(d),E(!0)},m=()=>{E(!1)},x=i=>F(i).format("DD/MM/YYYY"),c=()=>B||"Formations Non R√©alis√©es par Structure et P√©riode",h=()=>z&&y?`Du ${x(z)} au ${x(y)}`:"P√©riode inconnue";return f?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des formations non r√©alis√©es..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(ee,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:c()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:h()}),T&&e.jsxs(t,{variant:"body1",color:"primary",fontWeight:"medium",children:["Structure : ",T]})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[j.length," formation(s) non r√©alis√©e(s)"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Formations pr√©vues mais non tenues"})]}),e.jsx(V,{label:`${x(z)} ‚Üí ${x(y)}`,color:"warning",variant:"outlined",icon:e.jsx(be,{fontSize:"small"}),sx:{fontSize:"0.9rem",fontWeight:500,py:1}})]}),e.jsx(J,{sx:{my:2}}),e.jsx(ae,{sx:{border:"1px solid",borderColor:"#f0f0f0",borderRadius:2},children:e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",width:"50px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Intitul√©"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"B√©n√©ficiaires"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Date pr√©vue"})]})}),e.jsx(de,{children:j.length>0?j.map((i,d)=>e.jsxs(G,{hover:!0,sx:{"&:last-child td":{borderBottom:0}},children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:d+1}),e.jsx(a,{sx:{fontWeight:"bold"},children:i.INTITULE?i.INTITULE.toUpperCase():"-"}),e.jsx(a,{children:i.CIBLES||"-"}),e.jsx(a,{children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(pe,{fontSize:"small",color:"action",sx:{mr:1}}),i.DATE||"Non Tenue"]})})]},d)):e.jsx(G,{children:e.jsxs(a,{colSpan:4,align:"center",sx:{py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucune formation non r√©alis√©e trouv√©e pour cette p√©riode"})]})})})]})})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:P,onClose:m,autoHideDuration:5e3,children:e.jsx(br,{onClose:m,severity:O,iconMapping:{success:e.jsx(ne,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:I})})})]})},jr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),Sr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(1),[b,C]=o.useState(!1),[f,R]=o.useState([]),[j,k]=o.useState(!1),[P,E]=o.useState(""),[I,M]=o.useState("success");o.useEffect(()=>{let i=null,d=null,S=1;s&&(s.date_debut&&(i=F(s.date_debut)),s.date_fin&&(d=F(s.date_fin)),s.nombreFormations!==void 0&&(S=parseInt(s.nombreFormations,10))),i||(i=F().subtract(1,"year")),d||(d=F()),S<1&&(S=1),$(i),N(d),w(S),n&&Array.isArray(n)?(R(n),v(`${n.length} personnel(s) trouv√©(s)`,"success")):l&&O(l)},[s,n,l]);const O=async i=>{if(!i)return;C(!0);const d=localStorage.getItem("token"),S="";let A=i.replace(/\$\{dateDebut\}/g,F(s.date_debut).format("YYYY-MM-DD")).replace(/\$\{dateFin\}/g,F(s.date_fin).format("YYYY-MM-DD")).replace(/\$\{nombreFormations\}/g,s.nombreFormations||"1");try{const g=await Z.post(`${S}/personnaliserrequette`,{query:A},{headers:{Authorization:`Bearer ${d}`}});Array.isArray(g.data)?(R(g.data),v(`${g.data.length} personnel(s) trouv√©(s)`,"success")):(R([]),v("Aucun personnel trouv√©.","info"))}catch(g){const L=g.response?.data?.message||"Erreur lors de l‚Äôex√©cution de la requ√™te.";v(L,"error")}finally{C(!1)}},v=(i,d)=>{E(i),M(d),k(!0)},u=()=>{k(!1)},m=i=>F(i).format("DD/MM/YYYY"),x=()=>B||"Personnels par Nombre de Formations",c=()=>z&&y?`Du ${m(z)} au ${m(y)}`:"P√©riode inconnue",h=()=>f.reduce((i,d)=>i+(d.NombreFormations||0),0);return b?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des personnels form√©s..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(Ie,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:x()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:c()}),T&&e.jsxs(t,{variant:"body1",color:"primary",fontWeight:"medium",children:["Minimum ",T," formation(s) requise(s)"]})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[f.length," personnel(s) trouv√©s"]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Ayant suivi au moins ",T," formation(s)"]})]}),e.jsx(V,{label:`${h()} formations`,color:"secondary",variant:"outlined",size:"small",sx:{fontSize:"0.8rem",fontWeight:500}})]}),e.jsx(J,{sx:{my:2}}),e.jsx(ae,{sx:{maxHeight:600,border:"1px solid #f0f0f0",borderRadius:2},children:e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",width:"50px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Personnel"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Fonction"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Structure"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",textAlign:"center"},children:"Nb Formations"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"T√©l√©phone"})]})}),e.jsx(de,{children:f.length>0?f.map((i,d)=>e.jsxs(G,{hover:!0,sx:{"&:last-child td":{borderBottom:0}},children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:d+1}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsxs(t,{variant:"body1",fontWeight:"bold",children:[i.NOM," ",i.PRENOM]}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center",mt:.5},children:[e.jsx(ge,{sx:{mr:.5,fontSize:14}}),i.MATRICULE,i.SEXE&&e.jsx(V,{label:i.SEXE,size:"small",variant:"outlined",sx:{ml:1,height:20,fontSize:"0.7rem"}})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(fe,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:i.FONCTION||"-"}),i.GRADE&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Grade: ",i.GRADE]})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ne,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:i.StructureAbbreviation||i.Structure}),i.StructureAbbreviation&&i.Structure!==i.StructureAbbreviation&&e.jsx(t,{variant:"caption",color:"text.secondary",children:i.Structure})]})]})}),e.jsx(a,{sx:{textAlign:"center"},children:e.jsx(V,{label:i.NombreFormations,color:"primary",variant:"filled",size:"small",sx:{fontWeight:"bold",minWidth:40}})}),e.jsx(a,{children:i.TELEPHONE&&e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ke,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsx(t,{variant:"body2",children:i.TELEPHONE})]})})]},d)):e.jsx(G,{children:e.jsxs(a,{colSpan:6,align:"center",sx:{py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsxs(t,{variant:"body1",color:"text.secondary",children:["Aucun personnel n‚Äôa suivi au moins ",T," formation(s) sur cette p√©riode"]})]})})})]})})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:j,onClose:u,autoHideDuration:5e3,children:e.jsx(jr,{onClose:u,severity:I,iconMapping:{success:e.jsx(We,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(Ie,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:P})})})]})},yr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),vr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(1),[b,C]=o.useState(""),[f,R]=o.useState(""),[j,k]=o.useState(!1),[P,E]=o.useState([]),[I,M]=o.useState(!1),[O,v]=o.useState(""),[u,m]=o.useState("success");o.useEffect(()=>{let g=null,L=null,H=1;s&&(s.date_debut&&(g=F(s.date_debut)),s.date_fin&&(L=F(s.date_fin)),s.nombreFormations!==void 0&&(H=parseInt(s.nombreFormations,10))),g||(g=F().subtract(1,"year")),L||(L=F()),H<1&&(H=1),$(g),N(L),w(H),n&&Array.isArray(n)?(E(n),n.length>0&&n[0].Structure&&(C(n[0].Structure),R(n[0].StructureAbbreviation||"")),c(`${n.length} personnel(s) trouv√©(s)`,"success")):l&&s?.IDselectedStructure&&x(l)},[s,n,l]);const x=async g=>{if(!g||!s?.IDselectedStructure)return;k(!0);const L=localStorage.getItem("token"),H="";let p=g.replace(/\$\{IDselectedStructure\}/g,s.IDselectedStructure).replace(/\$\{dateDebutFormatted\}/g,F(s.date_debut).format("YYYY-MM-DD")).replace(/\$\{dateFinFormatted\}/g,F(s.date_fin).format("YYYY-MM-DD")).replace(/\$\{nombreFormations\}/g,s.nombreFormations||"1");try{const D=await Z.post(`${H}/personnaliserrequette`,{query:p},{headers:{Authorization:`Bearer ${L}`}});Array.isArray(D.data)?(E(D.data),D.data.length>0&&(C(D.data[0].Structure),R(D.data[0].StructureAbbreviation||"")),c(`${D.data.length} personnel(s) trouv√©(s)`,"success")):(E([]),c("Aucun personnel trouv√©.","info"))}catch(D){const U=D.response?.data?.message||"Erreur lors de l‚Äôex√©cution de la requ√™te.";c(U,"error")}finally{k(!1)}},c=(g,L)=>{v(g),m(L),M(!0)},h=()=>{M(!1)},i=g=>F(g).format("DD/MM/YYYY"),d=()=>B||"Personnels d'une Structure par Nombre de Formations",S=()=>z&&y?`Du ${i(z)} au ${i(y)}`:"P√©riode inconnue",A=()=>P.reduce((g,L)=>g+(L.NombreFormations||0),0);return j?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des personnels form√©s..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(Ie,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:d()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:S()}),b&&e.jsxs(t,{variant:"body1",color:"primary",fontWeight:"medium",children:["Structure : ",f||b]}),T&&e.jsxs(t,{variant:"body1",color:"primary",fontWeight:"medium",children:["Minimum ",T," formation(s)"]})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[P.length," personnel(s) trouv√©s"]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Ayant suivi au moins ",T," formation(s)"]})]}),e.jsx(V,{label:`${A()} formations`,color:"secondary",variant:"outlined",size:"small",sx:{fontSize:"0.8rem",fontWeight:500}})]}),e.jsx(J,{sx:{my:2}}),e.jsx(ae,{sx:{maxHeight:600,border:"1px solid #f0f0f0",borderRadius:2},children:e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",width:"50px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Personnel"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Structure"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",textAlign:"center"},children:"Nb Formations"})]})}),e.jsx(de,{children:P.length>0?P.map((g,L)=>e.jsxs(G,{hover:!0,sx:{"&:last-child td":{borderBottom:0}},children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:L+1}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsxs(t,{variant:"body1",fontWeight:"bold",children:[g.NOM," ",g.PRENOM]}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center",mt:.5},children:[e.jsx(ge,{sx:{mr:.5,fontSize:14}}),g.MATRICULE,g.SEXE&&e.jsx(V,{label:g.SEXE,size:"small",variant:"outlined",sx:{ml:1,height:20,fontSize:"0.7rem"}})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ne,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:g.StructureAbbreviation||g.Structure}),g.StructureAbbreviation&&g.Structure!==g.StructureAbbreviation&&e.jsx(t,{variant:"caption",color:"text.secondary",children:g.Structure})]})]})}),e.jsx(a,{sx:{textAlign:"center"},children:e.jsx(V,{label:g.NombreFormations,color:"primary",variant:"filled",size:"small",sx:{fontWeight:"bold",minWidth:40}})})]},L)):e.jsx(G,{children:e.jsxs(a,{colSpan:6,align:"center",sx:{py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsxs(t,{variant:"body1",color:"text.secondary",children:["Aucun personnel n‚Äôa suivi au moins ",T," formation(s) dans cette structure sur cette p√©riode"]})]})})})]})})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:I,onClose:h,autoHideDuration:5e3,children:e.jsx(yr,{onClose:h,severity:u,iconMapping:{success:e.jsx(We,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(Ie,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:O})})})]})},Ar=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),Fr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(1),[b,C]=o.useState(!1),[f,R]=o.useState([]),[j,k]=o.useState(!1),[P,E]=o.useState(""),[I,M]=o.useState("success");o.useEffect(()=>{let i=null,d=null,S=1;s&&(s.date_debut&&(i=F(s.date_debut)),s.date_fin&&(d=F(s.date_fin)),s.nombreFormations!==void 0&&(S=parseInt(s.nombreFormations,10))),i||(i=F().subtract(1,"year")),d||(d=F()),S<1&&(S=1),$(i),N(d),w(S),n&&Array.isArray(n)?(R(n),v(`${n.length} personnel(s) trouv√©(s)`,"success")):l&&O(l)},[s,n,l]);const O=async i=>{if(!i)return;C(!0);const d=localStorage.getItem("token"),S="";let A=i.replace(/\$\{dateDebutFormatted\}/g,F(s.date_debut).format("YYYY-MM-DD")).replace(/\$\{dateFinFormatted\}/g,F(s.date_fin).format("YYYY-MM-DD")).replace(/\$\{nombreFormations\}/g,s.nombreFormations||"1");try{const g=await Z.post(`${S}/personnaliserrequette`,{query:A},{headers:{Authorization:`Bearer ${d}`}});Array.isArray(g.data)?(R(g.data),v(`${g.data.length} personnel(s) trouv√©(s)`,"success")):(R([]),v("Aucun personnel trouv√©.","info"))}catch(g){const L=g.response?.data?.message||"Erreur lors de l‚Äôex√©cution de la requ√™te.";v(L,"error")}finally{C(!1)}},v=(i,d)=>{E(i),M(d),k(!0)},u=()=>{k(!1)},m=i=>F(i).format("DD/MM/YYYY"),x=()=>B||"Personnels F√©minins par Nombre de Formations",c=()=>z&&y?`Du ${m(z)} au ${m(y)}`:"P√©riode inconnue",h=()=>f.reduce((i,d)=>i+(d.NombreFormations||0),0);return b?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des personnels f√©minins form√©s..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(Be,{color:"secondary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"secondary",children:x()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:c()}),T&&e.jsxs(t,{variant:"body1",color:"secondary",fontWeight:"medium",children:["Minimum ",T," formation(s)"]})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[f.length," personnel(s) trouv√©s"]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Ayant suivi au moins ",T," formation(s)"]})]}),e.jsx(V,{label:`${h()} formations`,color:"secondary",variant:"outlined",size:"small",sx:{fontSize:"0.8rem",fontWeight:500}})]}),e.jsx(J,{sx:{my:2}}),e.jsx(ae,{sx:{maxHeight:600,border:"1px solid #f0f0f0",borderRadius:2},children:e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",width:"50px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Personnel"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Fonction"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Structure"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",textAlign:"center"},children:"Nb Formations"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"T√©l√©phone"})]})}),e.jsx(de,{children:f.length>0?f.map((i,d)=>e.jsxs(G,{hover:!0,sx:{"&:last-child td":{borderBottom:0}},children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:d+1}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsxs(t,{variant:"body1",fontWeight:"bold",children:[i.NOM," ",i.PRENOM]}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center",mt:.5},children:[e.jsx(ge,{sx:{mr:.5,fontSize:14}}),i.MATRICULE,e.jsx(V,{label:i.SEXE,size:"small",sx:{ml:1,height:20,fontSize:"0.7rem",bgcolor:"pink",color:"white"}})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(fe,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:i.FONCTION||"-"}),i.GRADE&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Grade: ",i.GRADE]})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ne,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:i.StructureAbbreviation||i.Structure}),i.StructureAbbreviation&&i.Structure!==i.StructureAbbreviation&&e.jsx(t,{variant:"caption",color:"text.secondary",children:i.Structure})]})]})}),e.jsx(a,{sx:{textAlign:"center"},children:e.jsx(V,{label:i.NombreFormations,color:"secondary",variant:"filled",size:"small",sx:{fontWeight:"bold",minWidth:40}})}),e.jsx(a,{children:i.TELEPHONE&&e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ke,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsx(t,{variant:"body2",children:i.TELEPHONE})]})})]},d)):e.jsx(G,{children:e.jsxs(a,{colSpan:6,align:"center",sx:{py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsxs(t,{variant:"body1",color:"text.secondary",children:["Aucun personnel f√©minin n‚Äôa suivi au moins ",T," formation(s) sur cette p√©riode"]})]})})})]})})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:j,onClose:u,autoHideDuration:5e3,children:e.jsx(Ar,{onClose:u,severity:I,iconMapping:{success:e.jsx(Be,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(Ie,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:P})})})]})},Ir=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),zr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(1),[b,C]=o.useState(!1),[f,R]=o.useState([]),[j,k]=o.useState(!1),[P,E]=o.useState(""),[I,M]=o.useState("success");o.useEffect(()=>{let i=null,d=null,S=1;s&&(s.date_debut&&(i=F(s.date_debut)),s.date_fin&&(d=F(s.date_fin)),s.nombreFormations!==void 0&&(S=parseInt(s.nombreFormations,10))),i||(i=F().subtract(1,"year")),d||(d=F()),S<1&&(S=1),$(i),N(d),w(S),n&&Array.isArray(n)?(R(n),v(`${n.length} personnel(s) trouv√©(s)`,"success")):l&&O(l)},[s,n,l]);const O=async i=>{if(!i)return;C(!0);const d=localStorage.getItem("token"),S="";let A=i.replace(/\$\{dateDebutFormatted\}/g,F(s.date_debut).format("YYYY-MM-DD")).replace(/\$\{dateFinFormatted\}/g,F(s.date_fin).format("YYYY-MM-DD")).replace(/\$\{nombreFormations\}/g,s.nombreFormations||"1");try{const g=await Z.post(`${S}/personnaliserrequette`,{query:A},{headers:{Authorization:`Bearer ${d}`}});Array.isArray(g.data)?(R(g.data),v(`${g.data.length} personnel(s) trouv√©(s)`,"success")):(R([]),v("Aucun personnel trouv√©.","info"))}catch(g){const L=g.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";v(L,"error")}finally{C(!1)}},v=(i,d)=>{E(i),M(d),k(!0)},u=()=>{k(!1)},m=i=>F(i).format("DD/MM/YYYY"),x=()=>B||"Personnels Masculins par Nombre de Formations",c=()=>z&&y?`Du ${m(z)} au ${m(y)}`:"P√©riode inconnue",h=()=>f.reduce((i,d)=>i+(d.NombreFormations||0),0);return b?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des personnels masculins form√©s..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(Ue,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:x()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:c()}),T&&e.jsxs(t,{variant:"body1",color:"primary",fontWeight:"medium",children:["Minimum ",T," formation(s)"]})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[f.length," personnel(s) trouv√©s"]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Ayant suivi au moins ",T," formation(s)"]})]}),e.jsx(V,{label:`${h()} formations`,color:"primary",variant:"outlined",size:"small",sx:{fontSize:"0.8rem",fontWeight:500}})]}),e.jsx(J,{sx:{my:2}}),e.jsx(ae,{sx:{maxHeight:600,border:"1px solid #f0f0f0",borderRadius:2},children:e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",width:"50px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Personnel"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Fonction"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Structure"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",textAlign:"center"},children:"Nb Formations"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"T√©l√©phone"})]})}),e.jsx(de,{children:f.length>0?f.map((i,d)=>e.jsxs(G,{hover:!0,sx:{"&:last-child td":{borderBottom:0}},children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:d+1}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsxs(t,{variant:"body1",fontWeight:"bold",children:[i.PRENOM," ",i.NOM]}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center",mt:.5},children:[e.jsx(ge,{sx:{mr:.5,fontSize:14}}),i.MATRICULE,e.jsx(V,{label:"Masculin",size:"small",sx:{ml:1,height:20,fontSize:"0.7rem",bgcolor:"#90caf9",color:"white"}})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(fe,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:i.FONCTION||"-"}),i.GRADE&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Grade: ",i.GRADE]})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ne,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:i.StructureAbbreviation||i.Structure}),i.StructureAbbreviation&&i.Structure!==i.StructureAbbreviation&&e.jsx(t,{variant:"caption",color:"text.secondary",children:i.Structure})]})]})}),e.jsx(a,{sx:{textAlign:"center"},children:e.jsx(V,{label:i.NombreFormations,color:"primary",variant:"filled",size:"small",sx:{fontWeight:"bold",minWidth:40}})}),e.jsx(a,{children:i.TELEPHONE&&e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ke,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsx(t,{variant:"body2",children:i.TELEPHONE})]})})]},d)):e.jsx(G,{children:e.jsxs(a,{colSpan:6,align:"center",sx:{py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsxs(t,{variant:"body1",color:"text.secondary",children:["Aucun personnel masculin n'a suivi au moins ",T," formation(s) sur cette p√©riode"]})]})})})]})})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:j,onClose:u,autoHideDuration:5e3,children:e.jsx(Ir,{onClose:u,severity:I,iconMapping:{success:e.jsx(Ue,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(Ie,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:P})})})]})},kr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),Wr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(1),[b,C]=o.useState(!1),[f,R]=o.useState([]),[j,k]=o.useState(!1),[P,E]=o.useState(""),[I,M]=o.useState("success");o.useEffect(()=>{let i=null,d=null,S=1;s&&(s.date_debut&&(i=F(s.date_debut)),s.date_fin&&(d=F(s.date_fin)),s.nombreFormations!==void 0&&(S=parseInt(s.nombreFormations,10))),i||(i=F().subtract(1,"year")),d||(d=F()),S<1&&(S=1),$(i),N(d),w(S),n&&Array.isArray(n)?(R(n),v(`${n.length} personnel(s) trouv√©(s)`,"success")):l&&O(l)},[s,n,l]);const O=async i=>{if(!i)return;C(!0);const d=localStorage.getItem("token"),S="";let A=i.replace(/\$\{dateDebut\}/g,F(s.date_debut).format("YYYY-MM-DD")).replace(/\$\{dateFin\}/g,F(s.date_fin).format("YYYY-MM-DD")).replace(/\$\{nombreFormations\}/g,s.nombreFormations||"1");try{const g=await Z.post(`${S}/personnaliserrequette`,{query:A},{headers:{Authorization:`Bearer ${d}`}});Array.isArray(g.data)?(R(g.data),v(`${g.data.length} personnel(s) trouv√©(s)`,"success")):(R([]),v("Aucun personnel trouv√©.","info"))}catch(g){const L=g.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";v(L,"error")}finally{C(!1)}},v=(i,d)=>{E(i),M(d),k(!0)},u=()=>{k(!1)},m=i=>F(i).format("DD/MM/YYYY"),x=()=>B||"Personnels des Services Centraux par Nombre de Formations",c=()=>z&&y?`Du ${m(z)} au ${m(y)}`:"P√©riode inconnue",h=()=>f.reduce((i,d)=>i+(d.NombreFormations||0),0);return b?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des personnels des services centraux..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx($e,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:x()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:c()}),T&&e.jsxs(t,{variant:"body1",color:"primary",fontWeight:"medium",children:["Minimum ",T," formation(s)"]})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[f.length," personnel(s) trouv√©s"]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Ayant suivi au moins ",T," formation(s)"]})]}),e.jsxs(r,{display:"flex",gap:1,children:[e.jsx(V,{label:"Services Centraux",color:"primary",variant:"outlined",icon:e.jsx($e,{fontSize:"small"}),sx:{fontSize:"0.8rem",fontWeight:500}}),e.jsx(V,{label:`${h()} formations`,color:"primary",variant:"outlined",size:"small",sx:{fontSize:"0.8rem",fontWeight:500}})]})]}),e.jsx(J,{sx:{my:2}}),e.jsx(ae,{sx:{maxHeight:600,border:"1px solid #f0f0f0",borderRadius:2},children:e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",width:"50px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Personnel"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Fonction"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Structure"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",textAlign:"center"},children:"Nb Formations"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"T√©l√©phone"})]})}),e.jsx(de,{children:f.length>0?f.map((i,d)=>e.jsxs(G,{hover:!0,sx:{"&:last-child td":{borderBottom:0}},children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:d+1}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsxs(t,{variant:"body1",fontWeight:"bold",children:[i.PRENOM," ",i.NOM]}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center",mt:.5},children:[e.jsx(ge,{sx:{mr:.5,fontSize:14}}),i.MATRICULE,i.SEXE&&e.jsx(V,{label:i.SEXE,size:"small",variant:"outlined",sx:{ml:1,height:20,fontSize:"0.7rem",bgcolor:i.SEXE==="F√©minin"?"pink":"#90caf9",color:"white"}})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(fe,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:i.FONCTION||"-"}),i.GRADE&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Grade: ",i.GRADE]})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ne,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:i.Structure||"-"}),i.StructureAbbreviation&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["(",i.StructureAbbreviation,")"]})]})]})}),e.jsx(a,{sx:{textAlign:"center"},children:e.jsx(V,{label:i.NombreFormations,color:"primary",variant:"filled",size:"small",sx:{fontWeight:"bold",minWidth:40}})}),e.jsx(a,{children:i.TELEPHONE&&e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ke,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsx(t,{variant:"body2",children:i.TELEPHONE})]})})]},d)):e.jsx(G,{children:e.jsxs(a,{colSpan:6,align:"center",sx:{py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsxs(t,{variant:"body1",color:"text.secondary",children:["Aucun personnel des services centraux n'a suivi au moins ",T," formation(s) sur cette p√©riode"]})]})})})]})})]}),f.length>0&&e.jsxs(r,{sx:{mt:3,p:2,bgcolor:"#f9f9f9",borderRadius:2},children:[e.jsxs(t,{variant:"subtitle2",fontWeight:"medium",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(jt,{sx:{mr:1,fontSize:18}}),"Statistiques des formations"]}),e.jsxs(r,{display:"flex",justifyContent:"space-between",children:[e.jsx(r,{children:e.jsxs(t,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Total personnels:"})," ",f.length]})}),e.jsx(r,{children:e.jsxs(t,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Total formations suivies:"})," ",h()]})}),e.jsx(r,{children:e.jsxs(t,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Moyenne par personnel:"})," ",(h()/f.length).toFixed(1)]})})]})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:j,onClose:u,autoHideDuration:5e3,children:e.jsx(kr,{onClose:u,severity:I,iconMapping:{success:e.jsx($e,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(Ie,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:P})})})]})},Rr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),Er=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(!1),[y,N]=o.useState([]),[T,w]=o.useState(null),[b,C]=o.useState(!1),[f,R]=o.useState(""),[j,k]=o.useState("success");o.useEffect(()=>{n&&Array.isArray(n)?(N(n),n.length>0&&w({INTITULE:n[0].Formation,DATE:n[0].DateFormation}),E(`${n.length} personnel(s) trouv√©(s)`,"success")):l&&s?.IDselectedFormation&&P(l)},[s,n,l]);const P=async x=>{if(!x||!s?.IDselectedFormation)return;$(!0);const c=localStorage.getItem("token"),h="";let i=x.replace(/\$\{selectedFormation\.IDFORMATIONM\}/g,s.IDselectedFormation);try{const d=await Z.post(`${h}/personnaliserrequette`,{query:i},{headers:{Authorization:`Bearer ${c}`}});Array.isArray(d.data)?(N(d.data),d.data.length>0&&w({INTITULE:d.data[0].Formation,DATE:d.data[0].DateFormation}),E(`${d.data.length} personnel(s) trouv√©(s)`,"success")):(N([]),E("Aucun personnel trouv√©.","info"))}catch(d){const S=d.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";E(S,"error")}finally{$(!1)}},E=(x,c)=>{R(x),k(c),C(!0)},I=()=>{C(!1)},M=x=>x?new Date(x).toLocaleDateString("fr-FR"):"-",O=()=>B||"Personnels par Formation Sp√©cifique",v=()=>T?T.INTITULE:"Formation non d√©finie",m=(x=>{const c={};return x.forEach(h=>{const i=h.Structure||"Structure non d√©finie";c[i]||(c[i]=[]),c[i].push(h)}),c})(y);return z?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des personnels form√©s..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,maxHeight:"70vh",overflow:"auto",mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(je,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:O()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:v()}),T?.DATE&&e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center",mt:.5},children:[e.jsx(be,{sx:{mr:.5,fontSize:16}}),"Date de formation: ",M(T.DATE)]})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[y.length," personnel(s) trouv√©(s) dans ",Object.keys(m).length," structure(s)"]}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center",mt:.5},children:[e.jsx(he,{sx:{mr:.5,fontSize:16}}),"Formation: ",v()]})]}),e.jsx(r,{sx:{textAlign:"right"},children:e.jsx(V,{label:v(),color:"primary",variant:"outlined",icon:e.jsx(he,{fontSize:"small"}),sx:{fontSize:"0.9rem",fontWeight:500,py:1,mb:1,maxWidth:200}})})]}),e.jsx(J,{sx:{my:2}}),Object.keys(m).length>0?Object.entries(m).map(([x,c])=>e.jsxs(r,{sx:{mb:3},children:[e.jsxs(t,{variant:"h6",sx:{display:"flex",alignItems:"center",mb:2,color:"primary.main",fontWeight:"bold"},children:[e.jsx(ne,{sx:{mr:1}}),x," (",c.length," ",c.length>1?"personnels":"personnel",")"]}),e.jsx(ae,{sx:{maxHeight:400,border:"1px solid #f0f0f0",borderRadius:2,mb:2},children:e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",width:"40px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Personnel"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Fonction"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Contact"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Date Formation"})]})}),e.jsx(de,{children:c.map((h,i)=>e.jsxs(G,{hover:!0,sx:{"&:last-child td":{borderBottom:0}},children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:i+1}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsxs(t,{variant:"body1",fontWeight:"bold",children:[h.PRENOM," ",h.NOM]}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center"},children:[e.jsx(ge,{sx:{mr:.5,fontSize:14}}),h.MATRICULE,h.SEXE&&e.jsx(V,{label:h.SEXE,size:"small",variant:"outlined",sx:{ml:1,height:20,fontSize:"0.7rem",bgcolor:h.SEXE==="F√©minin"?"pink":"lightblue",color:"white"}})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(fe,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:h.FONCTION||"-"}),h.GRADE&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Grade: ",h.GRADE]})]})]})}),e.jsx(a,{children:e.jsx(t,{variant:"body2",children:h.TELEPHONE||"-"})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(be,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsx(t,{children:h.DateFormation?M(h.DateFormation):"-"})]})})]},i))})]})})]},x)):e.jsxs(r,{sx:{textAlign:"center",py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucun personnel trouv√© pour cette formation"})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:b,onClose:I,autoHideDuration:5e3,children:e.jsx(Rr,{onClose:I,severity:j,iconMapping:{success:e.jsx(je,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(Ie,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:f})})})]})},Cr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),Tr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(1),[b,C]=o.useState(!1),[f,R]=o.useState([]),[j,k]=o.useState(!1),[P,E]=o.useState(""),[I,M]=o.useState("success");o.useEffect(()=>{let i=null,d=null,S=1;s&&(s.date_debut&&(i=F(s.date_debut)),s.date_fin&&(d=F(s.date_fin)),s.nombreFormations!==void 0&&(S=parseInt(s.nombreFormations,10))),i||(i=F().subtract(1,"year")),d||(d=F()),S<1&&(S=1),$(i),N(d),w(S),n&&Array.isArray(n)?(R(n),v(`${n.length} personnel(s) trouv√©(s)`,"success")):l&&O(l)},[s,n,l]);const O=async i=>{if(!i)return;C(!0);const d=localStorage.getItem("token"),S="";let A=i.replace(/\$\{dateDebut\}/g,F(s.date_debut).format("YYYY-MM-DD")).replace(/\$\{dateFin\}/g,F(s.date_fin).format("YYYY-MM-DD")).replace(/\$\{nombreFormations\}/g,s.nombreFormations||"1");try{const g=await Z.post(`${S}/personnaliserrequette`,{query:A},{headers:{Authorization:`Bearer ${d}`}});Array.isArray(g.data)?(R(g.data),v(`${g.data.length} personnel(s) trouv√©(s)`,"success")):(R([]),v("Aucun personnel trouv√©.","info"))}catch(g){const L=g.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";v(L,"error")}finally{C(!1)}},v=(i,d)=>{E(i),M(d),k(!0)},u=()=>{k(!1)},m=i=>F(i).format("DD/MM/YYYY"),x=()=>B||"Personnels D√©concentr√©s par Nombre de Formations",c=()=>z&&y?`Du ${m(z)} au ${m(y)}`:"P√©riode inconnue",h=()=>f.reduce((i,d)=>i+(d.NombreFormations||0),0);return b?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des personnels d√©concentr√©s..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(Oe,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:x()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:c()}),T&&e.jsxs(t,{variant:"body1",color:"primary",fontWeight:"medium",children:["Minimum ",T," formation(s)"]})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[f.length," personnel(s) trouv√©s"]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Ayant suivi au moins ",T," formation(s)"]})]}),e.jsxs(r,{display:"flex",gap:1,children:[e.jsx(V,{label:"Services D√©concentr√©s",color:"primary",variant:"outlined",icon:e.jsx(Oe,{fontSize:"small"}),sx:{fontSize:"0.8rem",fontWeight:500}}),e.jsx(V,{label:`${h()} formations`,color:"primary",variant:"outlined",size:"small",sx:{fontSize:"0.8rem",fontWeight:500}})]})]}),e.jsx(J,{sx:{my:2}}),e.jsx(ae,{sx:{maxHeight:600,border:"1px solid #f0f0f0",borderRadius:2},children:e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",width:"50px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Personnel"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Fonction"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Structure"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",textAlign:"center"},children:"Nb Formations"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"T√©l√©phone"})]})}),e.jsx(de,{children:f.length>0?f.map((i,d)=>e.jsxs(G,{hover:!0,sx:{"&:last-child td":{borderBottom:0}},children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:d+1}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsxs(t,{variant:"body1",fontWeight:"bold",children:[i.PRENOM," ",i.NOM]}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center",mt:.5},children:[e.jsx(ge,{sx:{mr:.5,fontSize:14}}),i.MATRICULE,i.SEXE&&e.jsx(V,{label:i.SEXE,size:"small",variant:"outlined",sx:{ml:1,height:20,fontSize:"0.7rem",bgcolor:i.SEXE==="F√©minin"?"pink":"#90caf9",color:"white"}})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(fe,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:i.FONCTION||"-"}),i.GRADE&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Grade: ",i.GRADE]})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ne,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:i.Structure||"-"}),i.StructureAbbreviation&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["(",i.StructureAbbreviation,")"]})]})]})}),e.jsx(a,{sx:{textAlign:"center"},children:e.jsx(V,{label:i.NombreFormations,color:"primary",variant:"filled",size:"small",sx:{fontWeight:"bold",minWidth:40}})}),e.jsx(a,{children:i.TELEPHONE&&e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ke,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsx(t,{variant:"body2",children:i.TELEPHONE})]})})]},d)):e.jsx(G,{children:e.jsxs(a,{colSpan:6,align:"center",sx:{py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsxs(t,{variant:"body1",color:"text.secondary",children:["Aucun personnel d√©concentr√© n'a suivi au moins ",T," formation(s) sur cette p√©riode"]})]})})})]})})]}),f.length>0&&e.jsxs(r,{sx:{mt:3,p:2,bgcolor:"#f9f9f9",borderRadius:2},children:[e.jsxs(t,{variant:"subtitle2",fontWeight:"medium",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(jt,{sx:{mr:1,fontSize:18}}),"Statistiques des formations"]}),e.jsxs(r,{display:"flex",justifyContent:"space-between",children:[e.jsx(r,{children:e.jsxs(t,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Total personnels:"})," ",f.length]})}),e.jsx(r,{children:e.jsxs(t,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Total formations suivies:"})," ",h()]})}),e.jsx(r,{children:e.jsxs(t,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Moyenne par personnel:"})," ",(h()/f.length).toFixed(1)]})})]})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:j,onClose:u,autoHideDuration:5e3,children:e.jsx(Cr,{onClose:u,severity:I,iconMapping:{success:e.jsx(Oe,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(Ie,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:P})})})]})},Dr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),Nr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(!1),[y,N]=o.useState([]),[T,w]=o.useState(!1),[b,C]=o.useState(""),[f,R]=o.useState("success"),[j,k]=o.useState(""),[P,E]=o.useState(""),I="";o.useEffect(()=>{n&&Array.isArray(n)?(N(n),O(n),v(`${n.length} personnel(s) trouv√©(s)`,"success")):l&&s&&s.IDselectedStructure&&s.IDselectedFormation&&M(l)},[n,l,s]);const M=async c=>{if(!c)return;$(!0);const h=localStorage.getItem("token");let i=c.replace(/\${selectedStructure.IDSTRUCTURE}/g,s.IDselectedStructure).replace(/\${IDselectedFormation.IDFORMATIONM}/g,s.IDselectedFormation);try{const d=await Z.post(`${I}/personnaliserrequette`,{query:i},{headers:{Authorization:`Bearer ${h}`}});Array.isArray(d.data)?(N(d.data),O(d.data),v(`${d.data.length} personnel(s) trouv√©(s)`,"success")):(N([]),v("Aucun personnel trouv√©.","info"))}catch(d){const S=d.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";v(S,"error")}finally{$(!1)}},O=c=>{c.length>0&&(k(c[0].Structure||""),E(c[0].Formation||""))},v=(c,h)=>{C(c),R(h),w(!0)},u=()=>{w(!1)},m=c=>F(c).format("DD/MM/YYYY"),x=()=>B||"Personnels par Structure et Formation";return z?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des personnels..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(ne,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:x()}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Liste des personnels d'une structure ayant b√©n√©fici√© d'une formation sp√©cifique"})]})]}),e.jsx(J,{sx:{my:3}}),(j||P)&&e.jsx(r,{sx:{mb:3,p:2,bgcolor:"#f0f8ff",borderRadius:2,border:"1px solid #e0e0e0"},children:e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(r,{children:[j&&e.jsxs(t,{variant:"body1",fontWeight:"medium",sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(ne,{sx:{mr:1,fontSize:20,color:"primary.main"}}),"Structure: ",j]}),P&&e.jsxs(t,{variant:"body1",fontWeight:"medium",sx:{display:"flex",alignItems:"center"},children:[e.jsx(he,{sx:{mr:1,fontSize:20,color:"secondary.main"}}),"Formation: ",P]})]}),e.jsx(V,{label:`${y.length} personnels`,color:"primary",variant:"outlined",size:"medium",sx:{fontSize:"0.9rem",fontWeight:500}})]})}),e.jsx(r,{sx:{mt:2},children:e.jsx(ae,{sx:{border:"1px solid #f0f0f0",borderRadius:2},children:e.jsxs(le,{children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",width:"50px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Personnel"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Fonction"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Structure"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Date Formation"})]})}),e.jsx(de,{children:y.length>0?y.map((c,h)=>e.jsxs(G,{hover:!0,sx:{"&:last-child td":{borderBottom:0}},children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:h+1}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsxs(t,{variant:"body1",fontWeight:"bold",children:[c.PRENOM," ",c.NOM]}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center",mt:.5},children:[e.jsx(ge,{sx:{mr:.5,fontSize:14}}),c.MATRICULE,c.SEXE&&e.jsx(V,{label:c.SEXE,size:"small",variant:"outlined",sx:{ml:1,height:20,fontSize:"0.7rem",bgcolor:c.SEXE==="F√©minin"?"pink":"#90caf9",color:"white"}})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(fe,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:c.FONCTION||"-"}),c.GRADE&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Grade: ",c.GRADE]})]})]})}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsx(t,{variant:"body2",children:c.Structure||"-"}),c.StructureAbbreviation&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["(",c.StructureAbbreviation,")"]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(be,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsx(t,{children:c.DateFormation?m(c.DateFormation):"-"})]})})]},h)):e.jsx(G,{children:e.jsxs(a,{colSpan:5,align:"center",sx:{py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucun personnel trouv√© pour cette combinaison structure/formation"})]})})})]})})}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:T,onClose:u,autoHideDuration:5e3,children:e.jsx(Dr,{onClose:u,severity:f,iconMapping:{success:e.jsx(ne,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(Ie,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:b})})})]})},Mr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),wr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(!1),[y,N]=o.useState([]),[T,w]=o.useState(!1),[b,C]=o.useState(""),[f,R]=o.useState("success"),[j,k]=o.useState(""),E=(u=>{const m={};return u.forEach(x=>{const c=x.Structure||"Structure non d√©finie";m[c]||(m[c]=[]),m[c].push(x)}),m})(y);o.useEffect(()=>{(async()=>{if(n&&Array.isArray(n)){N(n),n.length>0&&k(n[0]?.Formation||""),I(`${n.length} personnels trouv√©s`,"success");return}if(l&&s?.IDselectedFormation){$(!0);const m=localStorage.getItem("token"),x="";try{const c=l.replace(/\${selectedFormation\.IDFORMATIONM}/g,s.IDselectedFormation),h=await Z.post(`${x}/personnaliserrequette`,{query:c},{headers:{Authorization:`Bearer ${m}`}});Array.isArray(h.data)?(N(h.data),h.data.length>0&&k(h.data[0]?.Formation||""),I(`${h.data.length} personnels trouv√©s dans le Service Central`,"success")):(N([]),I("Aucun personnel trouv√© pour cette formation","info"))}catch(c){const h=c.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";I(h,"error")}finally{$(!1)}}})()},[n,l,s]);const I=(u,m)=>{C(u),R(m),w(!0)},M=()=>{w(!1)},O=u=>u?F(u).format("DD/MM/YYYY"):"-",v=()=>B||"Personnels du Service Central par Formation";return z?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Recherche des personnels du Service Central..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(je,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:v()}),j&&e.jsxs(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:["Formation: ",j]})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{sx:{mt:2,maxHeight:"60vh",overflow:"auto"},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[y.length," personnel(s) trouv√©(s) dans ",Object.keys(E).length," structures"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Service Central uniquement"})]}),j&&e.jsx(V,{label:j,color:"primary",icon:e.jsx(he,{}),variant:"outlined",sx:{fontWeight:500}})]}),e.jsx(J,{sx:{my:2}}),y.length>0?Object.entries(E).map(([u,m])=>e.jsxs(r,{sx:{mb:4},children:[e.jsxs(t,{variant:"h6",sx:{display:"flex",alignItems:"center",mb:2,color:"primary.main",fontWeight:"bold"},children:[e.jsx(ne,{sx:{mr:1}}),u," (",m.length," ",m.length>1?"personnels":"personnel",")"]}),e.jsx(ae,{sx:{border:"1px solid",borderColor:"#f0f0f0",borderRadius:2,mb:2},children:e.jsxs(le,{children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",width:"40px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Personnel"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Fonction"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Contact"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Date Formation"})]})}),e.jsx(de,{children:m.map((x,c)=>e.jsxs(G,{hover:!0,children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:c+1}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsxs(t,{variant:"body1",fontWeight:"bold",children:[x.PRENOM," ",x.NOM]}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center"},children:[e.jsx(ge,{sx:{mr:.5,fontSize:14}}),x.MATRICULE]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(fe,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:x.FONCTION||"-"}),x.GRADE&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Grade: ",x.GRADE]})]})]})}),e.jsx(a,{children:x.TELEPHONE&&e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ke,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsx(t,{variant:"body2",children:x.TELEPHONE})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(be,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsx(t,{children:O(x.DateFormation)})]})})]},c))})]})})]},u)):e.jsxs(r,{sx:{textAlign:"center",py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucun personnel du Service Central trouv√© pour cette formation"})]})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:T,onClose:M,autoHideDuration:5e3,children:e.jsx(Mr,{onClose:M,severity:f,iconMapping:{success:e.jsx(We,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:b})})})]})},$r=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),Or=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(!1),[y,N]=o.useState([]),[T,w]=o.useState(!1),[b,C]=o.useState(""),[f,R]=o.useState("success"),[j,k]=o.useState(""),E=(u=>{const m={};return u.forEach(x=>{const c=x.Structure||"Structure non d√©finie";m[c]||(m[c]=[]),m[c].push(x)}),m})(y);o.useEffect(()=>{(async()=>{if(n&&Array.isArray(n)){N(n),n.length>0&&k(n[0]?.Formation||""),I(`${n.length} personnels trouv√©s`,"success");return}if(l&&s?.IDselectedFormation){$(!0);const m=localStorage.getItem("token"),x="";try{const c=l.replace(/\${selectedFormation\.IDFORMATIONM}/g,s.IDselectedFormation),h=await Z.post(`${x}/personnaliserrequette`,{query:c},{headers:{Authorization:`Bearer ${m}`}});Array.isArray(h.data)?(N(h.data),h.data.length>0&&k(h.data[0]?.Formation||""),I(`${h.data.length} personnels trouv√©s dans le Service D√©concentr√©`,"success")):(N([]),I("Aucun personnel trouv√© pour cette formation","info"))}catch(c){const h=c.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";I(h,"error")}finally{$(!1)}}})()},[n,l,s]);const I=(u,m)=>{C(u),R(m),w(!0)},M=()=>{w(!1)},O=u=>u?F(u).format("DD/MM/YYYY"):"-",v=()=>B||"Personnels du Service D√©concentr√© par Formation";return z?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Recherche des personnels du Service D√©concentr√©..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(je,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:v()}),j&&e.jsxs(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:["Formation: ",j]})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[y.length," personnel(s) trouv√©(s) dans ",Object.keys(E).length," structures"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Service D√©concentr√© uniquement"})]}),j&&e.jsx(V,{label:j,color:"primary",icon:e.jsx(he,{}),variant:"outlined",sx:{fontWeight:500}})]}),e.jsx(J,{sx:{my:2}}),y.length>0?Object.entries(E).map(([u,m])=>e.jsxs(r,{sx:{mb:4},children:[e.jsxs(t,{variant:"h6",sx:{display:"flex",alignItems:"center",mb:2,color:"primary.main",fontWeight:"bold"},children:[e.jsx(ne,{sx:{mr:1}}),u," (",m.length," ",m.length>1?"personnels":"personnel",")"]}),e.jsx(ae,{sx:{border:"1px solid",borderColor:"#f0f0f0",borderRadius:2,mb:2},children:e.jsxs(le,{children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",width:"40px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Personnel"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Fonction"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Contact"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Date Formation"})]})}),e.jsx(de,{children:m.map((x,c)=>e.jsxs(G,{hover:!0,children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:c+1}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsxs(t,{variant:"body1",fontWeight:"bold",children:[x.PRENOM," ",x.NOM]}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center"},children:[e.jsx(ge,{sx:{mr:.5,fontSize:14}}),x.MATRICULE]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(fe,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:x.FONCTION||"-"}),x.GRADE&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Grade: ",x.GRADE]})]})]})}),e.jsx(a,{children:x.TELEPHONE&&e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ke,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsx(t,{variant:"body2",children:x.TELEPHONE})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(be,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsx(t,{children:O(x.DateFormation)})]})})]},c))})]})})]},u)):e.jsxs(r,{sx:{textAlign:"center",py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucun personnel du Service D√©concentr√© trouv√© pour cette formation"})]})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:T,onClose:M,autoHideDuration:5e3,children:e.jsx($r,{onClose:M,severity:f,iconMapping:{success:e.jsx(We,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:b})})})]})},Pr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),Lr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(!1),[y,N]=o.useState([]),[T,w]=o.useState(!1),[b,C]=o.useState(""),[f,R]=o.useState("success"),[j,k]=o.useState(""),[P,E]=o.useState("");o.useEffect(()=>{(async()=>{if(n&&Array.isArray(n)){N(n),n.length>0&&(k(n[0]?.Structure||""),E(n[0]?.Formation||"")),I(`${n.length} personnels f√©minins trouv√©s`,"success");return}if(l&&s?.IDselectedStructure&&s?.IDselectedFormation){$(!0);const m=localStorage.getItem("token"),x="";try{const c=l.replace(/\${IDselectedStructure}/g,s.IDselectedStructure).replace(/\${IDselectedFormation\.IDFORMATIONM}/g,s.IDselectedFormation),h=await Z.post(`${x}/personnaliserrequette`,{query:c},{headers:{Authorization:`Bearer ${m}`}});Array.isArray(h.data)?(N(h.data),h.data.length>0&&(k(h.data[0]?.Structure||""),E(h.data[0]?.Formation||"")),I(`${h.data.length} personnels f√©minins trouv√©s`,"success")):(N([]),I("Aucun personnel f√©minin trouv√© pour cette combinaison","info"))}catch(c){const h=c.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";I(h,"error")}finally{$(!1)}}})()},[n,l,s]);const I=(u,m)=>{C(u),R(m),w(!0)},M=()=>{w(!1)},O=u=>u?F(u).format("DD/MM/YYYY"):"-",v=()=>B||"Personnel F√©minin par Structure et Formation";return z?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Recherche des personnels f√©minins..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(Be,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:v()}),j&&e.jsxs(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:["Structure: ",j]}),P&&e.jsxs(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:["Formation: ",P]})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[y.length," personnel(s) f√©minin(s) trouv√©(s)"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Pour la structure et formation s√©lectionn√©es"})]}),e.jsxs(r,{display:"flex",flexDirection:"column",alignItems:"flex-end",children:[j&&e.jsx(V,{label:j,color:"secondary",icon:e.jsx(ne,{}),variant:"outlined",sx:{mb:1,fontWeight:500}}),P&&e.jsx(V,{label:P,color:"primary",icon:e.jsx(he,{}),variant:"outlined",sx:{fontWeight:500}})]})]}),e.jsx(J,{sx:{my:2}}),e.jsx(ae,{sx:{border:"1px solid",borderColor:"#f0f0f0",borderRadius:2},children:e.jsxs(le,{children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",width:"40px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Personnel"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Fonction"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Structure"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Date Formation"})]})}),e.jsx(de,{children:y.length>0?y.map((u,m)=>e.jsxs(G,{hover:!0,children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:m+1}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsxs(t,{variant:"body1",fontWeight:"bold",children:[u.PRENOM," ",u.NOM]}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center"},children:[e.jsx(ge,{sx:{mr:.5,fontSize:14}}),u.MATRICULE,e.jsx(V,{label:"F√©minin",size:"small",color:"secondary",variant:"outlined",sx:{ml:1,height:20,fontSize:"0.7rem"}})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(fe,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:u.FONCTION||"-"}),u.GRADE&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Grade: ",u.GRADE]})]})]})}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsx(t,{variant:"body2",children:u.Structure||"-"}),u.StructureAbbreviation&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["(",u.StructureAbbreviation,")"]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(be,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsx(t,{children:O(u.DateFormation)})]})})]},m)):e.jsx(G,{children:e.jsxs(a,{colSpan:5,align:"center",sx:{py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucun personnel f√©minin trouv√© pour cette combinaison"})]})})})]})})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:T,onClose:M,autoHideDuration:5e3,children:e.jsx(Pr,{onClose:M,severity:f,iconMapping:{success:e.jsx(We,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:b})})})]})},Yr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),Hr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(!1),[y,N]=o.useState([]),[T,w]=o.useState(!1),[b,C]=o.useState(""),[f,R]=o.useState("success"),[j,k]=o.useState(""),[P,E]=o.useState("");o.useEffect(()=>{(async()=>{if(n&&Array.isArray(n)){N(n),n.length>0&&(k(n[0]?.Structure||""),E(n[0]?.Formation||"")),I(`${n.length} personnels masculins trouv√©s`,"success");return}if(l&&s?.IDselectedStructure&&s?.IDselectedFormation){$(!0);const m=localStorage.getItem("token"),x="";try{const c=l.replace(/\${IDselectedStructure}/g,s.IDselectedStructure).replace(/\${IDselectedFormation\.IDFORMATIONM}/g,s.IDselectedFormation),h=await Z.post(`${x}/personnaliserrequette`,{query:c},{headers:{Authorization:`Bearer ${m}`}});Array.isArray(h.data)?(N(h.data),h.data.length>0&&(k(h.data[0]?.Structure||""),E(h.data[0]?.Formation||"")),I(`${h.data.length} personnels masculins trouv√©s`,"success")):(N([]),I("Aucun personnel masculin trouv√© pour cette combinaison","info"))}catch(c){const h=c.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";I(h,"error")}finally{$(!1)}}})()},[n,l,s]);const I=(u,m)=>{C(u),R(m),w(!0)},M=()=>{w(!1)},O=u=>u?F(u).format("DD/MM/YYYY"):"-",v=()=>B||"Personnel Masculin par Structure et Formation";return z?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Recherche des personnels masculins..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(Ue,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:v()}),j&&e.jsxs(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:["Structure: ",j]}),P&&e.jsxs(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:["Formation: ",P]})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[y.length," personnel(s) masculin(s) trouv√©(s)"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Pour la structure et formation s√©lectionn√©es"})]}),e.jsxs(r,{display:"flex",flexDirection:"column",alignItems:"flex-end",children:[j&&e.jsx(V,{label:j,color:"secondary",icon:e.jsx(ne,{}),variant:"outlined",sx:{mb:1,fontWeight:500}}),P&&e.jsx(V,{label:P,color:"primary",icon:e.jsx(he,{}),variant:"outlined",sx:{fontWeight:500}})]})]}),e.jsx(J,{sx:{my:2}}),e.jsx(ae,{sx:{border:"1px solid",borderColor:"#f0f0f0",borderRadius:2},children:e.jsxs(le,{children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",width:"40px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Personnel"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Fonction"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Structure"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Date Formation"})]})}),e.jsx(de,{children:y.length>0?y.map((u,m)=>e.jsxs(G,{hover:!0,children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:m+1}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsxs(t,{variant:"body1",fontWeight:"bold",children:[u.PRENOM," ",u.NOM]}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center"},children:[e.jsx(ge,{sx:{mr:.5,fontSize:14}}),u.MATRICULE,e.jsx(V,{label:"Masculin",size:"small",color:"primary",variant:"outlined",sx:{ml:1,height:20,fontSize:"0.7rem"}})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(fe,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:u.FONCTION||"-"}),u.GRADE&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Grade: ",u.GRADE]})]})]})}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsx(t,{variant:"body2",children:u.Structure||"-"}),u.StructureAbbreviation&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["(",u.StructureAbbreviation,")"]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(be,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsx(t,{children:O(u.DateFormation)})]})})]},m)):e.jsx(G,{children:e.jsxs(a,{colSpan:5,align:"center",sx:{py:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucun personnel masculin trouv√© pour cette combinaison"})]})})})]})})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:T,onClose:M,autoHideDuration:5e3,children:e.jsx(Yr,{onClose:M,severity:f,iconMapping:{success:e.jsx(We,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:b})})})]})},Br=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),Ur=({queryData:n=null,sqlQuery:l=null,params:s={},text:B="Personnels Sans Formation"})=>{const[z,$]=o.useState(!1),[y,N]=o.useState([]),[T,w]=o.useState(!1),[b,C]=o.useState(""),[f,R]=o.useState("success");o.useEffect(()=>{n&&Array.isArray(n)?(N(n),k(`${n.length} personnel(s) trouv√©(s)`,"success")):l&&j(l)},[n,l]);const j=async u=>{if(!u)return;$(!0);const m=localStorage.getItem("token"),x="";let c=u;s&&(s.date_debut&&(c=c.replace(/\${dateDebutFormatted}/g,F(s.date_debut).format("YYYY-MM-DD"))),s.date_fin&&(c=c.replace(/\${dateFinFormatted}/g,F(s.date_fin).format("YYYY-MM-DD"))));try{const h=await Z.post(`${x}/personnaliserrequette`,{query:c},{headers:{Authorization:`Bearer ${m}`}});Array.isArray(h.data)?(N(h.data),k(`${h.data.length} personnel(s) trouv√©(s)`,"success")):(N([]),k("Aucun personnel trouv√©.","info"))}catch(h){const i=h.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";k(i,"error")}finally{$(!1)}},k=(u,m)=>{C(u),R(m),w(!0)},P=()=>{w(!1)},E=()=>B,I=()=>s?.date_debut&&s?.date_fin?`du ${F(s.date_debut).format("DD/MM/YYYY")} au ${F(s.date_fin).format("DD/MM/YYYY")}`:"P√©riode non d√©finie",M=()=>y.filter(u=>u.TotalFormations===0).length,O=()=>y.filter(u=>u.TotalFormations>0).length,v=()=>[...new Set(y.map(m=>m.StructureAbbreviation||m.Structure))].length;return z?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1200,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des personnels sans formation..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1200,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(ye,{color:"warning",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:E()}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Liste des personnels n'ayant pas b√©n√©fici√© de formation sur la p√©riode"}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{mt:1},children:["P√©riode: ",I()]})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(W,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(r,{sx:{bgcolor:"#fff3e0",p:2,borderRadius:2,display:"flex",alignItems:"center"},children:[e.jsx(ne,{sx:{mr:2,color:"warning.main"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h6",fontWeight:"bold",children:v()}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Structures concern√©es"})]})]})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(r,{sx:{bgcolor:"#ffebee",p:2,borderRadius:2,display:"flex",alignItems:"center"},children:[e.jsx(ye,{sx:{mr:2,color:"error.main"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h6",fontWeight:"bold",children:M()}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Jamais form√©s"})]})]})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(r,{sx:{bgcolor:"#e8f5e9",p:2,borderRadius:2,display:"flex",alignItems:"center"},children:[e.jsx(Ae,{sx:{mr:2,color:"success.main"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h6",fontWeight:"bold",children:O()}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Form√©s hors p√©riode"})]})]})})]}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[y.length," personnels sans formation sur la p√©riode"]}),e.jsx(V,{label:`P√©riode: ${I()}`,color:"warning",variant:"outlined",size:"small",sx:{fontSize:"0.8rem",fontWeight:500}})]}),e.jsx(J,{sx:{my:2}}),e.jsx(ae,{sx:{maxHeight:600,border:"1px solid #f0f0f0",borderRadius:2},children:e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",width:"50px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Personnel"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Structure"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Fonction"}),e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center"},children:"Total Formations"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Contact"}),e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center"},children:"Statut"})]})}),e.jsx(de,{children:y.length>0?y.map((u,m)=>e.jsxs(G,{hover:!0,sx:{"&:last-child td":{borderBottom:0}},children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:m+1}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsxs(t,{variant:"body1",fontWeight:"bold",children:[u.NOM," ",u.PRENOM]}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center"},children:[u.MATRICULE,u.SEXE&&e.jsx(V,{label:u.SEXE,size:"small",variant:"outlined",sx:{ml:1,height:20,fontSize:"0.7rem"}})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ne,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsx(r,{children:e.jsx(t,{variant:"body2",fontWeight:"500",children:u.StructureAbbreviation||u.Structure})})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(fe,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:u.FONCTION||"-"}),u.GRADE&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Grade: ",u.GRADE]})]})]})}),e.jsx(a,{sx:{textAlign:"center"},children:e.jsx(V,{label:u.TotalFormations||0,color:u.TotalFormations>0?"info":"default",variant:u.TotalFormations>0?"filled":"outlined",size:"small",sx:{fontWeight:"bold",minWidth:40}})}),e.jsx(a,{children:u.TELEPHONE&&e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ke,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsx(t,{variant:"body2",children:u.TELEPHONE})]})}),e.jsx(a,{sx:{textAlign:"center"},children:e.jsx(V,{label:u.TotalFormations===0?"Jamais form√©":"Inactif sur p√©riode",color:u.TotalFormations===0?"error":"warning",variant:"outlined",size:"small",sx:{fontSize:"0.75rem"}})})]},m)):e.jsx(G,{children:e.jsxs(a,{colSpan:7,align:"center",sx:{py:4},children:[e.jsx(he,{color:"success",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Excellent ! Tous les personnels ont b√©n√©fici√© d'au moins une formation sur la p√©riode"})]})})})]})})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:T,onClose:P,autoHideDuration:5e3,children:e.jsx(Br,{onClose:P,severity:f,iconMapping:{success:e.jsx(We,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),warning:e.jsx(Ae,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:b})})})]})},_r=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),Gr=({sqlQuery:n,params:l,text:s=null})=>{const[B,z]=o.useState(!0),[$,y]=o.useState([]),[N,T]=o.useState(!1),[w,b]=o.useState(""),[C,f]=o.useState("info");o.useEffect(()=>{n&&l?R():(z(!1),j("Configuration incompl√®te pour ex√©cuter la requ√™te","error"))},[n,l]);const R=async()=>{z(!0);const u=localStorage.getItem("token"),m="",x=F(l.date_debut).format("YYYY-MM-DD"),c=F(l.date_fin).format("YYYY-MM-DD"),h=n.replace(/\$\{selectedStructure\.IDSTRUCTURE\}/g,l.IDselectedStructure).replace(/\$\{dateDebutFormatted\}/g,x).replace(/\$\{dateFinFormatted\}/g,c);try{const i=await Z.post(`${m}/personnaliserrequette`,{query:h},{headers:{Authorization:`Bearer ${u}`}});Array.isArray(i.data)?(y(i.data),j(`${i.data.length} personnel(s) trouv√©(s)`,"info")):(y([]),j("Aucun personnel trouv√©","info"))}catch(i){const d=i.response?.data?.message||"Erreur lors de l‚Äôex√©cution de la requ√™te.";j(d,"error")}finally{z(!1)}},j=(u,m)=>{b(u),f(m),T(!0)},k=()=>{T(!1)},P=u=>F(u).format("DD/MM/YYYY"),E=()=>s||"Personnels Sans Formation sur P√©riode",I=()=>l?.date_debut&&l?.date_fin?`Du ${P(l.date_debut)} au ${P(l.date_fin)}`:"P√©riode inconnue",M=()=>l?.structureName?l.structureName:$[0]?.Structure?$[0].Structure:`Structure #${l.IDselectedStructure||"?"}`,O=()=>$.filter(u=>u.TotalFormations>0).length,v=()=>$.filter(u=>u.TotalFormations===0).length;return B?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"info",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Recherche des personnels sans formation..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(ye,{color:"warning",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"warning",children:E()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:I()}),e.jsxs(t,{variant:"body1",fontWeight:"medium",sx:{display:"flex",alignItems:"center",mt:.5},children:[e.jsx(ne,{sx:{mr:1,fontSize:20}}),M()]})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(r,{children:e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",sx:{display:"flex",alignItems:"center"},children:[e.jsx(Ae,{sx:{mr:1,color:"warning.main"}}),$.length," personnel(s) sans formation sur la p√©riode"]})}),e.jsx(V,{label:`${$.length} sans formation`,color:"warning",variant:"outlined",icon:e.jsx(ye,{fontSize:"small"}),sx:{fontSize:"0.8rem",fontWeight:500}})]}),e.jsx(J,{sx:{my:2}}),e.jsx(ae,{sx:{maxHeight:600,border:"1px solid #f0f0f0",borderRadius:2},children:e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(G,{sx:{bgcolor:"#fafafa"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",width:"50px",textAlign:"center"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Personnel"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem"},children:"Fonction"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",textAlign:"center"},children:"Total Formations"}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",textAlign:"center"},children:"Statut"})]})}),e.jsx(de,{children:$.length>0?$.map((u,m)=>e.jsxs(G,{hover:!0,sx:{"&:last-child td":{borderBottom:0}},children:[e.jsx(a,{sx:{fontWeight:"bold",textAlign:"center",color:"text.secondary"},children:m+1}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsxs(t,{variant:"body1",fontWeight:"bold",children:[u.PRENOM," ",u.NOM]}),e.jsxs(t,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center",mt:.5},children:[e.jsx(ge,{sx:{mr:.5,fontSize:14}}),u.MATRICULE,u.SEXE&&e.jsx(V,{label:u.SEXE,size:"small",sx:{ml:1,height:20,fontSize:"0.7rem",bgcolor:u.SEXE==="F√©minin"?"pink":"lightblue",color:"white"}})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(fe,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:u.FONCTION||"-"}),u.GRADE&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Grade: ",u.GRADE]})]})]})}),e.jsx(a,{sx:{textAlign:"center"},children:e.jsx(V,{label:u.TotalFormations||0,color:u.TotalFormations>0?"info":"default",variant:u.TotalFormations>0?"filled":"outlined",size:"small",sx:{fontWeight:"bold",minWidth:40}})}),e.jsx(a,{sx:{textAlign:"center"},children:e.jsx(V,{label:u.TotalFormations===0?"Jamais form√©":"Inactif sur p√©riode",color:u.TotalFormations===0?"error":"warning",variant:"outlined",size:"small",sx:{fontSize:"0.75rem"}})})]},m)):e.jsx(G,{children:e.jsxs(a,{colSpan:5,align:"center",sx:{py:4},children:[e.jsx(Ae,{color:"success",sx:{fontSize:40,mb:1,color:"green"}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Tous les personnels ont √©t√© form√©s sur cette p√©riode"})]})})})]})})]}),$.length>0&&e.jsx(r,{sx:{mt:3,p:2,bgcolor:"#fff3e0",borderRadius:2,border:"1px solid #ffcc80"},children:e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,md:3,children:e.jsxs(t,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Sans formation sur p√©riode:"})," ",$.length]})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsxs(t,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Jamais form√©s:"})," ",v()]})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsxs(t,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Form√©s ailleurs:"})," ",O()]})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsxs(t,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"P√©riode analys√©e:"})," ",I()]})})]})}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:N,onClose:k,autoHideDuration:5e3,children:e.jsx(_r,{onClose:k,severity:C,iconMapping:{info:e.jsx(ye,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),warning:e.jsx(Ae,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:w})})})]})},Vr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),Xr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState([]),[b,C]=o.useState(!1),[f,R]=o.useState([]),[j,k]=o.useState(!1),[P,E]=o.useState(""),[I,M]=o.useState("success");o.useEffect(()=>{let S=null,A=null,g=[];if(s&&(s.date_debut&&(S=F(s.date_debut)),s.date_fin&&(A=F(s.date_fin)),s.personnels)){const L=s.personnels;Array.isArray(L)?g=L.map(H=>String(H)):typeof L=="string"&&(g=L.split(",").map(H=>H.trim()).filter(Boolean))}S||(S=F().subtract(1,"year")),A||(A=F()),$(S),N(A),w(g),n&&Array.isArray(n)?(R(n),v(`${n.length} formations trouv√©es`,"success")):l&&O(l)},[s,n,l]);const O=async S=>{if(!S)return;C(!0);const A=localStorage.getItem("token"),g="";let L=S.replace(/\$\{dateDebutFormatted\}/g,z.format("YYYY-MM-DD")).replace(/\$\{dateFinFormatted\}/g,y.format("YYYY-MM-DD")).replace(/\$\{personnelIds\}/g,T.length>0?`'${T.join("','")}'`:"''");try{const H=await Z.post(`${g}/personnaliserrequette`,{query:L},{headers:{Authorization:`Bearer ${A}`}});Array.isArray(H.data)?(R(H.data),v(`${H.data.length} formation(s) trouv√©e(s)`,"success")):(R([]),v("Aucune formation trouv√©e.","info"))}catch(H){const p=H.response?.data?.message||"Erreur lors de l‚Äôex√©cution de la requ√™te.";v(p,"error")}finally{C(!1)}},v=(S,A)=>{E(S),M(A),k(!0)},u=()=>{k(!1)},m=S=>F(S).format("DD/MM/YYYY"),x=()=>B||"Formations Individuelles des Personnels",c=()=>z&&y?`Du ${m(z)} au ${m(y)}`:"P√©riode inconnue",h=f.reduce((S,A)=>{const g=`${A.IDPERSONNEL}_${A.NOM}_${A.PRENOM}`;return S[g]||(S[g]={personnel:{IDPERSONNEL:A.IDPERSONNEL,NOM:A.NOM,PRENOM:A.PRENOM,NOMMARI:A.NOMMARI,FONCTION:A.FONCTION,GRADE:A.GRADE,Structure:A.Structure||A.NOMSTRUCTURE,MATRICULE:A.MATRICULE},formations:[]}),S[g].formations.push({Formation:A.Formation||A.INTITULE,DateFormation:A.DateFormation||A.DATE,LIEU:A.LIEU,CIBLES:A.CIBLES}),S},{}),i=f.length,d=Object.keys(h).length;return b?e.jsx(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:e.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(ve,{color:"primary",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des formations individuelles..."})]})}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:900,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(ve,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:x()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:c()}),T.length>0&&e.jsx(V,{label:`${T.length} personnel(s) s√©lectionn√©(s)`,icon:e.jsx(qe,{fontSize:"small"}),color:"primary",size:"small",sx:{mt:.5}})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(r,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{children:[e.jsxs(t,{variant:"subtitle1",fontWeight:"medium",children:[d," personnel(s) ‚Ä¢ ",i," formation(s)"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Formations suivies sur la p√©riode"})]}),e.jsx(V,{label:`${i} formations`,color:"secondary",variant:"outlined",size:"small",sx:{fontSize:"0.8rem",fontWeight:500}})]}),e.jsx(J,{sx:{my:2}}),Object.keys(h).length>0?Object.entries(h).map(([S,A])=>e.jsxs(Ge,{sx:{mb:1,borderRadius:2,"&:before":{display:"none"}},children:[e.jsx(Ve,{expandIcon:e.jsx(Je,{}),children:e.jsxs(r,{sx:{display:"flex",alignItems:"center",flexGrow:1},children:[e.jsx(We,{sx:{mr:2,color:"action.active"}}),e.jsxs(r,{sx:{flexGrow:1},children:[e.jsxs(t,{variant:"body1",fontWeight:"bold",children:[A.personnel.PRENOM," ",A.personnel.NOM,A.personnel.NOMMARI&&` √âpse. ${A.personnel.NOMMARI}`]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:[A.personnel.MATRICULE," ‚Ä¢ ",A.personnel.FONCTION," ‚Ä¢ ",A.personnel.Structure]})]}),e.jsx(V,{label:`${A.formations.length} formation(s)`,color:"primary",size:"small",variant:"outlined"})]})}),e.jsx(Xe,{children:e.jsx(ae,{children:e.jsxs(le,{size:"small",children:[e.jsx(ce,{children:e.jsxs(G,{children:[e.jsx(a,{sx:{fontWeight:"bold"},children:"Formation"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Date"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Lieu"}),e.jsx(a,{sx:{fontWeight:"bold"},children:"Cibles"})]})}),e.jsx(de,{children:A.formations.map((g,L)=>e.jsxs(G,{children:[e.jsx(a,{children:g.Formation||"-"}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(be,{fontSize:"small",color:"action",sx:{mr:1}}),m(g.DateFormation)]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(et,{fontSize:"small",color:"action",sx:{mr:1}}),g.LIEU||"-"]})}),e.jsx(a,{children:g.CIBLES||"-"})]},L))})]})})})]},S)):e.jsxs(r,{sx:{textAlign:"center",py:6},children:[e.jsx(_,{color:"action",sx:{fontSize:50,mb:1,color:"text.secondary"}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucune formation trouv√©e pour les personnels s√©lectionn√©s sur cette p√©riode."})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:j,onClose:u,autoHideDuration:5e3,children:e.jsx(Vr,{onClose:u,severity:I,iconMapping:{success:e.jsx(ve,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(he,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:P})})})]})},Jr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),Kr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(!1),[b,C]=o.useState(0),[f,R]=o.useState(0),[j,k]=o.useState(!1),[P,E]=o.useState(""),[I,M]=o.useState("success");o.useEffect(()=>{let A=null,g=null;if(s&&(s.dateDebut&&(A=F(s.dateDebut)),s.dateFin&&(g=F(s.dateFin))),A||(A=F().subtract(1,"year")),g||(g=F()),$(A),N(g),n&&Array.isArray(n)&&n.length>0){const L=n[0];C(parseInt(L.HommesFormes,10)||0),R(parseInt(L.TotalPersonnelsFormes,10)||0),v(`${L.HommesFormes||0} homme(s) form√©(s)`,"success")}else l&&O(l)},[s,n,l]);const O=async A=>{if(!A)return;w(!0);const g=localStorage.getItem("token"),L="";try{const H=await Z.post(`${L}/personnaliserrequette`,{query:A},{headers:{Authorization:`Bearer ${g}`}});if(Array.isArray(H.data)&&H.data.length>0){const p=H.data[0];C(parseInt(p.HommesFormes,10)||0),R(parseInt(p.TotalPersonnelsFormes,10)||0),v(`${p.HommesFormes||0} homme(s) form√©(s)`,"success")}else C(0),R(0),v("Aucun r√©sultat trouv√©.","info")}catch(H){const p=H.response?.data?.message||"Erreur lors de l‚Äôex√©cution de la requ√™te.";v(p,"error")}finally{w(!1)}},v=(A,g)=>{E(A),M(g),k(!0)},u=()=>{k(!1)},m=A=>F(A).format("DD/MM/YYYY"),x=()=>B||"Nombre d'Hommes Form√©s sur une P√©riode",c=()=>z&&y?`Du ${m(z)} au ${m(y)}`:"P√©riode inconnue",h=()=>f===0?0:(b/f*100).toFixed(1);if(T)return e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des statistiques masculines..."})]});const i={chart:{type:"radialBar",height:350},colors:["#2196f3"],plotOptions:{radialBar:{startAngle:-135,endAngle:135,track:{background:"#e7e7e7",strokeWidth:"97%",margin:5},dataLabels:{name:{fontSize:"16px",color:"#888",offsetY:120},value:{offsetY:76,fontSize:"22px",color:"#111",formatter:()=>`${b} / ${f}`}}}},fill:{type:"gradient",gradient:{shade:"dark",shadeIntensity:.15,inverseColors:!1,stops:[0,50,65,91]}},stroke:{dashArray:4},labels:["Hommes Form√©s"],title:{text:`${h()}% des form√©s`,align:"center",style:{fontSize:"18px",fontWeight:"bold",color:"#2196f3"}}},d={chart:{type:"bar",height:300,toolbar:{show:!1}},colors:["#2196f3","#e0e0e0"],plotOptions:{bar:{horizontal:!1,columnWidth:"55%",borderRadius:4}},dataLabels:{enabled:!0,style:{fontSize:"14px",fontWeight:"bold"}},xaxis:{categories:["Form√©s"],title:{text:"Comparaison"}},yaxis:{title:{text:"Nombre de personnes"}},legend:{position:"top"},title:{text:"Hommes form√©s vs Autres",align:"center"}},S=[{name:"Hommes Form√©s",data:[b]},{name:"Femmes Form√©es",data:[f-b]}];return e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(Fe,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:x()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:c()})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,md:4,children:e.jsx(Q,{sx:{bgcolor:"#e3f2fd",borderLeft:"4px solid #2196f3",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(he,{sx:{fontSize:48,color:"#2196f3",mb:1}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#2196f3",children:b}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Hommes Form√©s"})]})})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsx(Q,{sx:{bgcolor:"#e8f5e8",borderLeft:"4px solid #4caf50",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(je,{sx:{fontSize:48,color:"#4caf50",mb:1}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#4caf50",children:f}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Total Form√©s"})]})})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsx(Q,{sx:{bgcolor:"#fff3e0",borderLeft:"4px solid #ff9800",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(Re,{sx:{fontSize:48,color:"#ff9800",mb:1}}),e.jsxs(t,{variant:"h3",fontWeight:"bold",color:"#ff9800",children:[h(),"%"]}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Taux de Formation Masculin"})]})})})]}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,md:7,children:e.jsxs(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:[e.jsx(t,{variant:"h6",sx:{mb:2,textAlign:"center"},children:"Proportion d'Hommes Form√©s"}),f>0?e.jsx(xe,{options:i,series:[parseFloat(h())],type:"radialBar",height:350}):e.jsxs(r,{sx:{textAlign:"center",mt:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Aucun personnel form√© sur cette p√©riode"})]})]})}),e.jsx(W,{item:!0,xs:12,md:5,children:e.jsxs(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:[e.jsx(t,{variant:"h6",sx:{mb:2,textAlign:"center"},children:"Comparaison Visuelle"}),f>0?e.jsx(xe,{options:d,series:S,type:"bar",height:300}):e.jsxs(r,{sx:{textAlign:"center",mt:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Donn√©es insuffisantes"})]})]})})]}),e.jsxs(r,{sx:{p:3,bgcolor:"#f9f9f9",borderRadius:2},children:[e.jsxs(t,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(ee,{sx:{mr:1,color:"primary.main"}}),"R√©sum√© de l'analyse"]}),e.jsxs(t,{variant:"body1",sx:{lineHeight:1.6},children:["Sur la p√©riode du ",e.jsx("strong",{children:m(z)})," au ",e.jsx("strong",{children:m(y)}),",",e.jsxs("strong",{children:[" ",b," homme(s)"]})," ont √©t√© form√©s, sur un total de ",e.jsx("strong",{children:f})," form√©s, soit ",e.jsxs("strong",{children:[h(),"%"]}),".",b===0&&f>0&&e.jsx("span",{style:{color:"#f44336"},children:" Aucun homme n‚Äôa √©t√© form√© durant cette p√©riode."}),f===0&&e.jsx("span",{style:{color:"#f44336"},children:" Aucune formation n‚Äôa √©t√© dispens√©e."}),h()<50&&b>0&&e.jsx("span",{style:{color:"#ff9800"},children:" Moins de la moiti√© des form√©s sont des hommes."}),h()>=50&&e.jsx("span",{style:{color:"#4caf50"},children:" Les hommes sont majoritaires parmi les form√©s."})]})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:j,onClose:u,autoHideDuration:5e3,children:e.jsx(Jr,{onClose:u,severity:I,iconMapping:{success:e.jsx(Fe,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:P})})})]})},Zr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),Qr=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(!1),[b,C]=o.useState(0),[f,R]=o.useState(0),[j,k]=o.useState(!1),[P,E]=o.useState(""),[I,M]=o.useState("success");o.useEffect(()=>{let A=null,g=null;if(s&&(s.dateDebut&&(A=F(s.dateDebut)),s.dateFin&&(g=F(s.dateFin))),A||(A=F().subtract(1,"year")),g||(g=F()),$(A),N(g),n&&Array.isArray(n)&&n.length>0){const L=n[0];C(parseInt(L.FemmesFormees,10)||0),R(parseInt(L.TotalPersonnelsFormes,10)||0),v(`${L.FemmesFormees||0} femme(s) form√©e(s)`,"success")}else l&&O(l)},[s,n,l]);const O=async A=>{if(!A)return;w(!0);const g=localStorage.getItem("token"),L="";try{const H=await Z.post(`${L}/personnaliserrequette`,{query:A},{headers:{Authorization:`Bearer ${g}`}});if(Array.isArray(H.data)&&H.data.length>0){const p=H.data[0];C(parseInt(p.FemmesFormees,10)||0),R(parseInt(p.TotalPersonnelsFormes,10)||0),v(`${p.FemmesFormees||0} femme(s) form√©e(s)`,"success")}else C(0),R(0),v("Aucun r√©sultat trouv√©.","info")}catch(H){const p=H.response?.data?.message||"Erreur lors de l‚Äôex√©cution de la requ√™te.";v(p,"error")}finally{w(!1)}},v=(A,g)=>{E(A),M(g),k(!0)},u=()=>{k(!1)},m=A=>F(A).format("DD/MM/YYYY"),x=()=>B||"Nombre de Femmes Form√©es sur une P√©riode",c=()=>z&&y?`Du ${m(z)} au ${m(y)}`:"P√©riode inconnue",h=()=>f===0?0:(b/f*100).toFixed(1);if(T)return e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"secondary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des statistiques f√©minines..."})]});const i={chart:{type:"radialBar",height:350},colors:["#e91e63"],plotOptions:{radialBar:{startAngle:-135,endAngle:135,track:{background:"#e7e7e7",strokeWidth:"97%",margin:5},dataLabels:{name:{fontSize:"16px",color:"#888",offsetY:120},value:{offsetY:76,fontSize:"22px",color:"#111",formatter:()=>`${b} / ${f}`}}}},fill:{type:"gradient",gradient:{shade:"dark",shadeIntensity:.15,inverseColors:!1,stops:[0,50,65,91]}},stroke:{dashArray:4},labels:["Femmes Form√©es"],title:{text:`${h()}% des form√©s`,align:"center",style:{fontSize:"18px",fontWeight:"bold",color:"#e91e63"}}},d={chart:{type:"bar",height:300,toolbar:{show:!1}},colors:["#e91e63","#e0e0e0"],plotOptions:{bar:{horizontal:!1,columnWidth:"55%",borderRadius:4}},dataLabels:{enabled:!0,style:{fontSize:"14px",fontWeight:"bold"}},xaxis:{categories:["Form√©es"],title:{text:"Comparaison"}},yaxis:{title:{text:"Nombre de personnes"}},legend:{position:"top"},title:{text:"Femmes form√©es vs Autres",align:"center"}},S=[{name:"Femmes Form√©es",data:[b]},{name:"Hommes Form√©s",data:[f-b]}];return e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(Ce,{sx:{fontSize:36,mr:2,color:"#e91e63"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",sx:{color:"#e91e63"},children:x()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:c()})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,md:4,children:e.jsx(Q,{sx:{bgcolor:"#fce4ec",borderLeft:"4px solid #e91e63",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(he,{sx:{fontSize:48,color:"#e91e63",mb:1}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#e91e63",children:b}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Femmes Form√©es"})]})})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsx(Q,{sx:{bgcolor:"#e8f5e8",borderLeft:"4px solid #4caf50",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(je,{sx:{fontSize:48,color:"#4caf50",mb:1}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#4caf50",children:f}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Total Form√©s"})]})})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsx(Q,{sx:{bgcolor:"#fff3e0",borderLeft:"4px solid #ff9800",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(Re,{sx:{fontSize:48,color:"#ff9800",mb:1}}),e.jsxs(t,{variant:"h3",fontWeight:"bold",color:"#ff9800",children:[h(),"%"]}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Taux de Formation F√©minin"})]})})})]}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,md:7,children:e.jsxs(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:[e.jsx(t,{variant:"h6",sx:{mb:2,textAlign:"center"},children:"Proportion de Femmes Form√©es"}),f>0?e.jsx(xe,{options:i,series:[parseFloat(h())],type:"radialBar",height:350}):e.jsxs(r,{sx:{textAlign:"center",mt:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Aucun personnel form√© sur cette p√©riode"})]})]})}),e.jsx(W,{item:!0,xs:12,md:5,children:e.jsxs(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:[e.jsx(t,{variant:"h6",sx:{mb:2,textAlign:"center"},children:"Comparaison Visuelle"}),f>0?e.jsx(xe,{options:d,series:S,type:"bar",height:300}):e.jsxs(r,{sx:{textAlign:"center",mt:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Donn√©es insuffisantes"})]})]})})]}),e.jsxs(r,{sx:{p:3,bgcolor:"#f9f9f9",borderRadius:2},children:[e.jsxs(t,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(ee,{sx:{mr:1,color:"#e91e63"}}),"R√©sum√© de l'analyse"]}),e.jsxs(t,{variant:"body1",sx:{lineHeight:1.6},children:["Sur la p√©riode du ",e.jsx("strong",{children:m(z)})," au ",e.jsx("strong",{children:m(y)}),",",e.jsxs("strong",{children:[" ",b," femme(s)"]})," ont √©t√© form√©es, sur un total de ",e.jsx("strong",{children:f})," form√©s, soit ",e.jsxs("strong",{children:[h(),"%"]}),".",b===0&&f>0&&e.jsx("span",{style:{color:"#f44336"},children:" Aucune femme n‚Äôa √©t√© form√©e durant cette p√©riode."}),f===0&&e.jsx("span",{style:{color:"#f44336"},children:" Aucune formation n‚Äôa √©t√© dispens√©e."}),h()<50&&b>0&&e.jsx("span",{style:{color:"#ff9800"},children:" Moins de la moiti√© des form√©es sont des femmes."}),h()>=50&&e.jsx("span",{style:{color:"#4caf50"},children:" Les femmes sont majoritaires parmi les form√©es."})]})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:j,onClose:u,autoHideDuration:5e3,children:e.jsx(Zr,{onClose:u,severity:I,iconMapping:{success:e.jsx(Ce,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:P})})})]})},qr=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),es=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(!1),[b,C]=o.useState(0),[f,R]=o.useState(0),[j,k]=o.useState(0),[P,E]=o.useState(!1),[I,M]=o.useState(""),[O,v]=o.useState("success");o.useEffect(()=>{let H=null,p=null;if(s&&(s.dateDebut&&(H=F(s.dateDebut)),s.dateFin&&(p=F(s.dateFin))),H||(H=F().subtract(1,"year")),p||(p=F()),$(H),N(p),n&&Array.isArray(n)&&n.length>0){const D=n[0];C(parseInt(D.HommesServicesCentrauxFormes,10)||0),R(parseInt(D.TotalPersonnelsServicesCentrauxFormes,10)||0),k(parseInt(D.TotalPersonnelsFormes,10)||0),m(`${D.HommesServicesCentrauxFormes||0} homme(s) des services centraux form√©(s)`,"success")}else l&&u(l)},[s,n,l]);const u=async H=>{if(!H)return;w(!0);const p=localStorage.getItem("token"),D="";try{const U=await Z.post(`${D}/personnaliserrequette`,{query:H},{headers:{Authorization:`Bearer ${p}`}});if(Array.isArray(U.data)&&U.data.length>0){const X=U.data[0];C(parseInt(X.HommesServicesCentrauxFormes,10)||0),R(parseInt(X.TotalPersonnelsServicesCentrauxFormes,10)||0),k(parseInt(X.TotalPersonnelsFormes,10)||0),m(`${X.HommesServicesCentrauxFormes||0} homme(s) des services centraux form√©(s)`,"success")}else C(0),R(0),k(0),m("Aucun r√©sultat trouv√©.","info")}catch(U){const X=U.response?.data?.message||"Erreur lors de l‚Äôex√©cution de la requ√™te.";m(X,"error")}finally{w(!1)}},m=(H,p)=>{M(H),v(p),E(!0)},x=()=>{E(!1)},c=H=>F(H).format("DD/MM/YYYY"),h=()=>B||"Hommes des Services Centraux Form√©s sur une P√©riode",i=()=>z&&y?`Du ${c(z)} au ${c(y)}`:"P√©riode inconnue",d=()=>f===0?0:(b/f*100).toFixed(1),S=()=>j===0?0:(b/j*100).toFixed(1),A={chart:{type:"radialBar",height:350},colors:["#1976d2"],plotOptions:{radialBar:{startAngle:-135,endAngle:135,track:{background:"#e7e7e7",strokeWidth:"97%",margin:5},dataLabels:{name:{fontSize:"16px",color:"#888",offsetY:120},value:{offsetY:76,fontSize:"22px",color:"#111",formatter:()=>`${b} / ${j}`}}}},fill:{type:"gradient",gradient:{shade:"dark",shadeIntensity:.15,inverseColors:!1,stops:[0,50,65,91]}},stroke:{dashArray:4},labels:["Hommes Services Centraux"],title:{text:`${S()}% du total form√©`,align:"center",style:{fontSize:"18px",fontWeight:"bold",color:"#1976d2"}}},g={chart:{type:"bar",height:300,toolbar:{show:!1}},colors:["#1976d2","#e0e0e0"],plotOptions:{bar:{horizontal:!1,columnWidth:"55%",borderRadius:4}},dataLabels:{enabled:!0,style:{fontSize:"14px",fontWeight:"bold"}},xaxis:{categories:["Form√©s"],title:{text:"Comparaison"}},yaxis:{title:{text:"Nombre de personnes"}},legend:{position:"top"},title:{text:"R√©partition par genre (services centraux)",align:"center"}},L=[{name:"Hommes Services Centraux",data:[b]},{name:"Femmes Services Centraux",data:[f-b]}];return T?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"primary",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des statistiques..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mr:2},children:[e.jsx(Fe,{color:"primary",sx:{fontSize:36,mr:1}}),e.jsx(ne,{color:"primary",sx:{fontSize:40}})]}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",color:"primary",children:h()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:i()})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#e3f2fd",borderLeft:"4px solid #2196f3",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mb:1},children:[e.jsx(Fe,{sx:{fontSize:32,color:"#2196f3",mr:1}}),e.jsx(ne,{sx:{fontSize:36,color:"#2196f3"}})]}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#2196f3",children:b}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Hommes Services Centraux Form√©s"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#e8f5e8",borderLeft:"4px solid #4caf50",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(Ke,{sx:{fontSize:48,color:"#4caf50",mb:1}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#4caf50",children:f}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Total Services Centraux Form√©s"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#fff3e0",borderLeft:"4px solid #ff9800",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(Re,{sx:{fontSize:48,color:"#ff9800",mb:1}}),e.jsxs(t,{variant:"h3",fontWeight:"bold",color:"#ff9800",children:[d(),"%"]}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Taux dans Services Centraux"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#f3e5f5",borderLeft:"4px solid #9c27b0",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(je,{sx:{fontSize:48,color:"#9c27b0",mb:1}}),e.jsxs(t,{variant:"h3",fontWeight:"bold",color:"#9c27b0",children:[S(),"%"]}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Taux Global (vs Total Form√©s)"})]})})})]}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,md:7,children:e.jsxs(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:[e.jsx(t,{variant:"h6",sx:{mb:2,textAlign:"center"},children:"Hommes Services Centraux vs Total Form√©s"}),j>0?e.jsx(xe,{options:A,series:[parseFloat(S())],type:"radialBar",height:350}):e.jsxs(r,{sx:{textAlign:"center",mt:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Aucun personnel form√© sur cette p√©riode"})]})]})}),e.jsx(W,{item:!0,xs:12,md:5,children:e.jsx(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:f>0?e.jsx(xe,{options:g,series:L,type:"bar",height:300}):e.jsxs(r,{sx:{textAlign:"center",mt:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Donn√©es insuffisantes"})]})})})]}),e.jsxs(r,{sx:{p:3,bgcolor:"#f9f9f9",borderRadius:2},children:[e.jsxs(t,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(ee,{sx:{mr:1,color:"primary.main"}}),"R√©sum√© de l'analyse"]}),e.jsxs(t,{variant:"body1",sx:{lineHeight:1.6},children:["Sur la p√©riode du ",e.jsx("strong",{children:c(z)})," au ",e.jsx("strong",{children:c(y)}),",",e.jsxs("strong",{children:[" ",b," homme(s) des services centraux"]})," ont √©t√© form√©s.",e.jsx("br",{}),e.jsx("br",{}),"‚Ä¢ Ils repr√©sentent ",e.jsxs("strong",{children:[d(),"%"]})," des ",e.jsxs("strong",{children:[f," personnels des services centraux form√©s"]}),".",e.jsx("br",{}),"‚Ä¢ ",e.jsx("strong",{children:"Taux global :"})," Ces hommes repr√©sentent ",e.jsxs("strong",{children:[S(),"%"]})," du total des ",e.jsxs("strong",{children:[j," personnels form√©s"]}),".",b===0&&f>0&&e.jsx("div",{style:{color:"#f44336",marginTop:"8px"},children:"‚ö†Ô∏è Aucun homme des services centraux n‚Äôa √©t√© form√© durant cette p√©riode."}),f===0&&e.jsx("div",{style:{color:"#f44336",marginTop:"8px"},children:"‚ö†Ô∏è Aucun personnel des services centraux n‚Äôa √©t√© form√© durant cette p√©riode."}),S()<10&&b>0&&e.jsx("div",{style:{color:"#ff9800",marginTop:"8px"},children:"üìä Part faible : moins de 10% du total form√©."}),S()>=10&&S()<25&&e.jsxs("div",{style:{color:"#2196f3",marginTop:"8px"},children:["üìä Part mod√©r√©e : ",S(),"% du total form√©."]}),S()>=25&&e.jsxs("div",{style:{color:"#4caf50",marginTop:"8px"},children:["üìä Part importante : ",S(),"% du total form√©."]})]})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:P,onClose:x,autoHideDuration:5e3,children:e.jsx(qr,{onClose:x,severity:O,iconMapping:{success:e.jsx(ne,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:I})})})]})},ts=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),rs=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(!1),[b,C]=o.useState(0),[f,R]=o.useState(0),[j,k]=o.useState(0),[P,E]=o.useState(!1),[I,M]=o.useState(""),[O,v]=o.useState("success"),u="";o.useEffect(()=>{let p=null,D=null;if(s&&(s.date_debut&&(p=F(s.date_debut)),s.date_fin&&(D=F(s.date_fin))),p||(p=F().subtract(1,"year")),D||(D=F()),$(p),N(D),n&&Array.isArray(n)&&n.length>0){const U=n[0];C(parseInt(U.FemmesServicesCentrauxFormees,10)||0),R(parseInt(U.TotalPersonnelsServicesCentrauxFormes,10)||0),k(parseInt(U.TotalPersonnelsFormes,10)||0),x("Donn√©es charg√©es avec succ√®s","success")}else l&&m()},[s,n,l]);const m=async()=>{if(!l)return;w(!0);const p=localStorage.getItem("token");try{const D=await Z.post(`${u}/personnaliserrequette`,{query:l},{headers:{Authorization:`Bearer ${p}`}});if(D.data&&D.data.length>0){const U=D.data[0];C(parseInt(U.FemmesServicesCentrauxFormees,10)||0),R(parseInt(U.TotalPersonnelsServicesCentrauxFormes,10)||0),k(parseInt(U.TotalPersonnelsFormes,10)||0),x("Donn√©es charg√©es avec succ√®s","success")}else C(0),R(0),k(0),x("Aucune donn√©e trouv√©e","info")}catch(D){const U=D.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";x(U,"error")}finally{w(!1)}},x=(p,D)=>{M(p),v(D),E(!0)},c=()=>{E(!1)},h=p=>p?F(p).format("DD/MM/YYYY"):"-",i=()=>f===0?0:(b/f*100).toFixed(1),d=()=>j===0?0:(b/j*100).toFixed(1),S={chart:{type:"radialBar",height:350},colors:["#e91e63"],plotOptions:{radialBar:{startAngle:-135,endAngle:135,track:{background:"#e7e7e7",strokeWidth:"97%",margin:5},dataLabels:{name:{fontSize:"16px",color:"#888",offsetY:120},value:{offsetY:76,fontSize:"22px",color:"#111",formatter:()=>`${b} / ${j}`}}}},fill:{type:"gradient",gradient:{shade:"dark",shadeIntensity:.15,inverseColors:!1,stops:[0,50,65,91]}},stroke:{dashArray:4},labels:["Femmes Services Centraux"],title:{text:`${d()}% du total des personnels form√©s`,align:"center",style:{fontSize:"18px",fontWeight:"bold",color:"#e91e63"}}},A={chart:{type:"bar",height:300,toolbar:{show:!1}},colors:["#e91e63","#f8bbd9","#4caf50"],plotOptions:{bar:{horizontal:!1,columnWidth:"55%",borderRadius:4}},dataLabels:{enabled:!0,style:{fontSize:"14px",fontWeight:"bold"}},xaxis:{categories:["R√©partition des Form√©s"],title:{text:"Comparaison"}},yaxis:{title:{text:"Nombre de personnes"}},legend:{position:"top"},title:{text:"R√©partition des Personnels Form√©s",align:"center"}},g=[{name:"Femmes Services Centraux",data:[b]},{name:"Hommes Services Centraux",data:[f-b]}],L=()=>B||"Femmes des Services Centraux Form√©es sur une P√©riode",H=()=>z&&y?`Du ${h(z)} au ${h(y)}`:"P√©riode non sp√©cifi√©e";return T?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:300},children:[e.jsx(q,{size:50,color:"secondary",sx:{mb:3}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Analyse des formations en cours..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mr:2},children:[e.jsx(Ce,{sx:{color:"#e91e63",fontSize:28,mr:1}}),e.jsx(ne,{sx:{color:"#e91e63",fontSize:32}})]}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",sx:{color:"#e91e63"},children:L()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:H()})]})]}),e.jsx(J,{sx:{my:3}}),e.jsx(r,{display:"flex",justifyContent:"flex-end",mb:3,children:e.jsx(V,{label:`${h(z)} ‚Üí ${h(y)}`,color:"secondary",variant:"outlined",icon:e.jsx(pe,{fontSize:"small"}),sx:{fontSize:"0.9rem",fontWeight:500,py:1}})}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#fce4ec",borderLeft:"4px solid #e91e63",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mb:1},children:[e.jsx(Ce,{sx:{fontSize:32,color:"#e91e63",mr:1}}),e.jsx(ne,{sx:{fontSize:36,color:"#e91e63"}})]}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#e91e63",children:b}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Femmes Services Centraux Form√©es"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#e8f5e8",borderLeft:"4px solid #4caf50",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(Ke,{sx:{fontSize:48,color:"#4caf50",mb:1}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#4caf50",children:f}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Total Services Centraux Form√©s"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#fff3e0",borderLeft:"4px solid #ff9800",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(Re,{sx:{fontSize:48,color:"#ff9800",mb:1}}),e.jsxs(t,{variant:"h3",fontWeight:"bold",color:"#ff9800",children:[i(),"%"]}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Taux dans Services Centraux"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#f3e5f5",borderLeft:"4px solid #9c27b0",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(je,{sx:{fontSize:48,color:"#9c27b0",mb:1}}),e.jsxs(t,{variant:"h3",fontWeight:"bold",color:"#9c27b0",children:[d(),"%"]}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Taux Global (vs Total Form√©s)"})]})})})]}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:7,children:e.jsxs(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:[e.jsx(t,{variant:"h6",sx:{mb:2,textAlign:"center"},children:"Proportion de Femmes Form√©es des Services Centraux"}),j>0?e.jsx(xe,{options:S,series:[parseFloat(d())],type:"radialBar",height:350}):e.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:300},children:[e.jsx(_,{color:"action",sx:{fontSize:48,mb:2}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucune donn√©e disponible"})]})]})}),e.jsx(W,{item:!0,xs:12,md:5,children:e.jsx(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:f>0?e.jsx(xe,{options:A,series:g,type:"bar",height:300}):e.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:300},children:[e.jsx(_,{color:"action",sx:{fontSize:48,mb:2}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucune donn√©e disponible"})]})})})]}),e.jsxs(r,{sx:{mt:3,p:3,bgcolor:"#fce4ec",borderRadius:2},children:[e.jsxs(t,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(ee,{sx:{mr:1,color:"#e91e63"}}),"R√©sum√© de l'analyse"]}),e.jsxs(t,{variant:"body1",sx:{lineHeight:1.6},children:["Sur la p√©riode du ",e.jsx("strong",{children:h(z)})," au ",e.jsx("strong",{children:h(y)}),",",e.jsxs("strong",{children:[" ",b," femmes des services centraux"]})," ont √©t√© form√©es.",e.jsx("br",{}),e.jsx("br",{}),"‚Ä¢ Elles repr√©sentent ",e.jsxs("strong",{children:[i(),"%"]})," des ",e.jsxs("strong",{children:[f," personnels des services centraux form√©s"]}),".",e.jsx("br",{}),"‚Ä¢ ",e.jsx("strong",{children:"Taux global :"})," Ces femmes des services centraux repr√©sentent ",e.jsxs("strong",{children:[d(),"%"]})," de l'ensemble des ",e.jsxs("strong",{children:[j," personnels form√©s"]})," sur cette p√©riode.",e.jsx("br",{}),b===0&&f>0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("span",{style:{color:"#f44336"},children:"‚ö†Ô∏è Aucune femme des services centraux n'a √©t√© form√©e sur cette p√©riode."})]}),f===0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("span",{style:{color:"#f44336"},children:"‚ö†Ô∏è Aucun personnel des services centraux n'a √©t√© form√© sur cette p√©riode."})]}),parseFloat(d())<10&&b>0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("span",{style:{color:"#ff9800"},children:"üìä Les femmes des services centraux repr√©sentent moins de 10% du total des personnels form√©s."})]}),parseFloat(d())>=10&&parseFloat(d())<25&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsxs("span",{style:{color:"#2196f3"},children:["üìä Les femmes des services centraux repr√©sentent une part mod√©r√©e (",d(),"%) du total des personnels form√©s."]})]}),parseFloat(d())>=25&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsxs("span",{style:{color:"#4caf50"},children:["üìä Les femmes des services centraux repr√©sentent une part importante (",d(),"%) du total des personnels form√©s."]})]})]})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:P,onClose:c,autoHideDuration:5e3,children:e.jsx(ts,{onClose:c,severity:O,iconMapping:{success:e.jsx(ne,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:I})})})]})},ss=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),ns=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(!1),[b,C]=o.useState(0),[f,R]=o.useState(0),[j,k]=o.useState(0),[P,E]=o.useState(!1),[I,M]=o.useState(""),[O,v]=o.useState("success");o.useEffect(()=>{let H=null,p=null;if(s&&(s.dateDebut&&(H=F(s.dateDebut)),s.dateFin&&(p=F(s.dateFin))),H||(H=F().subtract(1,"year")),p||(p=F()),$(H),N(p),n&&Array.isArray(n)&&n.length>0){const D=n[0];C(parseInt(D.HommesServicesDeconcentresFormes,10)||0),R(parseInt(D.TotalPersonnelsServicesDeconcentresFormes,10)||0),k(parseInt(D.TotalPersonnelsFormes,10)||0),m(`${D.HommesServicesDeconcentresFormes||0} homme(s) des services d√©concentr√©s form√©(s)`,"success")}else l&&u(l)},[s,n,l]);const u=async H=>{if(!H)return;w(!0);const p=localStorage.getItem("token"),D="";try{const U=await Z.post(`${D}/personnaliserrequette`,{query:H},{headers:{Authorization:`Bearer ${p}`}});if(Array.isArray(U.data)&&U.data.length>0){const X=U.data[0];C(parseInt(X.HommesServicesDeconcentresFormes,10)||0),R(parseInt(X.TotalPersonnelsServicesDeconcentresFormes,10)||0),k(parseInt(X.TotalPersonnelsFormes,10)||0),m(`${X.HommesServicesDeconcentresFormes||0} homme(s) des services d√©concentr√©s form√©(s)`,"success")}else C(0),R(0),k(0),m("Aucun r√©sultat trouv√©.","info")}catch(U){const X=U.response?.data?.message||"Erreur lors de l‚Äôex√©cution de la requ√™te.";m(X,"error")}finally{w(!1)}},m=(H,p)=>{M(H),v(p),E(!0)},x=()=>{E(!1)},c=H=>F(H).format("DD/MM/YYYY"),h=()=>B||"Hommes des Services D√©concentr√©s Form√©s sur une P√©riode",i=()=>z&&y?`Du ${c(z)} au ${c(y)}`:"P√©riode inconnue",d=()=>f===0?0:(b/f*100).toFixed(1),S=()=>j===0?0:(b/j*100).toFixed(1),A={chart:{type:"radialBar",height:350},colors:["#f57c00"],plotOptions:{radialBar:{startAngle:-135,endAngle:135,track:{background:"#e7e7e7",strokeWidth:"97%",margin:5},dataLabels:{name:{fontSize:"16px",color:"#888",offsetY:120},value:{offsetY:76,fontSize:"22px",color:"#111",formatter:()=>`${b} / ${j}`}}}},fill:{type:"gradient",gradient:{shade:"dark",shadeIntensity:.15,inverseColors:!1,stops:[0,50,65,91]}},stroke:{dashArray:4},labels:["Hommes Services D√©concentr√©s"],title:{text:`${S()}% du total form√©`,align:"center",style:{fontSize:"18px",fontWeight:"bold",color:"#f57c00"}}},g={chart:{type:"bar",height:300,toolbar:{show:!1}},colors:["#f57c00","#e0e0e0"],plotOptions:{bar:{horizontal:!1,columnWidth:"55%",borderRadius:4}},dataLabels:{enabled:!0,style:{fontSize:"14px",fontWeight:"bold"}},xaxis:{categories:["Form√©s"],title:{text:"Comparaison"}},yaxis:{title:{text:"Nombre de personnes"}},legend:{position:"top"},title:{text:"R√©partition par genre",align:"center"}},L=[{name:"Hommes D√©concentr√©s",data:[b]},{name:"Femmes D√©concentr√©es",data:[f-b]}];return T?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"warning",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des statistiques d√©concentr√©es..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mr:2},children:[e.jsx(Fe,{sx:{color:"#f57c00",fontSize:36,mr:1}}),e.jsx(Ee,{sx:{color:"#f57c00",fontSize:40}})]}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",sx:{color:"#f57c00"},children:h()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:i()})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#fff8e1",borderLeft:"4px solid #f57c00",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mb:1},children:[e.jsx(Fe,{sx:{fontSize:32,color:"#f57c00",mr:1}}),e.jsx(Ee,{sx:{fontSize:36,color:"#f57c00"}})]}),e.jsx(t,{variant:"h3",fontWeight:"bold",sx:{color:"#f57c00"},children:b}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Hommes D√©concentr√©s Form√©s"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#e8f5e8",borderLeft:"4px solid #4caf50",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(Ze,{sx:{fontSize:48,color:"#4caf50",mb:1}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#4caf50",children:f}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Total D√©concentr√©s Form√©s"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#e3f2fd",borderLeft:"4px solid #2196f3",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(Re,{sx:{fontSize:48,color:"#2196f3",mb:1}}),e.jsxs(t,{variant:"h3",fontWeight:"bold",color:"#2196f3",children:[d(),"%"]}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Taux dans D√©concentr√©s"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#f3e5f5",borderLeft:"4px solid #9c27b0",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(je,{sx:{fontSize:48,color:"#9c27b0",mb:1}}),e.jsxs(t,{variant:"h3",fontWeight:"bold",color:"#9c27b0",children:[S(),"%"]}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Taux Global (vs Total Form√©s)"})]})})})]}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,md:7,children:e.jsxs(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:[e.jsx(t,{variant:"h6",sx:{mb:2,textAlign:"center"},children:"Hommes D√©concentr√©s vs Total Form√©s"}),j>0?e.jsx(xe,{options:A,series:[parseFloat(S())],type:"radialBar",height:350}):e.jsxs(r,{sx:{textAlign:"center",mt:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Aucun personnel form√© sur cette p√©riode"})]})]})}),e.jsx(W,{item:!0,xs:12,md:5,children:e.jsx(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:f>0?e.jsx(xe,{options:g,series:L,type:"bar",height:300}):e.jsxs(r,{sx:{textAlign:"center",mt:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Donn√©es insuffisantes"})]})})})]}),e.jsxs(r,{sx:{p:3,bgcolor:"#f9f9f9",borderRadius:2},children:[e.jsxs(t,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(ee,{sx:{mr:1,color:"#f57c00"}}),"R√©sum√© de l'analyse"]}),e.jsxs(t,{variant:"body1",sx:{lineHeight:1.6},children:["Sur la p√©riode du ",e.jsx("strong",{children:c(z)})," au ",e.jsx("strong",{children:c(y)}),",",e.jsxs("strong",{children:[" ",b," homme(s) des services d√©concentr√©s"]})," ont √©t√© form√©s.",e.jsx("br",{}),e.jsx("br",{}),"‚Ä¢ Ils repr√©sentent ",e.jsxs("strong",{children:[d(),"%"]})," des ",e.jsxs("strong",{children:[f," personnels d√©concentr√©s form√©s"]}),".",e.jsx("br",{}),"‚Ä¢ ",e.jsx("strong",{children:"Taux global :"})," Ces hommes repr√©sentent ",e.jsxs("strong",{children:[S(),"%"]})," du total des ",e.jsxs("strong",{children:[j," personnels form√©s"]}),".",b===0&&f>0&&e.jsx("div",{style:{color:"#f44336",marginTop:"8px"},children:"‚ö†Ô∏è Aucun homme des services d√©concentr√©s n‚Äôa √©t√© form√© durant cette p√©riode."}),f===0&&e.jsx("div",{style:{color:"#f44336",marginTop:"8px"},children:"‚ö†Ô∏è Aucun personnel d√©concentr√© n‚Äôa √©t√© form√© durant cette p√©riode."}),S()<10&&b>0&&e.jsx("div",{style:{color:"#ff9800",marginTop:"8px"},children:"üìä Part faible : moins de 10% du total form√©."}),S()>=10&&S()<25&&e.jsxs("div",{style:{color:"#2196f3",marginTop:"8px"},children:["üìä Part mod√©r√©e : ",S(),"% du total form√©."]}),S()>=25&&e.jsxs("div",{style:{color:"#4caf50",marginTop:"8px"},children:["üìä Part importante : ",S(),"% du total form√©."]})]})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:P,onClose:x,autoHideDuration:5e3,children:e.jsx(ss,{onClose:x,severity:O,iconMapping:{success:e.jsx(Ee,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:I})})})]})},os=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),is=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(!1),[b,C]=o.useState(0),[f,R]=o.useState(0),[j,k]=o.useState(0),[P,E]=o.useState(!1),[I,M]=o.useState(""),[O,v]=o.useState("success"),u="";o.useEffect(()=>{let p=null,D=null;if(s&&(s.date_debut&&(p=F(s.date_debut)),s.date_fin&&(D=F(s.date_fin))),p||(p=F().subtract(1,"year")),D||(D=F()),$(p),N(D),n&&Array.isArray(n)&&n.length>0){const U=n[0];C(parseInt(U.FemmesServicesDeconcentresFormees,10)||0),R(parseInt(U.TotalPersonnelsServicesDeconcentresFormes,10)||0),k(parseInt(U.TotalPersonnelsFormes,10)||0),x("Donn√©es charg√©es avec succ√®s","success")}else l&&m()},[s,n,l]);const m=async()=>{if(!l)return;w(!0);const p=localStorage.getItem("token");try{const D=await Z.post(`${u}/personnaliserrequette`,{query:l},{headers:{Authorization:`Bearer ${p}`}});if(D.data&&D.data.length>0){const U=D.data[0];C(parseInt(U.FemmesServicesDeconcentresFormees,10)||0),R(parseInt(U.TotalPersonnelsServicesDeconcentresFormes,10)||0),k(parseInt(U.TotalPersonnelsFormes,10)||0),x("Donn√©es charg√©es avec succ√®s","success")}else C(0),R(0),k(0),x("Aucune donn√©e trouv√©e","info")}catch(D){const U=D.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";x(U,"error")}finally{w(!1)}},x=(p,D)=>{M(p),v(D),E(!0)},c=()=>{E(!1)},h=p=>p?F(p).format("DD/MM/YYYY"):"-",i=()=>f===0?0:(b/f*100).toFixed(1),d=()=>j===0?0:(b/j*100).toFixed(1),S={chart:{type:"radialBar",height:350},colors:["#e91e63"],plotOptions:{radialBar:{startAngle:-135,endAngle:135,track:{background:"#e7e7e7",strokeWidth:"97%",margin:5},dataLabels:{name:{fontSize:"16px",color:"#888",offsetY:120},value:{offsetY:76,fontSize:"22px",color:"#111",formatter:()=>`${b} / ${j}`}}}},fill:{type:"gradient",gradient:{shade:"dark",shadeIntensity:.15,inverseColors:!1,stops:[0,50,65,91]}},stroke:{dashArray:4},labels:["Femmes Services D√©concentr√©s"],title:{text:`${d()}% de personnels form√©s`,align:"center",style:{fontSize:"18px",fontWeight:"bold",color:"#e91e63"}}},A={chart:{type:"bar",height:300,toolbar:{show:!1}},colors:["#e91e63","#f8bbd9"],plotOptions:{bar:{horizontal:!1,columnWidth:"55%",borderRadius:4}},dataLabels:{enabled:!0,style:{fontSize:"14px",fontWeight:"bold"}},xaxis:{categories:["R√©partition des Form√©s"],title:{text:"Comparaison"}},yaxis:{title:{text:"Nombre de personnes"}},legend:{position:"top"},title:{text:"R√©partition des Personnels Form√©s",align:"center"}},g=[{name:"Femmes Services D√©concentr√©s",data:[b]},{name:"Hommes Services D√©concentr√©s",data:[f-b]}],L=()=>B||"Femmes des Services D√©concentr√©s Form√©es sur une P√©riode",H=()=>z&&y?`Du ${h(z)} au ${h(y)}`:"P√©riode non sp√©cifi√©e";return T?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:300},children:[e.jsx(q,{size:50,color:"secondary",sx:{mb:3}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Analyse des formations en cours..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mr:2},children:[e.jsx(Ce,{sx:{color:"#e91e63",fontSize:28,mr:1}}),e.jsx(Ee,{sx:{color:"#4e1e2eff",fontSize:32}})]}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",sx:{color:"#1e51e9ff"},children:L()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:H()})]})]}),e.jsx(J,{sx:{my:3}}),e.jsx(r,{display:"flex",justifyContent:"flex-end",mb:3,children:e.jsx(V,{label:`${h(z)} ‚Üí ${h(y)}`,color:"secondary",variant:"outlined",icon:e.jsx(pe,{fontSize:"small"}),sx:{fontSize:"0.9rem",fontWeight:500,py:1}})}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#fce4ec",borderLeft:"4px solid #e91e63",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mb:1},children:[e.jsx(Ce,{sx:{fontSize:32,color:"#e91e63",mr:1}}),e.jsx(Ee,{sx:{fontSize:36,color:"#e91e63"}})]}),e.jsx(t,{variant:"h3",fontWeight:"bold",sx:{color:"#e91e63"},children:b}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Femmes Services D√©concentr√©s Form√©es"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#e8f5e8",borderLeft:"4px solid #4caf50",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(Ze,{sx:{fontSize:48,color:"#4caf50",mb:1}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#4caf50",children:f}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Total Services D√©concentr√©s Form√©s"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#e3f2fd",borderLeft:"4px solid #2196f3",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(Re,{sx:{fontSize:48,color:"#2196f3",mb:1}}),e.jsxs(t,{variant:"h3",fontWeight:"bold",color:"#2196f3",children:[i(),"%"]}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Taux dans Services D√©concentr√©s"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#f3e5f5",borderLeft:"4px solid #9c27b0",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(je,{sx:{fontSize:48,color:"#9c27b0",mb:1}}),e.jsxs(t,{variant:"h3",fontWeight:"bold",color:"#9c27b0",children:[d(),"%"]}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Taux Global (vs Total Form√©s)"})]})})})]}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:7,children:e.jsxs(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:[e.jsx(t,{variant:"h6",sx:{mb:2,textAlign:"center"},children:"Proportion de Femmes Form√©es des Services D√©concentr√©s"}),j>0?e.jsx(xe,{options:S,series:[parseFloat(d())],type:"radialBar",height:350}):e.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:300},children:[e.jsx(_,{color:"action",sx:{fontSize:48,mb:2}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucune donn√©e disponible"})]})]})}),e.jsx(W,{item:!0,xs:12,md:5,children:e.jsx(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:f>0?e.jsx(xe,{options:A,series:g,type:"bar",height:300}):e.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:300},children:[e.jsx(_,{color:"action",sx:{fontSize:48,mb:2}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucune donn√©e disponible"})]})})})]}),e.jsxs(r,{sx:{mt:3,p:3,bgcolor:"#f9f9f9",borderRadius:2},children:[e.jsxs(t,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(ee,{sx:{mr:1,color:"#e91e63"}}),"R√©sum√© de l'analyse"]}),e.jsxs(t,{variant:"body1",sx:{lineHeight:1.6},children:["Sur la p√©riode du ",e.jsx("strong",{children:h(z)})," au ",e.jsx("strong",{children:h(y)}),",",e.jsxs("strong",{children:[" ",b," femmes des services d√©concentr√©s"]})," ont √©t√© form√©es.",e.jsx("br",{}),e.jsx("br",{}),"‚Ä¢ Elles repr√©sentent ",e.jsxs("strong",{children:[i(),"%"]})," des ",e.jsxs("strong",{children:[f," personnels des services d√©concentr√©s form√©s"]}),".",e.jsx("br",{}),"‚Ä¢ ",e.jsx("strong",{children:"Taux global :"})," Ces femmes des services d√©concentr√©s repr√©sentent ",e.jsxs("strong",{children:[d(),"%"]})," de l'ensemble des ",e.jsxs("strong",{children:[j," personnels form√©s"]})," sur cette p√©riode.",e.jsx("br",{}),b===0&&f>0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("span",{style:{color:"#f44336"},children:"‚ö†Ô∏è Aucune femme des services d√©concentr√©s n'a √©t√© form√©e sur cette p√©riode."})]}),f===0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("span",{style:{color:"#f44336"},children:"‚ö†Ô∏è Aucun personnel des services d√©concentr√©s n'a √©t√© form√© sur cette p√©riode."})]}),parseFloat(d())<10&&b>0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("span",{style:{color:"#ff9800"},children:"üìä Les femmes des services d√©concentr√©s repr√©sentent moins de 10% du total des personnels form√©s."})]}),parseFloat(d())>=10&&parseFloat(d())<25&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsxs("span",{style:{color:"#2196f3"},children:["üìä Les femmes des services d√©concentr√©s repr√©sentent une part mod√©r√©e (",d(),"%) du total des personnels form√©s."]})]}),parseFloat(d())>=25&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsxs("span",{style:{color:"#4caf50"},children:["üìä Les femmes des services d√©concentr√©s repr√©sentent une part importante (",d(),"%) du total des personnels form√©s."]})]})]})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:P,onClose:c,autoHideDuration:5e3,children:e.jsx(os,{onClose:c,severity:O,iconMapping:{success:e.jsx(Ee,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:I})})})]})},as=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),ls=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(!1),[b,C]=o.useState(0),[f,R]=o.useState(0),[j,k]=o.useState(0),[P,E]=o.useState(!1),[I,M]=o.useState(""),[O,v]=o.useState("success");o.useEffect(()=>{let D=null,U=null;if(s&&(s.dateDebut&&(D=F(s.dateDebut)),s.dateFin&&(U=F(s.dateFin))),D||(D=F().subtract(1,"year")),U||(U=F()),$(D),N(U),n&&Array.isArray(n)&&n.length>0){const X=n[0];C(parseInt(X.PersonnelsNonFormes,10)||0),R(parseInt(X.PersonnelsFormes,10)||0),k(parseInt(X.TotalPersonnels,10)||0),m(`${X.PersonnelsNonFormes||0} personnel(s) non form√©(s) trouv√©(s)`,"success")}else l&&u(l)},[s,n,l]);const u=async D=>{if(!D)return;w(!0);const U=localStorage.getItem("token"),X="";try{const ie=await Z.post(`${X}/personnaliserrequette`,{query:D},{headers:{Authorization:`Bearer ${U}`}});if(Array.isArray(ie.data)&&ie.data.length>0){const Se=ie.data[0];C(parseInt(Se.PersonnelsNonFormes,10)||0),R(parseInt(Se.PersonnelsFormes,10)||0),k(parseInt(Se.TotalPersonnels,10)||0),m(`${Se.PersonnelsNonFormes||0} personnel(s) non form√©(s)`,"success")}else C(0),R(0),k(0),m("Aucun r√©sultat trouv√©.","info")}catch(ie){const Se=ie.response?.data?.message||"Erreur lors de l‚Äôex√©cution de la requ√™te.";m(Se,"error")}finally{w(!1)}},m=(D,U)=>{M(D),v(U),E(!0)},x=()=>{E(!1)},c=D=>F(D).format("DD/MM/YYYY"),h=()=>B||"Personnels Non Form√©s sur une P√©riode",i=()=>z&&y?`Du ${c(z)} au ${c(y)}`:"P√©riode inconnue",d=()=>j===0?0:(b/j*100).toFixed(1),S=()=>j===0?0:(f/j*100).toFixed(1),A={chart:{type:"radialBar",height:350},colors:["#f44336"],plotOptions:{radialBar:{startAngle:-135,endAngle:135,track:{background:"#e7e7e7",strokeWidth:"97%",margin:5},dataLabels:{name:{fontSize:"16px",color:"#888",offsetY:120},value:{offsetY:76,fontSize:"22px",color:"#111",formatter:()=>`${b} / ${j}`}}}},fill:{type:"gradient",gradient:{shade:"dark",shadeIntensity:.15,inverseColors:!1,stops:[0,50,65,91]}},stroke:{dashArray:4},labels:["Non Form√©s"],title:{text:`${d()}% non form√©s`,align:"center",style:{fontSize:"18px",fontWeight:"bold",color:"#f44336"}}},g={chart:{type:"pie",height:300},colors:["#f44336","#4caf50"],labels:["Non Form√©s","Form√©s"],legend:{position:"bottom"},dataLabels:{enabled:!0,formatter:(D,U)=>U.w.config.series[U.seriesIndex]+`
(`+D.toFixed(1)+"%)"},title:{text:"R√©partition en Pourcentage",align:"center",style:{fontSize:"16px",fontWeight:"bold"}}},L=[b,f],H={chart:{type:"bar",height:300,toolbar:{show:!1}},colors:["#f44336","#4caf50"],plotOptions:{bar:{horizontal:!1,columnWidth:"55%",borderRadius:4}},dataLabels:{enabled:!0,style:{fontSize:"14px",fontWeight:"bold"}},xaxis:{categories:["Statut"],title:{text:"Comparaison"}},yaxis:{title:{text:"Nombre de personnels"}},legend:{position:"top"},title:{text:"Form√©s vs Non Form√©s",align:"center"}},p=[{name:"Non Form√©s",data:[b]},{name:"Form√©s",data:[f]}];return T?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"error",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des statistiques..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mr:2},children:[e.jsx(ye,{sx:{color:"#2196f3",fontSize:36,mr:1}}),e.jsx(Ae,{sx:{color:"#2196f3",fontSize:32}})]}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",sx:{color:"#2196f3"},children:h()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:i()})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#ffebee",borderLeft:"4px solid #f44336",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mb:1},children:[e.jsx(ye,{sx:{fontSize:36,color:"#f44336",mr:1}}),e.jsx(Ae,{sx:{fontSize:32,color:"#f44336"}})]}),e.jsx(t,{variant:"h3",fontWeight:"bold",sx:{color:"#f44336"},children:b}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Non Form√©s"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#e8f5e8",borderLeft:"4px solid #4caf50",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(he,{sx:{fontSize:48,color:"#4caf50",mb:1}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#4caf50",children:f}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Form√©s"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#e3f2fd",borderLeft:"4px solid #2196f3",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(je,{sx:{fontSize:48,color:"#2196f3",mb:1}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#2196f3",children:j}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Total"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#fff3e0",borderLeft:"4px solid #ff9800",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(Qe,{sx:{fontSize:48,color:"#ff9800",mb:1}}),e.jsxs(t,{variant:"h3",fontWeight:"bold",color:"#ff9800",children:[d(),"%"]}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Taux Non Form√©s"})]})})})]}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:[e.jsx(t,{variant:"h6",sx:{mb:2,textAlign:"center"},children:"Proportion des Non Form√©s"}),j>0?e.jsx(xe,{options:A,series:[parseFloat(d())],type:"radialBar",height:350}):e.jsxs(r,{sx:{textAlign:"center",mt:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Aucun personnel enregistr√©"})]})]})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:j>0?e.jsx(xe,{options:g,series:L,type:"pie",height:300}):e.jsxs(r,{sx:{textAlign:"center",mt:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Donn√©es insuffisantes"})]})})})]}),e.jsx(W,{container:!0,spacing:3,sx:{mb:4},children:e.jsx(W,{item:!0,xs:12,children:e.jsx(Y,{sx:{p:3,borderRadius:2},children:j>0?e.jsx(xe,{options:H,series:p,type:"bar",height:300}):e.jsxs(r,{sx:{textAlign:"center",mt:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Aucune donn√©e disponible"})]})})})}),e.jsxs(r,{sx:{p:3,bgcolor:"#f9f9f9",borderRadius:2},children:[e.jsxs(t,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(ee,{sx:{mr:1,color:"primary.main"}}),"R√©sum√© de l'analyse"]}),e.jsxs(t,{variant:"body1",sx:{lineHeight:1.6},children:["Sur la p√©riode du ",e.jsx("strong",{children:c(z)})," au ",e.jsx("strong",{children:c(y)}),",",e.jsxs("strong",{children:[" ",b," personnel(s)"]})," n‚Äôont b√©n√©fici√© d‚Äôaucune formation.",e.jsx("br",{}),e.jsx("br",{}),"‚Ä¢ ",e.jsx("strong",{children:"Taux de non-formation :"})," ",e.jsxs("strong",{children:[d(),"%"]}),".",e.jsx("br",{}),"‚Ä¢ ",e.jsx("strong",{children:"Taux de formation :"})," ",e.jsxs("strong",{children:[S(),"%"]})," (",f," personnes).",e.jsx("br",{}),"‚Ä¢ ",e.jsx("strong",{children:"Total des personnels :"})," ",e.jsx("strong",{children:j}),".",d()>75&&e.jsx("div",{style:{color:"#f44336",marginTop:"8px"},children:"üö® Alerte : Plus de 75% des personnels n‚Äôont pas √©t√© form√©s !"}),d()>50&&d()<=75&&e.jsx("div",{style:{color:"#f44336",marginTop:"8px"},children:"‚ö†Ô∏è Plus de la moiti√© des personnels non form√©s."}),d()<25&&b>0&&e.jsx("div",{style:{color:"#4caf50",marginTop:"8px"},children:"‚úÖ Moins de 25% non form√©s ‚Äî bon taux de formation."}),b===0&&e.jsx("div",{style:{color:"#4caf50",marginTop:"8px"},children:"üéâ Tous les personnels ont √©t√© form√©s ‚Äî excellente performance !"}),j===0&&e.jsx("div",{style:{color:"#ff9800",marginTop:"8px"},children:"‚ö†Ô∏è Aucun personnel enregistr√© dans le syst√®me."})]})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:P,onClose:x,autoHideDuration:5e3,children:e.jsx(as,{onClose:x,severity:O,iconMapping:{success:e.jsx(ye,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:I})})})]})},cs=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),ds=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(!1),[b,C]=o.useState(0),[f,R]=o.useState(0),[j,k]=o.useState(!1),[P,E]=o.useState(""),[I,M]=o.useState("success");o.useEffect(()=>{let g=null,L=null;if(s&&(s.dateDebut&&(g=F(s.dateDebut)),s.dateFin&&(L=F(s.dateFin))),g||(g=F().subtract(1,"year")),L||(L=F()),$(g),N(L),n&&Array.isArray(n)&&n.length>0){const H=n[0];C(parseInt(H.HommesNonFormes,10)||0),R(parseInt(H.TotalHommes,10)||0),v(`${H.HommesNonFormes||0} homme(s) non form√©(s) trouv√©(s)`,"success")}else l&&O(l)},[s,n,l]);const O=async g=>{if(!g)return;w(!0);const L=localStorage.getItem("token"),H="";try{const p=await Z.post(`${H}/personnaliserrequette`,{query:g},{headers:{Authorization:`Bearer ${L}`}});if(Array.isArray(p.data)&&p.data.length>0){const D=p.data[0];C(parseInt(D.HommesNonFormes,10)||0),R(parseInt(D.TotalHommes,10)||0),v(`${D.HommesNonFormes||0} homme(s) non form√©(s)`,"success")}else C(0),R(0),v("Aucun r√©sultat trouv√©.","info")}catch(p){const D=p.response?.data?.message||"Erreur lors de l‚Äôex√©cution de la requ√™te.";v(D,"error")}finally{w(!1)}},v=(g,L)=>{E(g),M(L),k(!0)},u=()=>{k(!1)},m=g=>F(g).format("DD/MM/YYYY"),x=()=>B||"Nombre d'Hommes Non Form√©s sur une P√©riode",c=()=>z&&y?`Du ${m(z)} au ${m(y)}`:"P√©riode inconnue",h=()=>f===0?0:(b/f*100).toFixed(1),i=()=>f===0?0:((f-b)/f*100).toFixed(1),d={chart:{type:"radialBar",height:350},colors:["#d32f2f"],plotOptions:{radialBar:{startAngle:-135,endAngle:135,track:{background:"#e7e7e7",strokeWidth:"97%",margin:5},dataLabels:{name:{fontSize:"16px",color:"#888",offsetY:120},value:{offsetY:76,fontSize:"22px",color:"#111",formatter:()=>`${b} / ${f}`}}}},fill:{type:"gradient",gradient:{shade:"dark",shadeIntensity:.15,inverseColors:!1,stops:[0,50,65,91]}},stroke:{dashArray:4},labels:["Non Form√©s"],title:{text:`${h()}% non form√©s`,align:"center",style:{fontSize:"18px",fontWeight:"bold",color:"#d32f2f"}}},S={chart:{type:"bar",height:300,toolbar:{show:!1}},colors:["#d32f2f","#4caf50"],plotOptions:{bar:{horizontal:!1,columnWidth:"55%",borderRadius:4}},dataLabels:{enabled:!0,style:{fontSize:"14px",fontWeight:"bold"}},xaxis:{categories:["Hommes"],title:{text:"Statut"}},yaxis:{title:{text:"Nombre"}},legend:{position:"top"},title:{text:"Form√©s vs Non Form√©s",align:"center"}},A=[{name:"Non Form√©s",data:[b]},{name:"Form√©s",data:[f-b]}];return T?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200},children:[e.jsx(q,{size:40,color:"error",sx:{mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Chargement des statistiques..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0,0,0,0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(ye,{sx:{color:"#d32f2f",fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",sx:{color:"#d32f2f"},children:x()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:c()})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,md:4,children:e.jsx(Q,{sx:{bgcolor:"#ffebee",borderLeft:"4px solid #d32f2f",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(ye,{sx:{fontSize:48,color:"#d32f2f",mb:1}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#d32f2f",children:b}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Hommes Non Form√©s"})]})})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsx(Q,{sx:{bgcolor:"#e8f5e8",borderLeft:"4px solid #4caf50",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(Fe,{sx:{fontSize:48,color:"#4caf50",mb:1}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#4caf50",children:f}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Total Hommes"})]})})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsx(Q,{sx:{bgcolor:"#fff3e0",borderLeft:"4px solid #ff9800",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(Qe,{sx:{fontSize:48,color:"#ff9800",mb:1}}),e.jsxs(t,{variant:"h3",fontWeight:"bold",color:"#ff9800",children:[h(),"%"]}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Taux Non Form√©s"})]})})})]}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,md:7,children:e.jsxs(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:[e.jsx(t,{variant:"h6",sx:{mb:2,textAlign:"center"},children:"Proportion d'Hommes Non Form√©s"}),f>0?e.jsx(xe,{options:d,series:[parseFloat(h())],type:"radialBar",height:350}):e.jsxs(r,{sx:{textAlign:"center",mt:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Aucun homme enregistr√©"})]})]})}),e.jsx(W,{item:!0,xs:12,md:5,children:e.jsxs(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:[e.jsx(t,{variant:"h6",sx:{mb:2,textAlign:"center"},children:"Comparaison Visuelle"}),f>0?e.jsx(xe,{options:S,series:A,type:"bar",height:300}):e.jsxs(r,{sx:{textAlign:"center",mt:4},children:[e.jsx(_,{color:"action",sx:{fontSize:40,mb:1}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Donn√©es insuffisantes"})]})]})})]}),e.jsxs(r,{sx:{p:3,bgcolor:"#f9f9f9",borderRadius:2},children:[e.jsxs(t,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(ee,{sx:{mr:1,color:"primary.main"}}),"R√©sum√© de l'analyse"]}),e.jsxs(t,{variant:"body1",sx:{lineHeight:1.6},children:["Sur la p√©riode du ",e.jsx("strong",{children:m(z)})," au ",e.jsx("strong",{children:m(y)}),",",e.jsxs("strong",{children:[" ",b," homme(s)"]})," n‚Äôont pas b√©n√©fici√© de formations sur un total de ",e.jsxs("strong",{children:[f," hommes"]}),", soit ",e.jsxs("strong",{children:[h(),"%"]})," des hommes non form√©s.",b===0&&f>0&&e.jsx("span",{style:{color:"#4caf50"},children:" Tous les hommes ont √©t√© form√©s ‚Äî excellente performance !"}),f===0&&e.jsx("span",{style:{color:"#f44336"},children:" Aucun homme n‚Äôest enregistr√© dans l‚Äôorganisation."}),h()>50&&b>0&&e.jsx("span",{style:{color:"#d32f2f"},children:" Plus de la moiti√© des hommes n‚Äôont pas √©t√© form√©s ‚Äî situation critique."}),h()<=50&&b>0&&e.jsx("span",{style:{color:"#ff9800"},children:" Moins de la moiti√© non form√©s ‚Äî acceptable, mais am√©liorable."}),i()>0&&e.jsxs("span",{children:[" ",e.jsxs("strong",{children:[i(),"%"]})," des hommes ont √©t√© form√©s."]})]})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:j,onClose:u,autoHideDuration:5e3,children:e.jsx(cs,{onClose:u,severity:I,iconMapping:{success:e.jsx(ye,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0,0,0,0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:P})})})]})},xs=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),us=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(null),[y,N]=o.useState(null),[T,w]=o.useState(!1),[b,C]=o.useState(0),[f,R]=o.useState(0),[j,k]=o.useState(0),[P,E]=o.useState(!1),[I,M]=o.useState(""),[O,v]=o.useState("success"),u="";o.useEffect(()=>{let U=null,X=null;if(s&&(s.date_debut&&(U=F(s.date_debut)),s.date_fin&&(X=F(s.date_fin))),U||(U=F().subtract(1,"year")),X||(X=F()),$(U),N(X),n&&Array.isArray(n)&&n.length>0){const ie=n[0];k(parseInt(ie.HommesServicesCentrauxFormes,10)||0),R(parseInt(ie.TotalPersonnelsServicesCentrauxFormes,10)||0),C((parseInt(ie.TotalPersonnelsServicesCentrauxFormes,10)||0)-(parseInt(ie.HommesServicesCentrauxFormes,10)||0)),x("Donn√©es charg√©es avec succ√®s","success")}else l&&m()},[s,n,l]);const m=async()=>{if(!l)return;w(!0);const U=localStorage.getItem("token");try{const X=await Z.post(`${u}/personnaliserrequette`,{query:l},{headers:{Authorization:`Bearer ${U}`}});if(X.data&&X.data.length>0){const ie=X.data[0];k(parseInt(ie.HommesServicesCentrauxFormes,10)||0),R(parseInt(ie.TotalPersonnelsServicesCentrauxFormes,10)||0),C((parseInt(ie.TotalPersonnelsServicesCentrauxFormes,10)||0)-(parseInt(ie.HommesServicesCentrauxFormes,10)||0)),x("Donn√©es charg√©es avec succ√®s","success")}else k(0),R(0),C(0),x("Aucune donn√©e trouv√©e","info")}catch(X){const ie=X.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";x(ie,"error")}finally{w(!1)}},x=(U,X)=>{M(U),v(X),E(!0)},c=()=>{E(!1)},h=U=>U?F(U).format("DD/MM/YYYY"):"-",i=()=>f===0?0:(b/f*100).toFixed(1),d=()=>f===0?0:(j/f*100).toFixed(1),S={chart:{type:"radialBar",height:350},colors:["#ff9800"],plotOptions:{radialBar:{startAngle:-135,endAngle:135,track:{background:"#e7e7e7",strokeWidth:"97%",margin:5},dataLabels:{name:{fontSize:"16px",color:"#888",offsetY:120},value:{offsetY:76,fontSize:"22px",color:"#111",formatter:()=>`${b} / ${f}`}}}},fill:{type:"gradient",gradient:{shade:"dark",shadeIntensity:.15,inverseColors:!1,stops:[0,50,65,91]}},stroke:{dashArray:4},labels:["Hommes Non Form√©s"],title:{text:`${i()}% d'hommes non form√©s`,align:"center",style:{fontSize:"18px",fontWeight:"bold",color:"#ff9800"}}},A={chart:{type:"bar",height:300,toolbar:{show:!1}},colors:["#4caf50","#ff9800"],plotOptions:{bar:{horizontal:!1,columnWidth:"55%",borderRadius:4}},dataLabels:{enabled:!0,style:{fontSize:"14px",fontWeight:"bold"}},xaxis:{categories:["Hommes Services Centraux"],title:{text:"Statut de Formation"}},yaxis:{title:{text:"Nombre de personnes"}},legend:{position:"top"},title:{text:"Form√©s vs Non Form√©s",align:"center"}},g=[{name:"Form√©s",data:[j]},{name:"Non Form√©s",data:[b]}],L={chart:{type:"donut",height:300},colors:["#4caf50","#ff9800"],labels:["Form√©s","Non Form√©s"],dataLabels:{enabled:!0,formatter:function(U,X){return X.w.config.series[X.seriesIndex]}},legend:{position:"bottom"},title:{text:"R√©partition Formation",align:"center"}},H=[j,b],p=()=>B||"Hommes des Services Centraux Non Form√©s",D=()=>z&&y?`Du ${h(z)} au ${h(y)}`:"P√©riode non sp√©cifi√©e";return T?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:300},children:[e.jsx(q,{size:50,color:"warning",sx:{mb:3}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Analyse des formations en cours..."})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mr:2},children:[e.jsx(Fe,{color:"warning",sx:{fontSize:28,mr:1}}),e.jsx(ne,{color:"warning",sx:{fontSize:32,mr:1}}),e.jsx(Ae,{color:"warning",sx:{fontSize:24}})]}),e.jsxs(r,{children:[e.jsx(t,{variant:"h5",fontWeight:"bold",sx:{color:"#f57c00"},children:p()}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:D()})]})]}),e.jsx(J,{sx:{my:3}}),e.jsx(r,{display:"flex",justifyContent:"flex-end",mb:3,children:e.jsx(V,{label:`${h(z)} ‚Üí ${h(y)}`,color:"warning",variant:"outlined",icon:e.jsx(pe,{fontSize:"small"}),sx:{fontSize:"0.9rem",fontWeight:500,py:1}})}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#fff3e0",borderLeft:"4px solid #ff9800",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mb:1},children:[e.jsx(Fe,{sx:{fontSize:32,color:"#ff9800",mr:1}}),e.jsx(Ae,{sx:{fontSize:36,color:"#ff9800"}})]}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#ff9800",children:b}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Hommes Non Form√©s"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#e3f2fd",borderLeft:"4px solid #2196f3",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(Fe,{sx:{fontSize:48,color:"#2196f3",mb:1}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#2196f3",children:f}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Total Hommes Services Centraux"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#e8f5e8",borderLeft:"4px solid #4caf50",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(he,{sx:{fontSize:48,color:"#4caf50",mb:1}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"#4caf50",children:j}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Hommes Form√©s"})]})})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(Q,{sx:{bgcolor:"#ffebee",borderLeft:"4px solid #f44336",height:"100%"},children:e.jsxs(K,{sx:{textAlign:"center"},children:[e.jsx(Qe,{sx:{fontSize:48,color:"#f44336",mb:1}}),e.jsxs(t,{variant:"h3",fontWeight:"bold",color:"#f44336",children:[i(),"%"]}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Taux Non Formation"})]})})})]}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:[e.jsx(t,{variant:"h6",sx:{mb:2,textAlign:"center"},children:"Proportion des Hommes Non Form√©s"}),f>0?e.jsx(xe,{options:S,series:[parseFloat(i())],type:"radialBar",height:350}):e.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:300},children:[e.jsx(_,{color:"action",sx:{fontSize:48,mb:2}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucune donn√©e disponible"})]})]})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(Y,{sx:{p:3,borderRadius:2,height:"400px"},children:[e.jsx(t,{variant:"h6",sx:{mb:2,textAlign:"center"},children:"Comparaison Form√©s/Non Form√©s"}),f>0?e.jsx(xe,{options:A,series:g,type:"bar",height:300}):e.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:300},children:[e.jsx(_,{color:"action",sx:{fontSize:48,mb:2}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucune donn√©e disponible"})]})]})})]}),e.jsx(W,{container:!0,spacing:3,sx:{mt:2},children:e.jsx(W,{item:!0,xs:12,children:e.jsxs(Y,{sx:{p:3,borderRadius:2},children:[e.jsx(t,{variant:"h6",sx:{mb:2,textAlign:"center"},children:"R√©partition Globale"}),f>0?e.jsx(xe,{options:L,series:H,type:"donut",height:300}):e.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:300},children:[e.jsx(_,{color:"action",sx:{fontSize:48,mb:2}}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucune donn√©e disponible"})]})]})})}),e.jsxs(r,{sx:{mt:3,p:3,bgcolor:"#fff3e0",borderRadius:2,border:"1px solid #ff9800"},children:[e.jsxs(t,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(ee,{sx:{mr:1,color:"#f57c00"}}),"R√©sum√© de l'analyse"]}),e.jsxs(t,{variant:"body1",sx:{lineHeight:1.6},children:["Sur la p√©riode du ",e.jsx("strong",{children:h(z)})," au ",e.jsx("strong",{children:h(y)})," :",e.jsx("br",{}),e.jsx("br",{}),"‚Ä¢ ",e.jsxs("strong",{children:[b," hommes des services centraux"]})," n'ont pas b√©n√©fici√© de formations.",e.jsx("br",{}),"‚Ä¢ Sur un total de ",e.jsxs("strong",{children:[f," hommes des services centraux"]}),",",e.jsxs("strong",{children:[" ",j," ont √©t√© form√©s"]})," et ",e.jsxs("strong",{children:[b," ne l'ont pas √©t√©"]}),".",e.jsx("br",{}),"‚Ä¢ ",e.jsx("strong",{children:"Taux de non-formation :"})," ",i(),"% des hommes des services centraux n'ont pas √©t√© form√©s.",e.jsx("br",{}),"‚Ä¢ ",e.jsx("strong",{children:"Taux de formation :"})," ",d(),"% des hommes des services centraux ont √©t√© form√©s.",parseFloat(i())>70&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),e.jsxs("span",{style:{color:"#f44336"},children:["‚ö†Ô∏è ",e.jsx("strong",{children:"Alerte :"})," Plus de 70% des hommes des services centraux n'ont pas √©t√© form√©s sur cette p√©riode. Il est recommand√© d'intensifier les efforts de formation."]})]}),parseFloat(i())>50&&parseFloat(i())<=70&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),e.jsxs("span",{style:{color:"#ff9800"},children:["üìä ",e.jsx("strong",{children:"Attention :"})," Plus de la moiti√© des hommes des services centraux (",i(),"%) n'ont pas √©t√© form√©s."]})]}),parseFloat(i())<=30&&f>0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),e.jsxs("span",{style:{color:"#4caf50"},children:["‚úÖ ",e.jsx("strong",{children:"Bon r√©sultat :"})," Moins de 30% des hommes des services centraux n'ont pas √©t√© form√©s. Les efforts de formation portent leurs fruits."]})]}),b===0&&f>0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),e.jsxs("span",{style:{color:"#4caf50"},children:["üéâ ",e.jsx("strong",{children:"Excellent :"})," Tous les hommes des services centraux ont √©t√© form√©s sur cette p√©riode !"]})]}),f===0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),e.jsx("span",{style:{color:"#f44336"},children:"‚ö†Ô∏è Aucun homme des services centraux n'a √©t√© identifi√© dans la base de donn√©es."})]})]})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:P,onClose:c,autoHideDuration:5e3,children:e.jsx(xs,{onClose:c,severity:O,iconMapping:{success:e.jsx(ne,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"}),warning:e.jsx(Ae,{fontSize:"inherit"})},sx:{boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:I})})})]})},hs=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),Le=me(Q)(({theme:n})=>({background:`linear-gradient(135deg, ${oe(n.palette.primary.main,.02)} 0%, ${oe(n.palette.primary.main,.05)} 100%)`,border:`1px solid ${oe(n.palette.primary.main,.1)}`,borderRadius:16,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{transform:"translateY(-2px)",boxShadow:`0 8px 25px ${oe(n.palette.primary.main,.15)}`}})),fs=me(Ge)(({theme:n})=>({background:"linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)",border:`1px solid ${oe(n.palette.divider,.12)}`,borderRadius:"12px !important",marginBottom:n.spacing(2),boxShadow:"0 2px 8px rgba(0,0,0,0.04)","&:hover":{boxShadow:"0 4px 16px rgba(0,0,0,0.08)"},"&.Mui-expanded":{boxShadow:`0 8px 24px ${oe(n.palette.primary.main,.12)}`},"&:before":{display:"none"}})),ms=me(Ve)(({theme:n})=>({background:`linear-gradient(135deg, ${oe(n.palette.primary.main,.03)} 0%, ${oe(n.palette.primary.main,.07)} 100%)`,borderRadius:"12px 12px 0 0",minHeight:72,"&.Mui-expanded":{minHeight:72,borderRadius:"12px 12px 0 0"},"&:hover":{background:`linear-gradient(135deg, ${oe(n.palette.primary.main,.08)} 0%, ${oe(n.palette.primary.main,.12)} 100%)`},"& .MuiAccordionSummary-content":{margin:"12px 0","&.Mui-expanded":{margin:"12px 0"}}})),gs=me(zt)(({theme:n})=>({width:48,height:48,background:`linear-gradient(135deg, ${n.palette.primary.main}, ${n.palette.primary.dark})`,fontSize:"1.2rem",fontWeight:"bold"})),bs=me(V)(({theme:n})=>({background:`linear-gradient(135deg, ${oe(n.palette.secondary.main,.1)} 0%, ${oe(n.palette.secondary.main,.2)} 100%)`,border:`1px solid ${oe(n.palette.secondary.main,.3)}`,color:n.palette.secondary.dark,fontWeight:600,"&:hover":{background:`linear-gradient(135deg, ${oe(n.palette.secondary.main,.2)} 0%, ${oe(n.palette.secondary.main,.3)} 100%)`}})),ps=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(!1),[y,N]=o.useState([]),[T,w]=o.useState(!1),[b,C]=o.useState(""),[f,R]=o.useState("success"),[j,k]=o.useState(null),P="";o.useEffect(()=>{(async()=>{if(n&&n.results){N(n.results),k(n.structureInfo),I(`${n.results.length} formations trouv√©es`,"success");return}if(l&&s){const d=s["selectedStructure.IDSTRUCTURE"];if(!d){I("Structure non sp√©cifi√©e pour ex√©cuter la requ√™te","error");return}$(!0);try{const S=l.replace(/= \d+/,`= ${d}`),A=localStorage.getItem("token"),g=await Z.post(`${P}/personnaliserrequette`,{query:S},{headers:{Authorization:`Bearer ${A}`}});g.data&&Array.isArray(g.data)?(N(g.data),E(d),I(`${g.data.length} formations trouv√©es`,"success")):(N([]),I("Aucune formation trouv√©e pour cette structure","info"))}catch(S){const A=S.response?.data?.message||"Erreur lors de l'ex√©cution de la requ√™te.";I(A,"error")}finally{$(!1)}}})()},[n,l,s,P]);const E=async i=>{try{const d=localStorage.getItem("token"),S=await Z.get(`${P}/structure/${i}`,{headers:{Authorization:`Bearer ${d}`}});S.data&&k(S.data)}catch(d){console.error("Erreur lors de la r√©cup√©ration des informations de la structure:",d),I("Erreur lors du chargement des informations de la structure","error")}},I=(i,d)=>{C(i),R(d),w(!0)},M=()=>{w(!1)},O=i=>i?new Date(i).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",v=()=>B||"Formations Individuelles par Personnel",u=y.reduce((i,d)=>{const S=`${d.MATRICULE}_${d.NOM}_${d.PRENOM}`;return i[S]||(i[S]={personnel:{MATRICULE:d.MATRICULE,NOM:d.NOM,PRENOM:d.PRENOM,NOMMARI:d.NOMMARI,FONCTION:d.FONCTION,TELEPHONE:d.TELEPHONE,GRADE:d.GRADE,Structure:d.Structure},formations:[]}),i[S].formations.push({Formation:d.Formation,DateFormation:d.DateFormation,LIEU:d.LIEU,CIBLES:d.CIBLES}),i},{}),m=y.length,x=Object.keys(u).length,c=x>0?(m/x).toFixed(1):0,h=(i,d)=>`${i?.charAt(0)||""}${d?.charAt(0)||""}`.toUpperCase();return z?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1200,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:400},children:[e.jsx(q,{size:60,color:"primary",sx:{mb:3}}),e.jsxs(t,{variant:"h6",color:"text.secondary",textAlign:"center",children:["Chargement des formations du personnel...",e.jsx(r,{component:"p",fontSize:"body2.fontSize",mt:1,children:"Veuillez patienter pendant la r√©cup√©ration des donn√©es"})]})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1200,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:4},children:[e.jsx(r,{sx:{p:2,borderRadius:3,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",mr:3,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(qe,{sx:{fontSize:36,color:"white"}})}),e.jsxs(r,{children:[e.jsx(t,{variant:"h4",fontWeight:"bold",color:"primary",sx:{mb:1},children:v()}),e.jsx(t,{variant:"h6",color:"text.secondary",fontWeight:"medium",children:j?.NOMSTRUCTURE||"Structure s√©lectionn√©e"})]})]}),e.jsx(J,{sx:{my:4}}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,sm:4,children:e.jsx(Le,{children:e.jsxs(K,{sx:{textAlign:"center",py:3},children:[e.jsx(ve,{sx:{fontSize:48,color:"primary.main",mb:2}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"primary.main",children:x}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Personnels"})]})})}),e.jsx(W,{item:!0,xs:12,sm:4,children:e.jsx(Le,{children:e.jsxs(K,{sx:{textAlign:"center",py:3},children:[e.jsx(he,{sx:{fontSize:48,color:"secondary.main",mb:2}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"secondary.main",children:m}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Formations"})]})})}),e.jsx(W,{item:!0,xs:12,sm:4,children:e.jsx(Le,{children:e.jsxs(K,{sx:{textAlign:"center",py:3},children:[e.jsx(xt,{sx:{fontSize:48,color:"success.main",mb:2}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"success.main",children:c}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Moyenne/personnel"})]})})})]}),e.jsxs(r,{children:[e.jsxs(t,{variant:"h5",sx:{mb:3,display:"flex",alignItems:"center",fontWeight:"bold"},children:[e.jsx(je,{sx:{mr:2,fontSize:32,color:"primary.main"}}),"Personnel et leurs formations"]}),Object.keys(u).length>0?Object.entries(u).map(([i,d],S)=>e.jsxs(fs,{children:[e.jsx(ms,{expandIcon:e.jsx(Je,{sx:{color:"primary.main"}}),children:e.jsxs(r,{sx:{display:"flex",alignItems:"center",width:"100%",py:1},children:[e.jsx(gs,{sx:{mr:3},children:h(d.personnel.NOM,d.personnel.PRENOM)}),e.jsxs(r,{sx:{flexGrow:1},children:[e.jsxs(t,{variant:"h6",fontWeight:"bold",color:"primary.dark",children:[d.personnel.NOM," ",d.personnel.PRENOM]}),e.jsxs(t,{variant:"body1",color:"text.secondary",sx:{mb:.5},children:[d.personnel.MATRICULE," ‚Ä¢ ",d.personnel.FONCTION]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:d.personnel.Structure})]}),e.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:1},children:[e.jsx(bs,{label:`${d.formations.length} formations`,size:"medium",icon:e.jsx(he,{fontSize:"small"})}),e.jsx(V,{label:d.personnel.GRADE||"Grade N/A",size:"small",variant:"outlined",color:"default"})]})]})}),e.jsxs(Xe,{sx:{pt:3,pb:3},children:[e.jsxs(r,{sx:{p:3,mb:3,bgcolor:"grey.50",borderRadius:2,border:"1px solid",borderColor:"grey.200"},children:[e.jsxs(t,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(We,{sx:{mr:1,color:"primary.main"}}),"Informations personnelles"]}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(ge,{sx:{mr:2,fontSize:20,color:"text.secondary"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",color:"text.secondary",children:"Matricule"}),e.jsx(t,{variant:"body1",fontWeight:"medium",children:d.personnel.MATRICULE})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(fe,{sx:{mr:2,fontSize:20,color:"text.secondary"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",color:"text.secondary",children:"Fonction"}),e.jsx(t,{variant:"body1",fontWeight:"medium",children:d.personnel.FONCTION||"-"})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(ke,{sx:{mr:2,fontSize:20,color:"text.secondary"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",color:"text.secondary",children:"T√©l√©phone"}),e.jsx(t,{variant:"body1",fontWeight:"medium",children:d.personnel.TELEPHONE||"-"})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(fe,{sx:{mr:2,fontSize:20,color:"text.secondary"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",color:"text.secondary",children:"Grade"}),e.jsx(t,{variant:"body1",fontWeight:"medium",children:d.personnel.GRADE||"-"})]})]})})]})]}),e.jsxs(t,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(he,{sx:{mr:1,color:"secondary.main"}}),"Formations suivies (",d.formations.length,")"]}),e.jsx(ae,{sx:{border:"1px solid #e0e0e0",borderRadius:2,boxShadow:"0 2px 8px rgba(0,0,0,0.06)"},children:e.jsxs(le,{children:[e.jsx(ce,{children:e.jsxs(G,{sx:{background:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)"},children:[e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",py:2},children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(he,{sx:{mr:1,fontSize:18}}),"Formation"]})}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",py:2},children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(be,{sx:{mr:1,fontSize:18}}),"Date"]})}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",py:2},children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(et,{sx:{mr:1,fontSize:18}}),"Lieu"]})}),e.jsx(a,{sx:{fontWeight:"bold",fontSize:"0.95rem",py:2},children:e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(je,{sx:{mr:1,fontSize:18}}),"Cibles"]})})]})}),e.jsx(de,{children:d.formations.map((A,g)=>e.jsxs(G,{hover:!0,sx:{"&:hover":{bgcolor:oe("#667eea",.04)},"&:nth-of-type(odd)":{bgcolor:"rgba(0,0,0,0.02)"}},children:[e.jsx(a,{sx:{py:2},children:e.jsx(t,{variant:"body2",fontWeight:"600",color:"primary.dark",children:A.Formation?A.Formation.toUpperCase():"-"})}),e.jsx(a,{sx:{py:2},children:e.jsx(t,{variant:"body2",children:O(A.DateFormation)})}),e.jsx(a,{sx:{py:2},children:e.jsx(t,{variant:"body2",children:A.LIEU||"-"})}),e.jsx(a,{sx:{py:2},children:e.jsx(t,{variant:"body2",children:A.CIBLES||"-"})})]},g))})]})})]})]},i)):e.jsxs(Y,{sx:{textAlign:"center",py:8,background:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)",border:"2px dashed #dee2e6",borderRadius:3},children:[e.jsx(_,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(t,{variant:"h5",color:"text.secondary",fontWeight:"medium",sx:{mb:1},children:"Aucune formation trouv√©e"}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Aucune formation n'a √©t√© trouv√©e pour les personnels de cette structure"})]})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:T,onClose:M,autoHideDuration:5e3,children:e.jsx(hs,{onClose:M,severity:f,iconMapping:{success:e.jsx(ve,{fontSize:"inherit"}),error:e.jsx(_,{fontSize:"inherit"}),info:e.jsx(ee,{fontSize:"inherit"})},sx:{boxShadow:"0px 8px 24px rgba(0, 0, 0, 0.12)",borderRadius:2,minWidth:350,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:600,children:b})})})]})},js=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),it=me(Q)(({theme:n})=>({background:`linear-gradient(135deg, ${oe(n.palette.primary.main,.02)} 0%, ${oe(n.palette.primary.main,.05)} 100%)`,border:`1px solid ${oe(n.palette.primary.main,.1)}`,borderRadius:20,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",overflow:"hidden",position:"relative","&:hover":{transform:"translateY(-4px)",boxShadow:`0 12px 32px ${oe(n.palette.primary.main,.15)}`},"&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:"4px",background:`linear-gradient(90deg, ${n.palette.primary.main}, ${n.palette.secondary.main})`}})),we=me(Q)(({theme:n,color:l})=>({background:`linear-gradient(135deg, ${oe(n.palette[l].main,.08)} 0%, ${oe(n.palette[l].main,.12)} 100%)`,border:`2px solid ${oe(n.palette[l].main,.2)}`,borderRadius:16,height:"100%",transition:"all 0.3s ease",position:"relative",overflow:"hidden","&:hover":{transform:"scale(1.02)",boxShadow:`0 8px 24px ${oe(n.palette[l].main,.25)}`},"&::before":{content:'""',position:"absolute",top:"-2px",left:"-2px",right:"-2px",bottom:"-2px",background:`linear-gradient(135deg, ${n.palette[l].main}, ${n.palette[l].dark})`,borderRadius:16,zIndex:-1}})),Ss=me(r)(({theme:n})=>({background:`linear-gradient(135deg, ${oe("#667eea",.05)} 0%, ${oe("#764ba2",.05)} 100%)`,borderRadius:20,padding:n.spacing(3),border:`1px solid ${oe("#667eea",.1)}`,position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,background:`radial-gradient(circle at 20% 20%, ${oe("#667eea",.1)} 0%, transparent 50%)`,pointerEvents:"none"}})),ys=({queryData:n=null,sqlQuery:l=null,params:s=null,text:B=null})=>{const[z,$]=o.useState(!1),[y,N]=o.useState(!1),[T,w]=o.useState(""),[b,C]=o.useState("success"),[f,R]=o.useState(null),[j,k]=o.useState(0),[P,E]=o.useState(null),[I,M]=o.useState({totalFormations:0,executedFormations:0,pendingFormations:0}),O="";o.useEffect(()=>{(async()=>{if(n&&n.results){v(n.results,n.year);return}if(l&&s){const{annee:A}=s;if(!A){x("Ann√©e non sp√©cifi√©e pour calculer le taux","error");return}$(!0);try{const g=l.replace(/\$\{annee\}/g,A),L=localStorage.getItem("token"),H=await Z.post(`${O}/personnaliserrequette`,{query:g},{headers:{Authorization:`Bearer ${L}`}});H.data&&Array.isArray(H.data)&&H.data.length>0?(v(H.data,A),x(`Taux d'ex√©cution calcul√© pour ${A}`,"success")):(x("Aucune donn√©e trouv√©e pour cette ann√©e","info"),k(0),m(0,A))}catch(g){const L=g.response?.data?.message||"Erreur lors du calcul du taux.";x(L,"error")}finally{$(!1)}}!n&&!l&&!s&&await u()})()},[n,l,s,O]);const v=(S,A)=>{if(S&&S.length>0){const g=S[0],L=Math.round(parseFloat(g.TauxMiseEnOeuvre)||0);k(L),E(A),m(L,A),u(A)}},u=async(S=null)=>{if(S)try{const A=localStorage.getItem("token"),g=`
        SELECT 
          COUNT(*) AS total,
          SUM(
            CASE 
              WHEN DATE IS NOT NULL AND TRIM(DATE) <> '' AND YEAR(DATE) = '${S}'
              THEN 1 
              ELSE 0 
            END
          ) AS executed
        FROM formationmodifiable
        WHERE '${S}' IN (ANNEE1, ANNEE2, ANNEE3)
      `,L=await Z.post(`${O}/personnaliserrequette`,{query:g},{headers:{Authorization:`Bearer ${A}`}});if(L.data&&L.data.length>0){const H=L.data[0],p=H.total||0,D=H.executed||0,U=p-D;M({totalFormations:p,executedFormations:D,pendingFormations:U})}}catch(A){console.error("Erreur lors de la r√©cup√©ration des statistiques:",A)}},m=(S,A)=>{const g=p=>p>=90?["#4CAF50","#66BB6A"]:p>=70?["#2196F3","#42A5F5"]:p>=50?["#FF9800","#FFA726"]:["#F44336","#EF5350"],[L,H]=g(S);R({series:[S],options:{chart:{type:"radialBar",height:400,toolbar:{show:!1},background:"transparent",animations:{enabled:!0,easing:"easeinout",speed:1200,animateGradually:{enabled:!0,delay:300},dynamicAnimation:{enabled:!0,speed:400}}},plotOptions:{radialBar:{startAngle:-135,endAngle:135,hollow:{size:"65%",background:"transparent",margin:15},track:{background:"#f0f0f0",strokeWidth:"100%",margin:10,dropShadow:{enabled:!1}},dataLabels:{name:{show:!0,fontSize:"18px",fontWeight:600,color:"#333",offsetY:120,formatter:()=>`Ann√©e ${A||new Date().getFullYear()}`},value:{offsetY:10,fontSize:"56px",fontWeight:"bold",color:L,formatter:function(p){return p+"%"}},total:{show:!0,label:"Taux d'ex√©cution",fontSize:"16px",fontWeight:500,color:"#666",offsetY:-10}}}},fill:{type:"gradient",gradient:{shade:"light",type:"horizontal",shadeIntensity:.5,gradientToColors:[H],inverseColors:!1,opacityFrom:1,opacityTo:.8,stops:[0,100]}},stroke:{lineCap:"round",dashArray:0},colors:[L],labels:["Taux d'ex√©cution"],responsive:[{breakpoint:600,options:{chart:{height:300},plotOptions:{radialBar:{dataLabels:{value:{fontSize:"40px"},name:{fontSize:"14px"}}}}}}]}})},x=(S,A)=>{w(S),C(A),N(!0)},c=()=>{N(!1)},h=()=>j>=90?{color:"success",label:"Excellent",icon:Ot}:j>=70?{color:"primary",label:"Satisfaisant",icon:Re}:j>=50?{color:"warning",label:"Moyen",icon:Pt}:{color:"error",label:"Insuffisant",icon:_e},i=()=>B||"Taux d'Ex√©cution des Formations",d=h();return z?e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1200,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:400},children:[e.jsx(q,{size:60,color:"primary",sx:{mb:3}}),e.jsxs(t,{variant:"h6",color:"text.secondary",textAlign:"center",children:["Calcul du taux d'ex√©cution en cours...",e.jsxs(r,{component:"p",fontSize:"body2.fontSize",mt:1,children:["Analyse des donn√©es de formation pour l'ann√©e ",s?.annee]})]})]}):e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1200,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:4},children:[e.jsx(r,{sx:{p:2,borderRadius:3,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",mr:3,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(er,{sx:{fontSize:36,color:"white"}})}),e.jsxs(r,{sx:{flexGrow:1},children:[e.jsx(t,{variant:"h4",fontWeight:"bold",color:"primary",sx:{mb:1},children:i()}),e.jsx(t,{variant:"h6",color:"text.secondary",fontWeight:"medium",children:P?`Ann√©e ${P}`:"Analyse de performance"})]}),P&&e.jsx(V,{label:`${P}`,color:"primary",variant:"outlined",size:"large",sx:{fontSize:"1.1rem",fontWeight:"bold",px:2,py:1,height:40}})]}),e.jsx(J,{sx:{my:4}}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(we,{color:"primary",children:e.jsxs(K,{sx:{textAlign:"center",py:3},children:[e.jsx($t,{sx:{fontSize:48,color:"primary.main",mb:2}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"primary.main",children:I.totalFormations}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"Total pr√©vu"})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(we,{color:"success",children:e.jsxs(K,{sx:{textAlign:"center",py:3},children:[e.jsx(ut,{sx:{fontSize:48,color:"success.main",mb:2}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"success.main",children:I.executedFormations}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"R√©alis√©es"})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(we,{color:"warning",children:e.jsxs(K,{sx:{textAlign:"center",py:3},children:[e.jsx(_e,{sx:{fontSize:48,color:"warning.main",mb:2}}),e.jsx(t,{variant:"h3",fontWeight:"bold",color:"warning.main",children:I.pendingFormations}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:"En attente"})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(we,{color:d.color,children:e.jsxs(K,{sx:{textAlign:"center",py:3},children:[e.jsx(d.icon,{sx:{fontSize:48,color:`${d.color}.main`,mb:2}}),e.jsxs(t,{variant:"h3",fontWeight:"bold",color:`${d.color}.main`,children:[j,"%"]}),e.jsx(t,{variant:"body1",color:"text.secondary",fontWeight:"medium",children:d.label})]})})})]}),e.jsx(it,{sx:{mb:4},children:e.jsxs(K,{sx:{p:0},children:[e.jsx(r,{sx:{p:3,pb:1},children:e.jsx(t,{variant:"body1",fontWeight:"bold",color:"text.secondary",textAlign:"center",children:"Pourcentage de r√©alisation des formations pr√©vues"})}),e.jsx(Ss,{children:f?e.jsx(r,{sx:{position:"relative",zIndex:1},children:e.jsx(xe,{options:f.options,series:f.series,type:"radialBar",height:400,width:"100%"})}):e.jsxs(r,{sx:{height:400,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[e.jsx(ee,{sx:{fontSize:80,color:"text.secondary",mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Aucune donn√©e √† afficher"})]})})]})}),j>0&&e.jsx(it,{children:e.jsxs(K,{sx:{p:3},children:[e.jsx(t,{variant:"h6",fontWeight:"bold",sx:{mb:2,textAlign:"center"},children:"üìä R√©sum√© de Performance"}),e.jsxs(W,{container:!0,spacing:3,alignItems:"center",children:[e.jsxs(W,{item:!0,xs:12,md:8,children:[e.jsxs(t,{variant:"body1",sx:{mb:1,fontSize:"1.1rem"},children:[e.jsx("strong",{children:I.executedFormations})," formations r√©alis√©es sur"," ",e.jsx("strong",{children:I.totalFormations})," formations pr√©vues"]}),e.jsx(t,{variant:"body1",color:"text.secondary",children:j>=100?"üéâ F√©licitations ! Toutes les formations pr√©vues ont √©t√© r√©alis√©es avec succ√®s.":`${I.pendingFormations} formations ${I.pendingFormations>1?"restent":"reste"} √† r√©aliser pour atteindre l'objectif.`})]}),e.jsx(W,{item:!0,xs:12,md:4,sx:{textAlign:"center",color:"red"},children:e.jsx(V,{label:`${d.label}: ${j}%`,variant:"outlined",icon:e.jsx(d.icon,{}),sx:{fontSize:"1.1rem",fontWeight:"bold",px:2,py:2,height:"auto",color:"red","& .MuiChip-icon":{color:"red"}}})})]})]})}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:y,onClose:c,autoHideDuration:5e3,children:e.jsx(js,{onClose:c,severity:b,sx:{boxShadow:"0px 8px 24px rgba(0, 0, 0, 0.12)",borderRadius:2,minWidth:350,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:600,children:T})})})]})},vs=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,...l})}),As=me(Te)(({theme:n})=>({marginTop:n.spacing(2),background:"linear-gradient(to top, rgba(173, 216, 230, 0.47), rgba(173, 216, 230, 0))",color:"blue",border:"2px solid blue",borderRadius:"20px",fontSize:"1.2rem",padding:n.spacing(1.5,4),boxShadow:"inset 0 2px 5px rgba(173, 216, 230, 0.6)",transition:"background-color 0.3s, transform 0.3s",height:"6px",width:"25vw",marginBottom:"20px",textTransform:"none","&:hover":{background:"linear-gradient(to top, rgba(173, 216, 230, 0.7), rgba(173, 216, 230, 0))",transform:"translateY(-2px)"}})),Fs=()=>{const[n,l]=o.useState(""),[s,B]=o.useState([]),[z,$]=o.useState(!1),[y,N]=o.useState(!1),[T,w]=o.useState(""),[b,C]=o.useState("success"),[f,R]=o.useState(!0),[j,k]=o.useState(null),[P,E]=o.useState(!1),[I,M]=o.useState(0),[O,v]=o.useState(0),[u,m]=o.useState(0),[x,c]=o.useState(0),[h,i]=o.useState("");o.useEffect(()=>{(async()=>{const D=localStorage.getItem("token"),U="";try{const X=await Z.post(`${U}/personnaliserrequette`,{query:`SELECT IDPLAN, ANNEE1, ANNEE2, ANNEE3 
                    FROM plantrienal 
                    ORDER BY ANNEE1 DESC`},{headers:{Authorization:`Bearer ${D}`}});X.data&&(B(X.data),X.data.length>0&&l(X.data[0].IDPLAN))}catch{A("Erreur lors de la r√©cup√©ration des plans triennaux","error")}finally{R(!1)}})()},[]);const d=async()=>{if(!n){A("Veuillez s√©lectionner un plan","error");return}$(!0),k(null);const p=localStorage.getItem("token"),D="";try{const U=`
        SELECT 
          COUNT(*) AS total,
          SUM(CASE WHEN DATE IS NOT NULL AND TRIM(DATE) <> '' THEN 1 ELSE 0 END) AS executed
        FROM formationmodifiable
        WHERE IDPLAN = ${n}
      `,X=await Z.post(`${D}/personnaliserrequette`,{query:U},{headers:{Authorization:`Bearer ${p}`}});if(X.data&&X.data.length>0){const ie=X.data[0],Se=ie.total||0,Ne=ie.executed||0,St=Se-Ne,tt=Se>0?Math.round(Ne/Se*100):0;M(Se),v(Ne),c(St),m(tt);const Me=s.find(yt=>yt.IDPLAN==n);Me&&i(`${Me.ANNEE1}-${Me.ANNEE2}-${Me.ANNEE3}`),S(tt,Se,Ne),E(!0),A("Taux d'ex√©cution calcul√© pour le plan triennal","success")}else throw new Error("Aucune donn√©e retourn√©e")}catch(U){A(U.response?.data?.message||"Erreur lors du calcul du taux","error")}finally{$(!1)}},S=(p,D,U)=>{const X=ie=>ie>=90?"#66BB6A":ie>=70?"#42A5F5":ie>=50?"#FFA726":"#EF5350";k({series:[p],options:{chart:{type:"radialBar",height:350,toolbar:{show:!1},background:"transparent"},plotOptions:{radialBar:{startAngle:-90,endAngle:90,hollow:{size:"70%",background:"transparent",margin:0,image:void 0},track:{background:"#f0f0f0",strokeWidth:"100%",margin:0},dataLabels:{name:{show:!1},value:{offsetY:0,fontSize:"48px",fontWeight:700,color:"#333",formatter:function(ie){return ie+"%"}},total:{show:!0,label:"Taux d'ex√©cution",fontSize:"18px",fontWeight:600,color:"#555",formatter:function(){return""}}}}},fill:{type:"gradient",gradient:{shade:"light",type:"horizontal",gradientToColors:[X(p)],stops:[0,100]}},stroke:{lineCap:"round"},colors:[X(p)],labels:["Taux d'ex√©cution"]}})},A=(p,D)=>{w(p),C(D),N(!0)},g=()=>{N(!1)},L=()=>{E(!1)},H=()=>u>=90?"success":u>=70?"primary":u>=50?"warning":"error";return e.jsxs(Y,{elevation:0,sx:{p:4,maxWidth:1e3,mx:"auto",borderRadius:3,bgcolor:"background.paper",boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.05)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(nt,{color:"primary",sx:{fontSize:36,mr:2}}),e.jsxs(r,{children:[e.jsxs(t,{variant:"h5",fontWeight:"bold",color:"primary",children:["Taux d'Ex√©cution des Plans Triennaux ",e.jsx("br",{}),"Veuillez confirmer le triennat puis validez"]}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"√âvaluez le taux de r√©alisation global d'un plan triennal complet"})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(W,{container:!0,spacing:3,alignItems:"center",justifyContent:"center",children:[e.jsx(W,{item:!0,xs:12,md:8,children:e.jsxs(Lt,{fullWidth:!0,variant:"outlined",children:[e.jsx(Ht,{id:"plan-select-label",children:"Plan triennal"}),e.jsx(Yt,{labelId:"plan-select-label",value:n,onChange:p=>l(p.target.value),label:"Plan triennal",disabled:f,sx:{bgcolor:"#f9f9f9"},children:f?e.jsxs(Pe,{disabled:!0,children:[e.jsx(q,{size:20}),e.jsx(t,{variant:"body2",sx:{ml:2},children:"Chargement des plans..."})]}):s.length>0?s.map(p=>e.jsxs(Pe,{value:p.IDPLAN,children:["Plan ",p.ANNEE1,"-",p.ANNEE2,"-",p.ANNEE3]},p.IDPLAN)):e.jsx(Pe,{disabled:!0,children:"Aucun plan disponible"})})]})}),e.jsx(W,{item:!0,xs:12,md:4,sx:{display:"flex",justifyContent:"center"},children:e.jsx(As,{onClick:d,startIcon:z?e.jsx(q,{size:20,color:"inherit"}):e.jsx(Bt,{}),disabled:z||f||!n,children:z?"Calcul en cours...":"Valider"})})]}),e.jsxs(ht,{open:P,onClose:L,fullWidth:!0,maxWidth:"sm",PaperProps:{sx:{borderRadius:3,overflow:"hidden",bgcolor:"#fafafa"}},children:[e.jsxs(mt,{sx:{bgcolor:"#e3f2fd",color:"#1565c0",display:"flex",justifyContent:"space-between",alignItems:"center",py:2,borderBottom:"1px solid #bbdefb"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(nt,{sx:{mr:1.5,fontSize:28}}),e.jsx(t,{variant:"h6",fontWeight:"bold",children:"√âvaluation du Plan Triennal"})]}),e.jsx(dt,{onClick:L,sx:{color:"#1565c0"},children:e.jsx(gt,{})})]}),e.jsx(ft,{sx:{p:0},children:j&&e.jsxs(r,{sx:{mt:3,textAlign:"center"},children:[e.jsxs(r,{sx:{p:2,bgcolor:"#f5f7ff",borderBottom:"1px solid #e0e0e0"},children:[e.jsxs(t,{variant:"h6",fontWeight:"bold",color:"primary",children:["Plan ",h]}),e.jsx(t,{variant:"body2",color:"textSecondary",children:"Taux d'ex√©cution global sur 3 ans"})]}),e.jsxs(r,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mb:3,flexWrap:"wrap",p:2},children:[e.jsx(V,{label:`Total: ${I}`,color:"info",variant:"outlined",sx:{fontSize:"1rem",fontWeight:600,p:1.5,m:.5,bgcolor:"white"}}),e.jsx(V,{icon:e.jsx(ut,{}),label:`R√©alis√©es: ${O}`,color:"success",variant:"outlined",sx:{fontSize:"1rem",fontWeight:600,p:1.5,m:.5,bgcolor:"white"}}),e.jsx(V,{icon:e.jsx(_e,{}),label:`En attente: ${x}`,color:"warning",variant:"outlined",sx:{fontSize:"1rem",fontWeight:600,p:1.5,m:.5,bgcolor:"white"}})]}),e.jsx(r,{sx:{position:"relative",height:"180px",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(xe,{options:j.options,series:j.series,type:"radialBar",height:300,width:"100%"})}),e.jsxs(r,{sx:{mt:1,p:3,bgcolor:"white",borderRadius:2,textAlign:"center"},children:[e.jsx(V,{label:`Taux d'ex√©cution: ${u}%`,color:H(),variant:"filled",sx:{fontSize:"1.2rem",fontWeight:700,p:2,mb:2,color:"white"}}),e.jsxs(t,{variant:"body1",paragraph:!0,children:[e.jsx("strong",{children:O})," formations r√©alis√©es sur ",e.jsx("strong",{children:I})," pr√©vues"]}),e.jsx(t,{variant:"body2",color:"textSecondary",children:u>=100?"Toutes les formations du plan ont √©t√© r√©alis√©es !":`${x} formations restantes √† r√©aliser`})]})]})}),e.jsx(bt,{sx:{p:2,bgcolor:"#f5f5f5"},children:e.jsx(Te,{onClick:L,variant:"outlined",color:"primary",sx:{borderRadius:2,px:4,py:1},children:"Fermer"})})]}),e.jsx(re,{anchorOrigin:{vertical:"top",horizontal:"right"},open:y,onClose:g,autoHideDuration:5e3,children:e.jsx(vs,{onClose:g,severity:b,sx:{boxShadow:"0px 4px 12px rgba(0, 0, 0, 0.05)",borderRadius:2,minWidth:300,bgcolor:"background.paper"},children:e.jsx(t,{fontWeight:500,children:T})})})]})},Is=te.forwardRef(function(l,s){return e.jsx(se,{elevation:6,ref:s,variant:"filled",...l})}),zs=me(Q)(({theme:n})=>({background:"linear-gradient(135deg, #eaedf1ff 0%, #c6daedff 100%)",color:"#024091ff",borderRadius:20,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)",transition:"transform 0.3s ease, box-shadow 0.3s ease","&:hover":{transform:"translateY(-5px)",boxShadow:"0 12px 40px rgba(0, 0, 0, 0.2)"}})),Ye=me(Te)(({theme:n})=>({borderRadius:25,backgroundColor:"linear-gradient(45deg, #1976D2 30%, #1CB5E0 90%",textTransform:"none",fontWeight:600,padding:n.spacing(1.5,3),boxShadow:"0 4px 15px rgba(0, 0, 0, 0.1)",transition:"all 0.3s ease","&:hover":{transform:"translateY(-2px)",boxShadow:"0 6px 20px rgba(0, 0, 0, 0.15)"}})),ks=me(Te)(({theme:n})=>({background:"linear-gradient(45deg, #2196F3 30%, #21CBF3 90%)",color:"white",borderRadius:20,padding:n.spacing(1.5,3),boxShadow:"0 4px 15px rgba(33, 150, 243, 0.3)",fontWeight:600,textTransform:"none",transition:"all 0.3s ease","&:hover":{background:"linear-gradient(45deg, #1976D2 30%, #1CB5E0 90%)",transform:"translateY(-2px)",boxShadow:"0 6px 20px rgba(33, 150, 243, 0.4)"}})),Ws=me(ht)(({theme:n})=>({"& .MuiDialog-paper":{borderRadius:20,boxShadow:"0 10px 40px rgba(0, 0, 0, 0.1)"}})),He=me(Te)(({theme:n,active:l})=>({borderRadius:50,textTransform:"none",fontWeight:l?700:500,fontSize:"0.95rem",color:l?"#fff":"#555",backgroundColor:l?"#667eea":"#fff",border:l?"none":"1px solid #e0e0e0",padding:n.spacing(1,2.5),margin:n.spacing(.5),transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:l?"0 4px 12px rgba(102, 126, 234, 0.3)":"0 1px 4px rgba(0, 0, 0, 0.05)","&:hover":{backgroundColor:l?"#5a6fd8":"#f5f7fb",borderColor:"#ccc",transform:"translateY(-1px)",boxShadow:l?"0 6px 16px rgba(102, 126, 234, 0.35)":"0 3px 8px rgba(0, 0, 0, 0.08)"}})),Rs=({title:n,value:l,icon:s,borderColor:B,textColor:z})=>e.jsx(Q,{sx:{borderRadius:3,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.05)",border:`1px solid ${B}`,transition:"all 0.3s ease","&:hover":{transform:"translateY(-3px)",boxShadow:"0 8px 25px rgba(0, 0, 0, 0.1)"}},children:e.jsxs(K,{sx:{textAlign:"center",py:3},children:[e.jsx(r,{sx:{bgcolor:B.replace("0.1","0.1"),borderRadius:2,p:2,mb:2,display:"inline-block"},children:s}),e.jsx(t,{variant:"h4",fontWeight:"bold",color:z,children:l}),e.jsx(t,{variant:"body2",color:"text.secondary",children:n})]})}),at=[e.jsx(pt,{sx:{fontSize:30,color:"primary.main"}}),e.jsx(qe,{sx:{fontSize:30,color:"primary.main"}}),e.jsx(Ke,{sx:{fontSize:30,color:"primary.main"}}),e.jsx(Ut,{sx:{fontSize:30,color:"primary.main"}}),e.jsx(_t,{sx:{fontSize:30,color:"primary.main"}}),e.jsx(Gt,{sx:{fontSize:30,color:"primary.main"}}),e.jsx(Vt,{sx:{fontSize:30,color:"primary.main"}}),e.jsx(Ze,{sx:{fontSize:30,color:"primary.main"}}),e.jsx(ve,{sx:{fontSize:30,color:"primary.main"}}),e.jsx(fe,{sx:{fontSize:30,color:"primary.main"}})],Es={primary:{border:"rgba(33, 150, 243, 0.1)",text:"primary.main"},success:{border:"rgba(76, 175, 80, 0.1)",text:"success.main"},warning:{border:"rgba(255, 152, 0, 0.1)",text:"warning.main"},secondary:{border:"rgba(156, 39, 176, 0.1)",text:"secondary.main"},info:{border:"rgba(3, 169, 244, 0.1)",text:"info.main"},error:{border:"rgba(244, 67, 54, 0.1)",text:"error.main"}},lt=Object.values(Es),Cs=()=>{const[n,l]=o.useState([]),[s,B]=o.useState([]),[z,$]=o.useState(!1),[y,N]=o.useState(!1),[T,w]=o.useState(null),[b,C]=o.useState(""),[f,R]=o.useState(!1),[j,k]=o.useState(""),[P,E]=o.useState("success"),[I,M]=o.useState(!1),[O,v]=o.useState(""),u="";o.useEffect(()=>{m()},[]);const m=async()=>{$(!0);const p=localStorage.getItem("token");try{const X=(await Z.post(`${u}/personnaliserrequette`,{query:`
        SELECT 
          p.IDPERSONNEL,
          p.MATRICULE,
          p.NOM,
          p.PRENOM,
          p.FONCTION,
          p.TELEPHONE,
          p.GRADE,
          p.SEXE,
          p.STRUCTUREAUTRE,
          s.NOMSTRUCTURE as Structure,
          s.ABBREVIATION as StructureAbbreviation,
          COUNT(DISTINCT fm.IDFORMATIONM) as NombreFormations
        FROM 
          personel p
        JOIN 
          structure s ON p.IDSTRUCTURE = s.IDSTRUCTURE
        LEFT JOIN 
          suivre sv ON p.IDPERSONNEL = sv.IDPERSONNEL
        LEFT JOIN 
          formationmodifiable fm ON sv.IDFORMATIONM = fm.IDFORMATIONM
        WHERE 
          s.NOMSTRUCTURE LIKE 'AUTRE%'
        GROUP BY 
          p.IDPERSONNEL, p.MATRICULE, p.NOM, p.PRENOM, p.FONCTION, 
          p.TELEPHONE, p.GRADE, p.SEXE, p.STRUCTUREAUTRE, s.NOMSTRUCTURE, s.ABBREVIATION
        HAVING 
          COUNT(DISTINCT fm.IDFORMATIONM) > 0
        ORDER BY 
          p.NOM, p.PRENOM;
      `},{headers:{Authorization:`Bearer ${p}`}})).data||[];l(X),B(X),S(`${X.length} personnel(s) trouv√©(s)`,"success")}catch(D){S("Erreur lors du chargement du personnel","error"),console.error("Erreur:",D)}finally{$(!1)}},c=[...new Set(n.map(D=>D.STRUCTUREAUTRE).filter(D=>D&&D.trim()!==""))].sort(),h=p=>{w(p),C(""),N(!0)},i=()=>{const p={};return n.forEach(D=>{const U=D.STRUCTUREAUTRE&&D.STRUCTUREAUTRE.trim()!==""?D.STRUCTUREAUTRE:"Non d√©finie";p[U]=(p[U]||0)+1}),p},d=async()=>{if(!b.trim()){S("Veuillez saisir une structure","warning");return}M(!0);const p=localStorage.getItem("token");try{(await Z.patch(`${u}/ajouterstructureautre`,{IDPERSONNEL:T.IDPERSONNEL,STRUCTUREAUTRE:b.trim()},{headers:{Authorization:`Bearer ${p}`}})).data&&(S("Structure mise √† jour avec succ√®s","success"),N(!1),l(U=>U.map(X=>X.IDPERSONNEL===T.IDPERSONNEL?{...X,STRUCTUREAUTRE:b.trim()}:X)))}catch(D){S(D.response?.data?.message||"Erreur lors de la mise √† jour","error")}finally{M(!1)}},S=(p,D)=>{k(p),E(D),R(!0)},A=()=>{R(!1)},g=i();o.useEffect(()=>{B(O?O==="undefined"?n.filter(p=>!p.STRUCTUREAUTRE||p.STRUCTUREAUTRE.trim()===""):n.filter(p=>p.STRUCTUREAUTRE===O):n)},[O,n]);const L=Object.keys(g).filter(p=>p!=="Null").slice(0,4).map((p,D)=>{const U=at[D%at.length],X=lt[D%lt.length];return e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(Rs,{title:p,value:g[p],icon:U,borderColor:X.border,textColor:X.text})},p)}),H=Object.keys(g).filter(p=>p!=="Non d√©finie").length===0;return e.jsxs(r,{sx:{p:3,minHeight:"100vh",bgcolor:"#f8fafc"},children:[e.jsx(zs,{sx:{mb:4},children:e.jsx(K,{sx:{py:3},children:e.jsxs(r,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(r,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)",borderRadius:3,p:1.5,mr:3},children:e.jsx(pt,{sx:{fontSize:40}})}),e.jsxs(r,{children:[e.jsx(t,{variant:"h4",fontWeight:"bold",sx:{mb:1},children:"Personnel Autre √† la DGB"}),e.jsx(t,{variant:"body1",sx:{opacity:.9},children:"Gestion des personnels form√©s autres √† la DGB"})]})]}),e.jsxs(r,{sx:{textAlign:"right"},children:[e.jsx(ks,{startIcon:z?e.jsx(q,{size:20,color:"inherit"}):e.jsx(Xt,{}),onClick:m,disabled:z,sx:{mb:1},children:"Actualiser"}),e.jsx(t,{variant:"body2",sx:{opacity:.8},children:new Date().toLocaleTimeString("fr-FR")})]})]})})}),e.jsx(W,{container:!0,spacing:3,sx:{mb:4},children:H?e.jsx(W,{item:!0,xs:12,children:e.jsx(Q,{sx:{textAlign:"center",py:4,border:"1px dashed #ccc"},children:e.jsxs(t,{variant:"body1",color:"text.secondary",children:["Aucune structure d√©finie dans ",e.jsx("code",{children:"STRUCTUREAUTRE"})]})})}):L}),e.jsxs(Q,{sx:{borderRadius:3,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.05)",overflow:"hidden",mt:0},children:[e.jsxs(r,{sx:{bgcolor:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",mt:"0",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(xt,{sx:{mr:2,fontSize:28}}),e.jsxs(t,{variant:"h6",fontWeight:"bold",children:["Liste du Personnel (",s.length,")"]})]}),e.jsx(V,{label:"Personnel Form√©",sx:{bgcolor:"rgba(255, 255, 255, 0.2)",color:"white",fontWeight:"bold"}})]}),e.jsxs(ae,{sx:{maxHeight:600},children:[e.jsxs(r,{sx:{bgcolor:"#f8fafc",p:3,borderBottom:"1px solid #e0e4e7"},children:[e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Filtrer par structure :"}),e.jsxs(r,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start"},children:[e.jsxs(He,{active:!O,onClick:()=>v(""),children:["Tous (",n.length,")"]}),c.map(p=>e.jsxs(He,{active:O===p,onClick:()=>v(p),children:[p," (",g[p],")"]},p)),e.jsxs(He,{active:O==="undefined",onClick:()=>v("undefined"),children:["Non d√©finie (",g["Non d√©finie"]||0,")"]})]})]}),e.jsxs(le,{stickyHeader:!0,children:[e.jsx(ce,{children:e.jsxs(G,{children:[e.jsx(a,{sx:{fontWeight:"bold",bgcolor:"#f8fafc"},children:"N¬∞"}),e.jsx(a,{sx:{fontWeight:"bold",bgcolor:"#f8fafc"},children:"Personnel"}),e.jsx(a,{sx:{fontWeight:"bold",bgcolor:"#f8fafc"},children:"Fonction"}),e.jsx(a,{sx:{fontWeight:"bold",bgcolor:"#f8fafc"},children:"Structure Actuelle"}),e.jsx(a,{sx:{fontWeight:"bold",bgcolor:"#f8fafc",textAlign:"center"},children:"Formations"}),e.jsx(a,{sx:{fontWeight:"bold",bgcolor:"#f8fafc"},children:"Contact"}),e.jsx(a,{sx:{fontWeight:"bold",bgcolor:"#f8fafc",textAlign:"center"},children:"Actions"})]})}),e.jsx(de,{children:z?e.jsx(G,{children:e.jsxs(a,{colSpan:7,align:"center",sx:{py:8},children:[e.jsx(q,{size:40}),e.jsx(t,{variant:"body1",sx:{mt:2},children:"Chargement du personnel..."})]})}):s.length>0?s.map((p,D)=>e.jsxs(G,{hover:!0,sx:{"&:hover":{bgcolor:"rgba(103, 126, 234, 0.04)"},transition:"all 0.2s ease"},children:[e.jsx(a,{children:e.jsx(t,{variant:"body2",fontWeight:"bold",color:"primary.main",children:D+1})}),e.jsx(a,{children:e.jsxs(r,{children:[e.jsxs(t,{variant:"body1",fontWeight:"bold",children:[p.NOM," ",p.PRENOM]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",mt:.5},children:[e.jsx(ge,{sx:{mr:.5,fontSize:14,color:"text.secondary"}}),e.jsx(t,{variant:"body2",color:"text.secondary",children:p.MATRICULE}),p.SEXE&&e.jsx(V,{label:p.SEXE,size:"small",variant:"outlined",sx:{ml:1,height:20,fontSize:"0.7rem"}})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(fe,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",children:p.FONCTION||"Non d√©finie"}),p.GRADE&&e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Grade: ",p.GRADE]})]})]})}),e.jsx(a,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(et,{sx:{mr:1,fontSize:16,color:"warning.main"}}),e.jsxs(r,{children:[e.jsx(t,{variant:"body2",fontWeight:"500",color:"warning.main",children:p.StructureAbbreviation||p.Structure}),e.jsx(t,{variant:"caption",color:"text.secondary",children:p.STRUCTUREAUTRE||"Non d√©finie"})]})]})}),e.jsx(a,{sx:{textAlign:"center"},children:e.jsx(kt,{badgeContent:p.NombreFormations,color:"success",children:e.jsx(he,{color:"success"})})}),e.jsx(a,{children:p.TELEPHONE?e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ke,{sx:{mr:1,fontSize:16,color:"action.active"}}),e.jsx(t,{variant:"body2",children:p.TELEPHONE})]}):e.jsx(t,{variant:"body2",color:"text.secondary",children:"Non renseign√©"})}),e.jsx(a,{sx:{textAlign:"center"},children:e.jsx(Wt,{title:"Modifier la structure",children:e.jsx(Ye,{size:"small",variant:"contained",bgcolor:"linear-gradient(45deg, #1976D2 30%, #1CB5E0 90%",color:"primary",startIcon:e.jsx(Rt,{}),onClick:()=>h(p),sx:{borderRadius:2},children:"Modifier"})})})]},p.IDPERSONNEL)):e.jsx(G,{children:e.jsxs(a,{colSpan:7,align:"center",sx:{py:8},children:[e.jsx(ve,{sx:{fontSize:60,color:"text.secondary",mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Aucun personnel trouv√©"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:O?`Aucun enregistrement pour "${O==="undefined"?"Non d√©finie":O}"`:"Aucun personnel avec formations"})]})})})]})]})]}),e.jsxs(Ws,{open:y,onClose:()=>N(!1),maxWidth:"md",fullWidth:!0,children:[e.jsxs(mt,{sx:{bgcolor:"#e6ecf1ff",color:"#076fc4ff",display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Jt,{sx:{mr:2}}),e.jsx(t,{variant:"h6",fontWeight:"bold",children:"Modifier la Structure"})]}),e.jsx(dt,{onClick:()=>N(!1),sx:{color:"white"},children:e.jsx(gt,{})})]}),e.jsx(ft,{sx:{p:4},children:T&&e.jsxs(r,{children:[e.jsx(Q,{sx:{bgcolor:"rgba(103, 126, 234, 0.05)",border:"1px solid rgba(103, 126, 234, 0.2)",borderRadius:2,mb:3},children:e.jsxs(K,{children:[e.jsxs(t,{variant:"h6",fontWeight:"bold",sx:{mb:2},children:[T.NOM," ",T.PRENOM]}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:6,children:e.jsxs(t,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Matricule:"})," ",T.MATRICULE]})}),e.jsx(W,{item:!0,xs:6,children:e.jsxs(t,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Fonction:"})," ",T.FONCTION||"Non d√©finie"]})}),e.jsx(W,{item:!0,xs:12,children:e.jsxs(t,{variant:"body2",color:"warning.main",children:[e.jsx("strong",{children:"STRUCTUREAUTRE actuelle:"})," ",T.STRUCTUREAUTRE||"Non d√©finie"]})})]})]})}),e.jsx(Kt,{fullWidth:!0,label:"Nouvelle Structure",value:b,onChange:p=>C(p.target.value),placeholder:"Saisir la nouvelle structure...",variant:"outlined",multiline:!0,rows:2,InputProps:{startAdornment:e.jsx(Zt,{position:"start",children:e.jsx(ne,{color:"action"})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2,"&:hover fieldset":{borderColor:"primary.main"}}}})]})}),e.jsxs(bt,{sx:{p:3,bgcolor:"#f8fafc"},children:[e.jsx(Ye,{onClick:()=>N(!1),startIcon:e.jsx(Qt,{}),variant:"outlined",color:"error",children:"Annuler"}),e.jsx(Ye,{onClick:d,startIcon:I?e.jsx(q,{size:20}):e.jsx(qt,{}),variant:"contained",color:"success",disabled:I||!b.trim(),children:I?"Enregistrement...":"Enregistrer"})]})]}),e.jsx(re,{open:f,autoHideDuration:6e3,onClose:A,anchorOrigin:{vertical:"top",horizontal:"right"},TransitionComponent:Et,children:e.jsx(Is,{onClose:A,severity:P,sx:{borderRadius:2,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)",minWidth:350},children:j})})]})},Ts=me(r)(({theme:n})=>({backgroundImage:`url(${nr})`,backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover",color:"#fff",width:"100%",display:"flex",flexDirection:"column"})),Ds=me(r)(({theme:n})=>({backgroundColor:"rgba(248, 248, 248, 0.8)",width:"100%",minHeight:"70%",backdropFilter:"blur(10px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start"})),Ns=me(Te)(({theme:n})=>({background:"linear-gradient(to top, rgba(173, 216, 230, 0.47), rgba(173, 216, 230, 0))",color:"blue",border:"2px solid blue",borderRadius:"25px",fontSize:"1.2rem",marginLeft:"8px",boxShadow:"inset 0 2px 5px rgba(173, 216, 230, 0.6)",transition:"background-color 0.3s, transform 0.3s",height:"4vh",marginBottom:"5px",width:"20%",textTransform:"none","&:hover":{background:"linear-gradient(to top, rgba(173, 216, 230, 0.7), rgba(173, 216, 230, 0))",transform:"translateY(-2px)"}})),Nn=()=>{const[n,l]=o.useState([]),[s,B]=o.useState(""),[z,$]=o.useState(!1),[y,N]=o.useState(!1),[T,w]=o.useState(!1),b=o.useRef(null),C="",f={FormationPeriodQuery:ir,FormationByStructureQuery:lr,FormationByStructurePeriodQuery:dr,FormationsImprovisePeriod:ur,IndividualFormationsByPersonnelQuery:fr,FormationNonRealisePeriod:gr,FormationsNonRealiseesParStructure:pr,PersonnelsNombreFormationsPeriode:Sr,PersonnelsStructureNombreFormations:vr,PersonnelsFemininsAyantXFormationsPeriode:Fr,PersonnelsMasculinsAyantXFormationsPeriode:zr,PersonnelCentrauxFormationPeriode:Wr,PersonnelDeconcentresFormationPeriode:Tr,PersonnelFormationSpecifique:Er,PersonnelsStructureFormationSpecifique:Nr,PersonnelCentralFormationSpecifique:wr,PersonnelDeconcentreFormationSpecifique:Or,PersonnelsFemininStructureFormationSpecifique:Lr,PersonnelsMasculinStructureFormationSpecifique:Hr,PersonnelsSansFormation:Ur,PersonnelsSansFormationStructurePeriode:Gr,NombrePersonnelsFormesParPeriode:Xr,NombreHommesFormesPeriode:Kr,NombreFemmesFormesPeriode:Qr,NombreHommesCentrauxFormesPeriode:es,NombreFemmesCentrauxFormesPeriode:rs,NombreHommesDeconcentresFormesPeriode:ns,NombreFemmesDeconcentresFormesPeriode:is,NombrePersonnelsNonFormesParPeriode:ls,NombreHommesNonFormesPeriode:ds,NombreHommesCentrauxNonFormesPeriode:us,NombreFormationsIndividuellesParStructure:ps,TauxMiseEnOeuvreThemesAnnuel:ys,TauxMiseEnOeuvreThemesTriennal:Fs,PersonnelsExternesFormes:Cs};o.useEffect(()=>{(async()=>{N(!0);try{const I=localStorage.getItem("token");await Z.post(`${C}/refresh-data`,{},{headers:{Authorization:`Bearer ${I}`,"Content-Type":"application/json"}}),console.log("‚úÖ Donn√©es rafra√Æchies avec succ√®s"),rt.success("üìä Donn√©es mises √† jour avec succ√®s!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}catch(I){console.error("Erreur lors du rafra√Æchissement des donn√©es:",I),rt.error("‚ö†Ô∏è Impossible de mettre √† jour les donn√©es",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}finally{N(!1)}})()},[C]),o.useEffect(()=>{const E={text:"Bonjour! Je suis votre assistant virtuel. Comment puis-je vous aider aujourd'hui?",sender:"bot"};l(I=>[...I,E])},[]),o.useEffect(()=>{b.current?.scrollIntoView({behavior:"smooth"})},[n]);const R=E=>E.replace(/<|>|\/|\/>/g,"").trim(),j=(E,I)=>{const M=R(E),O=f[M];return O?e.jsx(O,{...I},Date.now()):(console.warn(`Composant "${M}" non trouv√© dans componentMap`),console.log("Composants disponibles :",Object.keys(f)),e.jsxs("div",{children:["Composant non disponible : ",M]}))},k=async()=>{if(s.trim()){const E={text:s,sender:"user"};l(I=>[...I,E]),B(""),$(!0),w(!0);try{const I=localStorage.getItem("token"),M=await Z.post(`${C}/dgbchatbot`,{prompt:s},{headers:{Authorization:`Bearer ${I}`,"Content-Type":"application/json"}});let O;const v=M.data.response;if(v&&v.component){const u=v.component;console.log("Composant re√ßu du backend :",u);const m={queryData:v,sqlQuery:v.sql_query,params:v.params,text:v.text};O={sender:"bot",element:j(u,m)}}else v&&v.sql_query?O={sender:"bot",element:j("Answer",{queryData:v})}:O={text:v?.text||v||"D√©sol√©, je n'ai pas pu g√©n√©rer de r√©ponse.",sender:"bot"};l(u=>[...u,O])}catch(I){console.error("Erreur:",I),l(M=>[...M,{text:"D√©sol√©, une erreur est survenue. Veuillez r√©essayer SVP",sender:"bot"}])}finally{$(!1),w(!1)}}},P=()=>{l([])};return e.jsxs(Ts,{children:[e.jsxs(Ds,{children:[e.jsxs("div",{style:ue.header,children:[e.jsx("button",{onClick:P,style:ue.clearButton,children:e.jsx(Ct,{style:ue.clearIcon})}),y&&e.jsxs("div",{style:ue.refreshIndicator,children:[e.jsx(Tt,{style:ue.refreshIcon}),e.jsx("span",{children:"Mise √† jour..."})]})]}),e.jsxs("div",{style:ue.messagesContainer,children:[n.map((E,I)=>e.jsx("div",{style:{...ue.message,...E.sender==="user"?ue.userMessage:ue.botMessage},children:e.jsxs("div",{style:ue.messageContent,children:[E.sender==="user"?e.jsx(Dt,{style:ue.userIcon}):e.jsx(Nt,{style:ue.botIcon}),E.element?e.jsx("div",{style:ue.messageText,children:E.element}):e.jsx("span",{style:ue.messageText,children:E.text})]})},I)),z&&e.jsxs("div",{style:ue.loadingMessage,children:[e.jsx(Mt,{style:ue.loadingIcon}),e.jsx("span",{children:"R√©ponse en cours..."})]}),T&&e.jsxs("div",{style:ue.typingIndicator,children:[e.jsx("span",{className:"dot"}),e.jsx("span",{className:"dot"}),e.jsx("span",{className:"dot"})]}),e.jsx("div",{ref:b})]}),e.jsxs("div",{style:ue.inputContainer,children:[e.jsx("input",{value:s,onChange:E=>B(E.target.value),onKeyPress:E=>E.key==="Enter"&&k(),style:ue.input,placeholder:"Posez votre question ici..."}),e.jsx(Ns,{onClick:k,endIcon:e.jsx(sr,{}),children:"Envoyer"})]})]}),e.jsx(wt,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light",style:{zIndex:9999}})]})},ue={header:{padding:"5px",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"rgba(255, 255, 255, 0.9)",borderRadius:"0 0 15px 15px",position:"sticky",top:60,zIndex:200,color:"black",height:"30px"},clearButton:{background:"none",border:"none",cursor:"pointer",outline:"none"},clearIcon:{fontSize:"20px",color:"#ff6347",transition:"color 0.3s"},refreshIndicator:{display:"flex",alignItems:"center",gap:"8px",fontSize:"12px",color:"#2e7d32",padding:"3px 8px",backgroundColor:"rgba(46, 125, 50, 0.1)",borderRadius:"15px",marginLeft:"auto"},refreshIcon:{fontSize:"14px",animation:"spin 1s linear infinite"},messagesContainer:{flex:1,padding:"10px",overflowY:"auto",display:"flex",flexDirection:"column",gap:"10px",borderRadius:"10px 10px 0 0",width:"100%",position:"relative",minHeight:"calc(100vh - 195px)",paddingBottom:"10px"},message:{maxWidth:"80%",borderRadius:"15px",padding:"10px 15px",wordWrap:"break-word",wordBreak:"break-word",overflowWrap:"break-word",whiteSpace:"pre-wrap",position:"relative",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",transition:"all 0.3s ease-in-out",animation:"fadeIn 0.3s",minHeight:"auto"},messageContent:{display:"flex",alignItems:"flex-start",gap:"10px",width:"100%"},messageText:{fontSize:"16px",lineHeight:"1.5",flex:1,wordWrap:"break-word",wordBreak:"break-word",overflowWrap:"break-word",whiteSpace:"pre-wrap",maxWidth:"100%"},userMessage:{alignSelf:"flex-end",backgroundColor:"#e3f2fd",borderColor:"#00aaff",color:"#000"},botMessage:{alignSelf:"flex-start",backgroundColor:"#fff3e0",borderColor:"#ffcc00",color:"#000"},userIcon:{fontSize:"18px",color:"#00aaff",flexShrink:0,marginTop:"2px"},botIcon:{fontSize:"18px",color:"#ffcc00",flexShrink:0,marginTop:"2px"},loadingMessage:{display:"flex",alignItems:"center",gap:"10px",padding:"10px",borderRadius:"15px",backgroundColor:"#b6b6b64a",color:"#00aaff",fontSize:"14px"},loadingIcon:{fontSize:"18px",color:"#00aaff",animation:"spin 1s linear infinite"},typingIndicator:{display:"flex",justifyContent:"center",alignItems:"center",margin:"10px 0"},inputContainer:{display:"flex",flexDirection:"row",padding:"0px",position:"sticky",bottom:0,zIndex:10,alignItems:"center",width:"100%",marginTop:"5px"},input:{flex:1,minHeight:"7vh",width:"100%",border:"1px solid #767676ff",borderRadius:"25px",backgroundColor:"#d6d5d5ff",padding:"10px 15px"}},ze=document.styleSheets[0];ze.insertRule(`
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}`,ze.cssRules.length);ze.insertRule(`
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}`,ze.cssRules.length);ze.insertRule(`
  .dot {
    width: 8px;
    height: 8px;
    margin: 0 2px;
    background-color: #ffcc00;
    border-radius: 50%;
    display: inline-block;
    animation: typingDots 1s infinite alternate;
  }
`,ze.cssRules.length);for(let n=1;n<=3;n++)ze.insertRule(`
    .dot:nth-child(${n}) {
      animation-delay: ${.2*(n-1)}s;
    }
  `,ze.cssRules.length);ze.insertRule(`
  @keyframes typingDots {
    0% { opacity: 0.2; }
    100% { opacity: 1; }
  }
`,ze.cssRules.length);export{Nn as default};
