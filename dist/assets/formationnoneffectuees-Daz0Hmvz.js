import{r as s,j as t,B as O,H as U,T as b,s as d,L as $,N as H,Q as W,aC as Q,U as G,D as V,Y as j}from"./index-zHPv1lze.js";import{a as y}from"./index-C3O71W1x.js";import{F as I,S as E}from"./Select-DCG_CkE0.js";import{I as S}from"./OutlinedInput-C5vYvqQm.js";import{M as v}from"./MenuItem-D-1uk7AZ.js";import{P as q}from"./Pagination-BeHNtj-4.js";import{L as J}from"./ListItem-CSuwil7H.js";import"./useFormControl-BwsGWz84.js";import"./LastPage-aHJdqG80.js";const K=d("div")(({theme:a})=>({padding:a.spacing(2),borderRadius:"16px",backgroundColor:"#ffffff",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.1)",border:"3px solid transparent",borderImage:"linear-gradient(to right, blue, yellow) 1",position:"relative",overflow:"hidden"})),X=d(J)(({theme:a})=>({backgroundColor:"#f9f9f9",borderRadius:"8px",marginBottom:"8px",transition:"background-color 0.3s, transform 0.2s",border:"1px solid #2586e637","&:hover":{backgroundColor:"#e1f5fe",transform:"scale(1.02)",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.2)"}})),Z=d("input")(({theme:a})=>({marginBottom:a.spacing(2),padding:a.spacing(1),borderRadius:"8px",border:"1px solid #1976d2"})),le=()=>{const[a,N]=s.useState(null),[C,L]=s.useState([]),[m,T]=s.useState(""),[F,x]=s.useState(!1),[i,w]=s.useState([]),[o,A]=s.useState(""),[n,f]=s.useState(""),[k,P]=s.useState([]),[u,D]=s.useState(1),l=5,h="",B=async()=>{x(!0);const e=localStorage.getItem("token");try{const r=await y.get(`${h}/listeformationsnoneffectuees`,{headers:{Authorization:`Bearer ${e}`},params:{year:n}});L(r.data)}catch{j.error("Erreur lors de la récupération des formations.")}finally{x(!1)}};s.useEffect(()=>{n&&B()},[n]);const R=async()=>{const e=localStorage.getItem("token");try{const r=await y.get(`${h}/listeplantrienal`,{headers:{Authorization:`Bearer ${e}`}});w(r.data)}catch(r){console.error("Erreur lors de la récupération des triennals:",r),j.error("Erreur lors de la récupération des triennals.")}};s.useEffect(()=>{R()},[]),s.useEffect(()=>{o&&(()=>{const r=i.find(c=>c.IDPLAN===o);if(r){const c=[r.ANNEE1,r.ANNEE2,r.ANNEE3].filter(z=>z!==0);P(c)}})()},[o,i]);const p=C.filter(e=>e.INTITULE.toLowerCase().includes(m.toLowerCase())),g=u*l,Y=g-l,M=p.slice(Y,g);return t.jsxs(O,{sx:{padding:3,minHeight:"100vh",backgroundColor:"#f5f5f5"},children:[t.jsx(U,{}),t.jsxs(I,{sx:{mb:2,mr:2,minWidth:"200px"},children:[t.jsx(S,{id:"triennal-select-label",children:"Choisir un triennal"}),t.jsx(E,{labelId:"triennal-select-label",value:o,onChange:e=>{A(e.target.value),f("")},children:i.map(e=>t.jsxs(v,{value:e.IDPLAN,children:[e.ANNEE1,", ",e.ANNEE2,", ",e.ANNEE3]},e.IDPLAN))})]}),t.jsxs(I,{sx:{mb:2,minWidth:"200px"},disabled:!o,children:[t.jsx(S,{id:"year-select-label",children:"Choisir une année"}),t.jsx(E,{labelId:"year-select-label",value:n,onChange:e=>f(e.target.value),children:k.map(e=>t.jsx(v,{value:e,children:e},e))})]}),t.jsx(b,{variant:"h4",sx:{color:"#1976d2",fontWeight:"bold",marginLeft:"3%"},children:"Formations Non Effectuées"}),t.jsxs(K,{sx:{width:"100%",minHeight:"70vh"},children:[t.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:t.jsx(Z,{type:"text",placeholder:"Rechercher une formation...",value:m,onChange:e=>T(e.target.value),style:{width:"25%"}})}),F&&t.jsx($,{sx:{marginBottom:2,bgcolor:"#1976d2"}}),t.jsx(H,{children:M.map(e=>t.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[t.jsxs(X,{button:!0,onClick:()=>N(e),children:[t.jsx(W,{children:t.jsx(Q,{style:{color:"red",fontSize:"24px",marginRight:10}})}),t.jsx(G,{primary:e.INTITULE,secondary:"Date : Non définie",sx:{flexGrow:1}})]}),t.jsx(V,{})]},e.IDFORMATIONM))}),!n&&t.jsx(b,{variant:"h5",sx:{textAlign:"center",marginTop:"20px"},children:"Veuillez choisir une année"}),t.jsx(q,{count:Math.ceil(p.length/l),page:u,onChange:(e,r)=>D(r),color:"primary",sx:{display:"flex",justifyContent:"center",marginTop:"20px"}})]})]})};export{le as default};
