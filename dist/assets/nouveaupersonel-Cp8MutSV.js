import{ar as le,as as X,r as x,d as ce,j as i,$ as ue,a0 as de,at as V,B as P,T as me,D as he,G as N,au as fe}from"./index-zHPv1lze.js";import{a as pe}from"./index-C3O71W1x.js";import{d as ge}from"./debounce-CEXHgCrW.js";import{S as Se}from"./Snackbar-XurLPfxZ.js";import{T as L}from"./TextField-DNVhVnCv.js";import{F as K,S as Y}from"./Select-DCG_CkE0.js";import{I as J}from"./OutlinedInput-C5vYvqQm.js";import{M as U}from"./MenuItem-D-1uk7AZ.js";import{F as ve}from"./FormControlLabel-D_GYa5-T.js";import{C as xe}from"./Checkbox-BNRiEFgI.js";import{C as Ie}from"./CircularProgress-BHFhENdB.js";import{A as Te}from"./Alert-D6te_eKs.js";import{B as ne}from"./Button-0T1tR8_c.js";import"./FormHelperText-BXMwkblB.js";import"./useFormControl-BwsGWz84.js";import"./SwitchBase-CEgujy3G.js";import"./Close-DS868zx3.js";import"./ButtonGroupButtonContext-BYVHV5Ft.js";var Q=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function Ce(r,t){return!!(r===t||Q(r)&&Q(t))}function be(r,t){if(r.length!==t.length)return!1;for(var a=0;a<r.length;a++)if(!Ce(r[a],t[a]))return!1;return!0}function W(r,t){t===void 0&&(t=be);var a,m=[],h,O=!1;function M(){for(var T=[],C=0;C<arguments.length;C++)T[C]=arguments[C];return O&&a===this&&t(T,m)||(h=r.apply(this,T),O=!0,a=this,m=T),h}return M}var Ee=typeof performance=="object"&&typeof performance.now=="function",Z=Ee?function(){return performance.now()}:function(){return Date.now()};function ee(r){cancelAnimationFrame(r.id)}function ye(r,t){var a=Z();function m(){Z()-a>=t?r.call(null):h.id=requestAnimationFrame(m)}var h={id:requestAnimationFrame(m)};return h}var B=-1;function te(r){if(r===void 0&&(r=!1),B===-1||r){var t=document.createElement("div"),a=t.style;a.width="50px",a.height="50px",a.overflow="scroll",document.body.appendChild(t),B=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return B}var _=null;function re(r){if(r===void 0&&(r=!1),_===null||r){var t=document.createElement("div"),a=t.style;a.width="50px",a.height="50px",a.overflow="scroll",a.direction="rtl";var m=document.createElement("div"),h=m.style;return h.width="100px",h.height="100px",t.appendChild(m),document.body.appendChild(t),t.scrollLeft>0?_="positive-descending":(t.scrollLeft=1,t.scrollLeft===0?_="negative":_="positive-ascending"),document.body.removeChild(t),_}return _}var Re=150,Oe=function(t,a){return t};function we(r){var t,a=r.getItemOffset,m=r.getEstimatedTotalSize,h=r.getItemSize,O=r.getOffsetForIndexAndAlignment,M=r.getStartIndexForOffset,T=r.getStopIndexForStartIndex,C=r.initInstanceProps,A=r.shouldResetStyleCacheOnItemSizeChange,w=r.validateProps;return t=function(z){le(E,z);function E(p){var e;return e=z.call(this,p)||this,e._instanceProps=C(e.props,X(e)),e._outerRef=void 0,e._resetIsScrollingTimeoutId=null,e.state={instance:X(e),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof e.props.initialScrollOffset=="number"?e.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},e._callOnItemsRendered=void 0,e._callOnItemsRendered=W(function(o,n,s,l){return e.props.onItemsRendered({overscanStartIndex:o,overscanStopIndex:n,visibleStartIndex:s,visibleStopIndex:l})}),e._callOnScroll=void 0,e._callOnScroll=W(function(o,n,s){return e.props.onScroll({scrollDirection:o,scrollOffset:n,scrollUpdateWasRequested:s})}),e._getItemStyle=void 0,e._getItemStyle=function(o){var n=e.props,s=n.direction,l=n.itemSize,g=n.layout,c=e._getItemStyleCache(A&&l,A&&g,A&&s),d;if(c.hasOwnProperty(o))d=c[o];else{var S=a(e.props,o,e._instanceProps),b=h(e.props,o,e._instanceProps),y=s==="horizontal"||g==="horizontal",j=s==="rtl",u=y?S:0;c[o]=d={position:"absolute",left:j?void 0:u,right:j?u:void 0,top:y?0:S,height:y?"100%":b,width:y?b:"100%"}}return d},e._getItemStyleCache=void 0,e._getItemStyleCache=W(function(o,n,s){return{}}),e._onScrollHorizontal=function(o){var n=o.currentTarget,s=n.clientWidth,l=n.scrollLeft,g=n.scrollWidth;e.setState(function(c){if(c.scrollOffset===l)return null;var d=e.props.direction,S=l;if(d==="rtl")switch(re()){case"negative":S=-l;break;case"positive-descending":S=g-s-l;break}return S=Math.max(0,Math.min(S,g-s)),{isScrolling:!0,scrollDirection:c.scrollOffset<S?"forward":"backward",scrollOffset:S,scrollUpdateWasRequested:!1}},e._resetIsScrollingDebounced)},e._onScrollVertical=function(o){var n=o.currentTarget,s=n.clientHeight,l=n.scrollHeight,g=n.scrollTop;e.setState(function(c){if(c.scrollOffset===g)return null;var d=Math.max(0,Math.min(g,l-s));return{isScrolling:!0,scrollDirection:c.scrollOffset<d?"forward":"backward",scrollOffset:d,scrollUpdateWasRequested:!1}},e._resetIsScrollingDebounced)},e._outerRefSetter=function(o){var n=e.props.outerRef;e._outerRef=o,typeof n=="function"?n(o):n!=null&&typeof n=="object"&&n.hasOwnProperty("current")&&(n.current=o)},e._resetIsScrollingDebounced=function(){e._resetIsScrollingTimeoutId!==null&&ee(e._resetIsScrollingTimeoutId),e._resetIsScrollingTimeoutId=ye(e._resetIsScrolling,Re)},e._resetIsScrolling=function(){e._resetIsScrollingTimeoutId=null,e.setState({isScrolling:!1},function(){e._getItemStyleCache(-1,null)})},e}E.getDerivedStateFromProps=function(e,o){return Me(e,o),w(e),null};var I=E.prototype;return I.scrollTo=function(e){e=Math.max(0,e),this.setState(function(o){return o.scrollOffset===e?null:{scrollDirection:o.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},I.scrollToItem=function(e,o){o===void 0&&(o="auto");var n=this.props,s=n.itemCount,l=n.layout,g=this.state.scrollOffset;e=Math.max(0,Math.min(e,s-1));var c=0;if(this._outerRef){var d=this._outerRef;l==="vertical"?c=d.scrollWidth>d.clientWidth?te():0:c=d.scrollHeight>d.clientHeight?te():0}this.scrollTo(O(this.props,e,o,g,this._instanceProps,c))},I.componentDidMount=function(){var e=this.props,o=e.direction,n=e.initialScrollOffset,s=e.layout;if(typeof n=="number"&&this._outerRef!=null){var l=this._outerRef;o==="horizontal"||s==="horizontal"?l.scrollLeft=n:l.scrollTop=n}this._callPropsCallbacks()},I.componentDidUpdate=function(){var e=this.props,o=e.direction,n=e.layout,s=this.state,l=s.scrollOffset,g=s.scrollUpdateWasRequested;if(g&&this._outerRef!=null){var c=this._outerRef;if(o==="horizontal"||n==="horizontal")if(o==="rtl")switch(re()){case"negative":c.scrollLeft=-l;break;case"positive-ascending":c.scrollLeft=l;break;default:var d=c.clientWidth,S=c.scrollWidth;c.scrollLeft=S-d-l;break}else c.scrollLeft=l;else c.scrollTop=l}this._callPropsCallbacks()},I.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&ee(this._resetIsScrollingTimeoutId)},I.render=function(){var e=this.props,o=e.children,n=e.className,s=e.direction,l=e.height,g=e.innerRef,c=e.innerElementType,d=e.innerTagName,S=e.itemCount,b=e.itemData,y=e.itemKey,j=y===void 0?Oe:y,u=e.layout,f=e.outerElementType,v=e.outerTagName,R=e.style,k=e.useIsScrolling,oe=e.width,$=this.state.isScrolling,F=s==="horizontal"||u==="horizontal",ie=F?this._onScrollHorizontal:this._onScrollVertical,H=this._getRangeToRender(),ae=H[0],se=H[1],q=[];if(S>0)for(var D=ae;D<=se;D++)q.push(x.createElement(o,{data:b,key:j(D,b),index:D,isScrolling:k?$:void 0,style:this._getItemStyle(D)}));var G=m(this.props,this._instanceProps);return x.createElement(f||v||"div",{className:n,onScroll:ie,ref:this._outerRefSetter,style:ce({position:"relative",height:l,width:oe,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:s},R)},x.createElement(c||d||"div",{children:q,ref:g,style:{height:F?"100%":G,pointerEvents:$?"none":void 0,width:F?G:"100%"}}))},I._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var e=this.props.itemCount;if(e>0){var o=this._getRangeToRender(),n=o[0],s=o[1],l=o[2],g=o[3];this._callOnItemsRendered(n,s,l,g)}}if(typeof this.props.onScroll=="function"){var c=this.state,d=c.scrollDirection,S=c.scrollOffset,b=c.scrollUpdateWasRequested;this._callOnScroll(d,S,b)}},I._getRangeToRender=function(){var e=this.props,o=e.itemCount,n=e.overscanCount,s=this.state,l=s.isScrolling,g=s.scrollDirection,c=s.scrollOffset;if(o===0)return[0,0,0,0];var d=M(this.props,c,this._instanceProps),S=T(this.props,d,c,this._instanceProps),b=!l||g==="backward"?Math.max(1,n):1,y=!l||g==="forward"?Math.max(1,n):1;return[Math.max(0,d-b),Math.max(0,Math.min(o-1,S+y)),d,S]},E}(x.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var Me=function(t,a){t.children,t.direction,t.height,t.layout,t.innerTagName,t.outerTagName,t.width,a.instance},Ae=we({getItemOffset:function(t,a){var m=t.itemSize;return a*m},getItemSize:function(t,a){var m=t.itemSize;return m},getEstimatedTotalSize:function(t){var a=t.itemCount,m=t.itemSize;return m*a},getOffsetForIndexAndAlignment:function(t,a,m,h,O,M){var T=t.direction,C=t.height,A=t.itemCount,w=t.itemSize,z=t.layout,E=t.width,I=T==="horizontal"||z==="horizontal",p=I?E:C,e=Math.max(0,A*w-p),o=Math.min(e,a*w),n=Math.max(0,a*w-p+w+M);switch(m==="smart"&&(h>=n-p&&h<=o+p?m="auto":m="center"),m){case"start":return o;case"end":return n;case"center":{var s=Math.round(n+(o-n)/2);return s<Math.ceil(p/2)?0:s>e+Math.floor(p/2)?e:s}case"auto":default:return h>=n&&h<=o?h:h<n?n:o}},getStartIndexForOffset:function(t,a){var m=t.itemCount,h=t.itemSize;return Math.max(0,Math.min(m-1,Math.floor(a/h)))},getStopIndexForStartIndex:function(t,a,m){var h=t.direction,O=t.height,M=t.itemCount,T=t.itemSize,C=t.layout,A=t.width,w=h==="horizontal"||C==="horizontal",z=a*T,E=w?A:O,I=Math.ceil((E+m-z)/T);return Math.max(0,Math.min(M-1,a+I-1))},initInstanceProps:function(t){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(t){t.itemSize}});const ze=de({palette:{primary:{main:"#1976d2"},secondary:{main:"#ff4081"}}}),Ne=V(Te)(({theme:r})=>({"&.MuiAlert.root":{margin:r.spacing(1)}})),je=V(ne)(({theme:r})=>({marginTop:r.spacing(0),background:"linear-gradient(to top, rgba(173, 216, 230, 0.47), rgba(173, 216, 230, 0))",color:"blue",border:"2px solid blue",borderRadius:"20px",fontSize:"1.2rem",padding:r.spacing(1.5,4),boxShadow:"inset 0 2px 5px rgba(173, 216, 230, 0.6)",transition:"background-color 0.3s, transform 0.3s",height:"6vh",width:"25vw",textTransform:"none","&:hover":{background:"linear-gradient(to top, rgba(173, 216, 230, 0.7), rgba(173, 216, 230, 0))",transform:"translateY(-2px)"}})),_e=V(ne)(({theme:r})=>({border:"2px dashed",width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px",marginBottom:"5px"})),Ze=()=>{const[r,t]=x.useState({MATRICULE:"",NOM:"",PRENOM:"",SEXE:"",CATEGORIE:"",FONCTION:"",TELEPHONE:"",NIVEAUETUDE:"",GRADE:"",STRUCTURE:"",SERVICECENTRAL:"",PHOTO:null,NOM_DU_MARI:""}),[a,m]=x.useState(!1),[h,O]=x.useState(!1),[M,T]=x.useState(""),[C,A]=x.useState("success"),[w,z]=x.useState(""),[E,I]=x.useState([]),[p,e]=x.useState(""),[o,n]=x.useState(!1),s="",l=x.useMemo(()=>{const u=p.toLowerCase();return E.filter(f=>f.NOMSTRUCTURE.toLowerCase().includes(u)||f.ABBREVIATION.toLowerCase().includes(u))},[p,E]),g=x.useCallback(ge(async u=>{try{const f=await pe.get(`${s}/listestructures`,{params:{search:u},headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});I(f.data)}catch(f){console.error("Error fetching structures:",f)}},300),[s]);x.useEffect(()=>(g(p),()=>g.cancel()),[p,g]);const c=({index:u,style:f})=>{const v=l[u];return i.jsxs(U,{style:f,onClick:()=>j(v),onMouseDown:R=>R.preventDefault(),children:[v.NOMSTRUCTURE," (",v.ABBREVIATION,")"]},v.IDSTRUCTURE)},d=u=>{const{name:f,value:v,files:R}=u.target;t(k=>({...k,[f]:R?.[0]||v})),f==="PHOTO"&&R?.[0]&&z(R[0].name)},S=async u=>{u.preventDefault(),m(!0);const f=new FormData;Object.entries(r).forEach(([v,R])=>f.append(v,R));try{const v=await fetch(`${s}/nouveaupersonel`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},method:"POST",body:f});if(!v.ok)throw new Error(await v.text());const R=await v.json();b("success",R.message),y()}catch(v){b("error",v.message)}finally{m(!1)}},b=(u,f)=>{A(u),T(f),O(!0)},y=()=>{t({MATRICULE:"",NOM:"",PRENOM:"",SEXE:"",CATEGORIE:"",FONCTION:"",TELEPHONE:"",NIVEAUETUDE:"",GRADE:"",STRUCTURE:"",SERVICECENTRAL:"",PHOTO:null,NOMMARI:""}),z(""),e(""),n(!1)},j=u=>{t(f=>({...f,STRUCTURE:u.IDSTRUCTURE})),e(u.NOMSTRUCTURE),n(!1)};return i.jsxs(ue,{theme:ze,children:[i.jsx(Se,{open:h,autoHideDuration:6e3,onClose:()=>O(!1),children:i.jsx(Ne,{sx:{position:"fixed",top:0,right:"23%"},severity:C,children:M})}),i.jsx(P,{sx:{display:"flex",justifyContent:"center",alignItems:"center",p:2},children:i.jsxs(P,{component:"form",onSubmit:S,sx:{width:"100%",maxWidth:1200,bgcolor:"white",p:3,borderRadius:3,boxShadow:5,"&:hover":{boxShadow:"0 10px 20px rgba(0, 0, 0, 0.2)"}},children:[i.jsx(me,{variant:"h6",gutterBottom:!0,align:"left",color:"primary",children:"Enregistrer un nouveau personnel"}),i.jsx(he,{sx:{mb:4}}),i.jsxs(N,{container:!0,spacing:2,children:[[{name:"MATRICULE",label:"Matricule"},{name:"NOM",label:"Nom",required:!0},{name:"PRENOM",label:"Prénom"},{name:"CATEGORIE",label:"Catégorie"},{name:"FONCTION",label:"Fonction"},{name:"TELEPHONE",label:"Téléphone"},{name:"NIVEAUETUDE",label:"Niveau d'Étude"},{name:"GRADE",label:"Grade"}].map((u,f)=>i.jsx(N,{item:!0,xs:12,sm:6,children:i.jsx(L,{fullWidth:!0,name:u.name,label:u.label,value:r[u.name],onChange:d,variant:"outlined",required:u.required,sx:{mb:0}})},f)),i.jsxs(N,{item:!0,xs:12,sm:6,children:[i.jsx(L,{fullWidth:!0,label:"Structure",value:p,required:!0,onChange:u=>e(u.target.value),onFocus:()=>n(!0),onBlur:()=>setTimeout(()=>n(!1),100)}),o&&i.jsx(P,{sx:{maxHeight:300,overflow:"auto",width:"75%",bgcolor:"background.paper",boxShadow:3,position:"absolute",zIndex:9999,border:"1px solid #ddd",borderRadius:"4px"},children:i.jsx(Ae,{height:Math.min(l.length*48,300),width:"100%",itemSize:48,itemCount:l.length,children:c})})]}),i.jsx(N,{item:!0,xs:12,sm:6,children:i.jsxs(K,{fullWidth:!0,variant:"outlined",children:[i.jsx(J,{id:"sexe-label",children:"Sexe"}),i.jsxs(Y,{labelId:"sexe-label",name:"SEXE",value:r.SEXE,onChange:d,label:"Sexe",required:!0,children:[i.jsx(U,{value:"Masculin",children:"Masculin"}),i.jsx(U,{value:"Féminin",children:"Féminin"})]})]})}),r.SEXE==="Féminin"&&i.jsxs(i.Fragment,{children:[i.jsx(N,{item:!0,xs:6,sm:3,children:i.jsx(ve,{control:i.jsx(xe,{checked:r.MARIAGE_ACTIVE,onChange:u=>t(f=>({...f,MARIAGE_ACTIVE:u.target.checked,...u.target.checked?{}:{NOM_DU_MARI:""}})),name:"MARIAGE_ACTIVE",color:"primary"}),label:"Mariée",sx:{mt:1}})}),r.MARIAGE_ACTIVE&&i.jsx(N,{item:!0,xs:6,sm:3,children:i.jsx(L,{fullWidth:!0,name:"NOMMARI",label:"Nom du Mari",value:r.NOMMARI,onChange:d,variant:"outlined",size:"small"})})]}),i.jsx(N,{item:!0,xs:12,sm:6,children:i.jsxs(K,{fullWidth:!0,variant:"outlined",children:[i.jsx(J,{id:"servicecentral-label",children:"Service Central/Deconcentré"}),i.jsxs(Y,{labelId:"servicecentral-label",name:"SERVICECENTRAL",value:r.SERVICECENTRAL,onChange:d,label:"Service Central/Deconcentré",children:[i.jsx(U,{value:"Service Central",children:"Central"}),i.jsx(U,{value:"Service Deconcentré",children:"Deconcentré"})]})]})}),i.jsx(N,{item:!0,xs:12,children:i.jsxs(_e,{component:"label",fullWidth:!0,children:[i.jsxs(P,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:[i.jsx(fe,{style:{marginRight:"8px",fontSize:"1.5rem"}}),w||"Télécharger une photo 4X4"]}),i.jsx("input",{type:"file",name:"PHOTO",hidden:!0,accept:"image/*",onChange:d})]})})]}),i.jsx(P,{sx:{mt:2,display:"flex",justifyContent:"center"},children:i.jsx(je,{type:"submit",disabled:a,children:a?i.jsx(Ie,{size:24}):"Enregistrer"})})]})})]})};export{Ze as default};
