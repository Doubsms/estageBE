import{g as He,b as Te,r as u,c as Ue,_ as Ve,d as W,j as e,s as I,e as ue,f as re,h as Ge,i as Je,k as Xe,l as Ke,m as we,n as Fe,o as Se,p as Re,q as ke,t as Ce,B as s,M as Ie,S as C,T as o,G as m,v as se,P as z,u as q,C as ae,w as V,A as D,x as ze,I as Ae,F as U,D as $e,L as Oe,y as F,z as Me}from"./index-zHPv1lze.js";import{C as ne}from"./react-apexcharts.min-rkE0FX8L.js";import{F as ie,S as oe}from"./Select-DCG_CkE0.js";import{I as le}from"./OutlinedInput-C5vYvqQm.js";import{M as ce}from"./MenuItem-D-1uk7AZ.js";import{B as me}from"./Button-0T1tR8_c.js";import{a as De}from"./index-C3O71W1x.js";import{C as _e}from"./CircularProgress-BHFhENdB.js";import{A as Ee}from"./Assessment-DAI052hb.js";import{R as Le}from"./Refresh-HvTEdGt2.js";import{B as he}from"./Business-DP4Oq-gt.js";import{A as Pe}from"./Alert-D6te_eKs.js";import{T as We}from"./TrendingUp-CnKnPJ6F.js";import{I as qe}from"./Info-BG_pDBBb.js";import{G as Be}from"./Groups-DO3ZmRBj.js";import{E as Qe,P as Ze,H as et,A as tt,S as rt}from"./SwapHoriz-B-zTNYW6.js";import{P as st}from"./Person-CVTBdQV4.js";import"./useFormControl-BwsGWz84.js";import"./ButtonGroupButtonContext-BYVHV5Ft.js";import"./Close-DS868zx3.js";function at(t){return Te("MuiFab",t)}const xe=He("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]),nt=["children","className","color","component","disabled","disableFocusRipple","focusVisibleClassName","size","variant"],it=t=>{const{color:r,variant:i,classes:n,size:l}=t,a={root:["root",i,`size${re(l)}`,r==="inherit"?"colorInherit":r]},x=Ge(a,at,n);return W({},n,x)},ot=I(Je,{name:"MuiFab",slot:"Root",shouldForwardProp:t=>Xe(t)||t==="classes",overridesResolver:(t,r)=>{const{ownerState:i}=t;return[r.root,r[i.variant],r[`size${re(i.size)}`],i.color==="inherit"&&r.colorInherit,r[re(i.size)],r[i.color]]}})(({theme:t,ownerState:r})=>{var i,n;return W({},t.typography.button,{minHeight:36,transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(t.vars||t).zIndex.fab,boxShadow:(t.vars||t).shadows[6],"&:active":{boxShadow:(t.vars||t).shadows[12]},color:t.vars?t.vars.palette.text.primary:(i=(n=t.palette).getContrastText)==null?void 0:i.call(n,t.palette.grey[300]),backgroundColor:(t.vars||t).palette.grey[300],"&:hover":{backgroundColor:(t.vars||t).palette.grey.A100,"@media (hover: none)":{backgroundColor:(t.vars||t).palette.grey[300]},textDecoration:"none"},[`&.${xe.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]}},r.size==="small"&&{width:40,height:40},r.size==="medium"&&{width:48,height:48},r.variant==="extended"&&{borderRadius:48/2,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48},r.variant==="extended"&&r.size==="small"&&{width:"auto",padding:"0 8px",borderRadius:34/2,minWidth:34,height:34},r.variant==="extended"&&r.size==="medium"&&{width:"auto",padding:"0 16px",borderRadius:40/2,minWidth:40,height:40},r.color==="inherit"&&{color:"inherit"})},({theme:t,ownerState:r})=>W({},r.color!=="inherit"&&r.color!=="default"&&(t.vars||t).palette[r.color]!=null&&{color:(t.vars||t).palette[r.color].contrastText,backgroundColor:(t.vars||t).palette[r.color].main,"&:hover":{backgroundColor:(t.vars||t).palette[r.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[r.color].main}}}),({theme:t})=>({[`&.${xe.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}})),lt=u.forwardRef(function(r,i){const n=Ue({props:r,name:"MuiFab"}),{children:l,className:a,color:x="default",component:h="button",disabled:b=!1,disableFocusRipple:j=!1,focusVisibleClassName:f,size:v="large",variant:S="circular"}=n,g=Ve(n,nt),y=W({},n,{color:x,component:h,disabled:b,disableFocusRipple:j,size:v,variant:S}),R=it(y);return e.jsx(ot,W({className:ue(R.root,a),component:h,disabled:b,focusRipple:!j,focusVisibleClassName:ue(R.focusVisible,f),ownerState:y,ref:i},g,{classes:R,children:l}))}),G=Ke(e.jsx("path",{d:"M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 16H5V10h14zM9 14H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2zm-8 4H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2z"}),"CalendarMonth");var Y={exports:{}},E={},N={},pe;function ct(){if(pe)return N;pe=1,Object.defineProperty(N,"__esModule",{value:!0});var t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917 211.1l-199.2 24c-6.6.8-9.4 8.9-4.7 13.6l59.3 59.3-226 226-101.8-101.7c-6.3-6.3-16.4-6.2-22.6 0L100.3 754.1a8.03 8.03 0 000 11.3l45 45.2c3.1 3.1 8.2 3.1 11.3 0L433.3 534 535 635.7c6.3 6.2 16.4 6.2 22.6 0L829 364.5l59.3 59.3a8.01 8.01 0 0013.6-4.7l24-199.2c.7-5.1-3.7-9.5-8.9-8.8z"}}]},name:"rise",theme:"outlined"};return N.default=t,N}var fe;function dt(){if(fe)return E;fe=1;var t=we().default,r=Fe().default;Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var i=r(Se()),n=t(Re()),l=r(ct()),a=r(ke()),x=function(j,f){return n.createElement(a.default,(0,i.default)({},j,{ref:f,icon:l.default}))},h=n.forwardRef(x);return E.default=h,E}var ge;function ut(){return ge||(ge=1,function(t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;const i=n(dt());function n(a){return a&&a.__esModule?a:{default:a}}const l=i;r.default=l,t.exports=l}(Y,Y.exports)),Y.exports}var mt=ut();const ht=Ce(mt);var H={exports:{}},L={},T={},be;function xt(){if(be)return T;be=1,Object.defineProperty(T,"__esModule",{value:!0});var t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M925.9 804l-24-199.2c-.8-6.6-8.9-9.4-13.6-4.7L829 659.5 557.7 388.3c-6.3-6.2-16.4-6.2-22.6 0L433.3 490 156.6 213.3a8.03 8.03 0 00-11.3 0l-45 45.2a8.03 8.03 0 000 11.3L422 591.7c6.2 6.3 16.4 6.3 22.6 0L546.4 490l226.1 226-59.3 59.3a8.01 8.01 0 004.7 13.6l199.2 24c5.1.7 9.5-3.7 8.8-8.9z"}}]},name:"fall",theme:"outlined"};return T.default=t,T}var je;function pt(){if(je)return L;je=1;var t=we().default,r=Fe().default;Object.defineProperty(L,"__esModule",{value:!0}),L.default=void 0;var i=r(Se()),n=t(Re()),l=r(xt()),a=r(ke()),x=function(j,f){return n.createElement(a.default,(0,i.default)({},j,{ref:f,icon:l.default}))},h=n.forwardRef(x);return L.default=h,L}var ve;function ft(){return ve||(ve=1,function(t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;const i=n(pt());function n(a){return a&&a.__esModule?a:{default:a}}const l=i;r.default=l,t.exports=l}(H,H.exports)),H.exports}var gt=ft();const bt=Ce(gt),ye={fontSize:"0.75rem",color:"inherit",marginLeft:0,marginRight:0};function P({color:t="primary",title:r,count:i,percentage:n,isLoss:l,extra:a}){return e.jsx(s,{sx:{boxShadow:4,borderRadius:1.5,transition:"transform 0.3s ease","&:hover":{transform:"scale(1.05)"}},children:e.jsxs(Ie,{contentSX:{p:2.25},style:{borderRadius:1.5},children:[e.jsxs(C,{spacing:.5,children:[e.jsx(o,{variant:"h6",color:"text.secondary",children:r}),e.jsxs(m,{container:!0,alignItems:"center",children:[e.jsx(m,{item:!0,children:e.jsx(o,{variant:"h4",color:"inherit",children:i})}),n&&e.jsx(m,{item:!0,children:e.jsx(se,{variant:"combined",color:t,icon:l?e.jsx(bt,{style:ye}):e.jsx(ht,{style:ye}),label:`${n}%`,sx:{ml:1.25,pl:1},size:"small"})})]})]}),e.jsx(s,{sx:{pt:2.25},children:e.jsxs(o,{variant:"caption",color:"text.secondary",children:["You trained"," ",e.jsx(o,{variant:"caption",sx:{color:`${t||"primary"}.main`},children:a})," ","since year 2024"]})})]})})}P.propTypes={color:z.string,title:z.string,count:z.string,percentage:z.number,isLoss:z.bool,extra:z.string};const jt={chart:{height:450,type:"area",toolbar:{show:!1}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},grid:{strokeDashArray:0},xaxis:{categories:[],labels:{style:{colors:[]}},axisBorder:{show:!0,color:""},tickAmount:0},yaxis:{labels:{style:{colors:[]}}}};function Ye({slot:t,selectedYear:r}){const i=q(),{primary:n,secondary:l}=i.palette.text,a=i.palette.divider,[x,h]=u.useState(jt),[b,j]=u.useState([{name:"Sessions Complétées",data:[]},{name:"Participants",data:[]}]),f="";return u.useEffect(()=>{(async()=>{const S=localStorage.getItem("token");try{const g=await fetch(`${f}/dashvalueschart`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${S}`},body:JSON.stringify({year:r})});if(!g.ok)throw new Error("Erreur lors de la récupération des données");const y=await g.json();j([{name:"Sessions Réalisées",data:t==="year"?y.year.formationsCompletes.map(Number):y.triennal.formationsCompletes.map(Number)},{name:"Participants",data:t==="year"?y.year.participants.map(Number):y.triennal.participants.map(Number)}]),h(R=>({...R,xaxis:{...R.xaxis,categories:t==="year"?["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]:y.triennal.years,labels:{style:{colors:Array(t==="year"?12:y.triennal.years.length).fill(l)}},tickAmount:t==="year"?12:y.triennal.years.length}}))}catch(g){console.error("Erreur lors de la récupération des données",g)}})()},[t,r,f,l]),u.useEffect(()=>{h(v=>({...v,colors:[i.palette.primary.main,i.palette.primary[700]],yaxis:{labels:{style:{colors:[l]}}},grid:{borderColor:a}}))},[n,l,a,i]),e.jsx(ne,{options:x,series:b,type:"area",height:450})}Ye.propTypes={slot:z.string,selectedYear:z.number.isRequired};function vt(){const[t,r]=u.useState("year"),[i,n]=u.useState(new Date().getFullYear()),l=new Date().getFullYear(),a=[];for(let h=2024;h<=l;h++)a.push(h);const x=h=>{n(h.target.value)};return e.jsxs(e.Fragment,{children:[e.jsxs(m,{container:!0,alignItems:"center",justifyContent:"space-between",children:[e.jsx(m,{item:!0,children:e.jsxs(o,{variant:"h5",children:["Statut des Formations ",i]})}),e.jsx(m,{item:!0,children:e.jsxs(C,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(s,{sx:{minWidth:70},children:e.jsxs(ie,{fullWidth:!0,size:"small",children:[e.jsx(le,{id:"year-select-label",children:"Année"}),e.jsx(oe,{labelId:"year-select-label",id:"year-select",value:i,label:"Année",onChange:x,children:a.map(h=>e.jsx(ce,{value:h,children:h},h))})]})}),e.jsxs(C,{direction:"row",alignItems:"center",spacing:0,children:[e.jsx(me,{size:"small",onClick:()=>r("year"),color:t==="year"?"primary":"secondary",variant:t==="year"?"outlined":"text",children:"Annuel"}),e.jsx(me,{size:"small",onClick:()=>r("triennial"),color:t==="triennial"?"primary":"secondary",variant:t==="triennial"?"outlined":"text",children:"Triennal"})]})]})})]}),e.jsx(Ie,{content:!1,sx:{mt:1.5},children:e.jsx(s,{sx:{pt:1,pr:2},children:e.jsx(Ye,{slot:t,selectedYear:i})})})]})}/**
 * @license @tabler/icons-react v3.19.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var yt={outline:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},filled:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",stroke:"none"}};/**
 * @license @tabler/icons-react v3.19.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=(t,r,i,n)=>{const l=u.forwardRef(({color:a="currentColor",size:x=24,stroke:h=2,title:b,className:j,children:f,...v},S)=>u.createElement("svg",{ref:S,...yt[t],width:x,height:x,className:["tabler-icon",`tabler-icon-${r}`,j].join(" "),strokeWidth:h,stroke:a,...v},[b&&u.createElement("title",{key:"svg-title"},b),...n.map(([g,y])=>u.createElement(g,y)),...Array.isArray(f)?f:[f]]));return l.displayName=`${i}`,l};/**
 * @license @tabler/icons-react v3.19.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var wt=de("outline","arrow-up-left","IconArrowUpLeft",[["path",{d:"M7 7l10 10",key:"svg-0"}],["path",{d:"M16 7l-9 0l0 9",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.19.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ft=de("outline","arrow-up-right","IconArrowUpRight",[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M8 7l9 0l0 9",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.19.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var St=de("outline","clipboard-list","IconClipboardList",[["path",{d:"M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2",key:"svg-0"}],["path",{d:"M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-1"}],["path",{d:"M9 12l.01 0",key:"svg-2"}],["path",{d:"M13 12l2 0",key:"svg-3"}],["path",{d:"M9 16l.01 0",key:"svg-4"}],["path",{d:"M13 16l2 0",key:"svg-5"}]]);const Ne=({title:t,subtitle:r,children:i,action:n,footer:l,cardheading:a,headtitle:x,headsubtitle:h,middlecontent:b})=>e.jsxs(ae,{sx:{padding:0,mt:0},elevation:9,variant:void 0,children:[a?e.jsxs(V,{children:[e.jsx(o,{variant:"h5",children:x}),e.jsx(o,{variant:"subtitle2",color:"textSecondary",children:h})]}):e.jsxs(V,{sx:{p:"30px"},children:[t&&e.jsxs(C,{direction:"row",spacing:2,justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsxs(s,{children:[t&&e.jsx(o,{variant:"h5",children:t}),r&&e.jsx(o,{variant:"subtitle2",color:"textSecondary",children:r})]}),n]}),i]}),b,l]}),Rt=t=>{const r=q(),i=r.palette.primary.main,n="#ecf2ff",l=t.totalFormations,a=t.formationsEffectuees,x=l-a,h=(a/l*100).toFixed(1),b={chart:{type:"donut",fontFamily:"'Plus Jakarta Sans', sans-serif;",foreColor:"#adb0bb",toolbar:{show:!1},height:155},colors:[i,n,"#F9F9FD"],plotOptions:{pie:{startAngle:0,endAngle:360,donut:{size:"75%",background:"transparent"},dataLabels:{enabled:!1}}},tooltip:{theme:r.palette.mode==="dark"?"dark":"light",fillSeriesColor:!1,y:{formatter:(f,{seriesIndex:v})=>`${["Formations effectuées","Formations non effectuées"][v]}: ${f.toFixed(0)}%`}},stroke:{show:!0,colors:["#fff"],width:2},legend:{show:!1},states:{hover:{filter:{type:"darken",value:.1}}},responsive:[{breakpoint:991,options:{chart:{width:120}}}]},j=[a/l*100,x/l*100];return e.jsx(s,{sx:{transition:"transform 0.3s ease","&:hover":{transform:"scale(1.05)"}},children:e.jsx(Ne,{title:"Taux d'exécution du plan triennal",children:e.jsxs(m,{container:!0,spacing:3,children:[e.jsxs(m,{item:!0,xs:7,sm:7,children:[e.jsxs(C,{direction:"row",spacing:1,mt:1,alignItems:"center",children:[e.jsx(D,{sx:{bgcolor:"rgba(255, 165, 0, 0.181)",width:27,height:27},children:e.jsx(wt,{width:20,color:"#39B69A"})}),e.jsxs(o,{variant:"subtitle2",fontWeight:"600",children:[t.formationsEffectuees," formations effectuées"]}),e.jsxs(o,{variant:"subtitle2",color:"textSecondary",children:["sur un total de ",t.totalFormations]})]}),e.jsxs(C,{spacing:3,mt:5,direction:"row",children:[e.jsxs(C,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(D,{sx:{width:9,height:9,bgcolor:i,svg:{display:"none"}}}),e.jsx(o,{variant:"subtitle2",color:"textSecondary",children:"Formations effectuées"})]}),e.jsxs(C,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(D,{sx:{width:9,height:9,bgcolor:n,svg:{display:"none"}}}),e.jsx(o,{variant:"subtitle2",color:"textSecondary",children:"Formations non effectuées"})]})]})]}),e.jsxs(m,{item:!0,xs:5,sm:5,children:[e.jsx(ne,{options:b,series:j,type:"donut",height:"150px"}),e.jsxs(o,{variant:"h3",align:"center",sx:{marginTop:1,fontWeight:"bold",color:"orange"},children:[h,"%"]})]})]})})})},kt=t=>{const r=q(),i=r.palette.primary.main,n="#e3f2fd",l="#fdede8",a={chart:{type:"area",fontFamily:"'Plus Jakarta Sans', sans-serif;",foreColor:"#adb0bb",toolbar:{show:!1},height:60,sparkline:{enabled:!0},group:"sparklines"},stroke:{curve:"smooth",width:2},fill:{colors:[n],type:"solid",opacity:.05},markers:{size:0},tooltip:{theme:r.palette.mode==="dark"?"dark":"light"}},x=[{name:"",color:i,data:[25,66,20,40,12,58,20]}];return e.jsx(s,{sx:{boxShadow:2,marginTop:1,transition:"transform 0.3s ease","&:hover":{transform:"scale(1.05)"}},children:e.jsx(Ne,{title:"Suivi Mensuel des Formations",action:e.jsx(lt,{sx:{bgcolor:i,color:"#ffffff"},size:"medium",children:e.jsx(St,{width:24})}),footer:e.jsx(ne,{options:a,series:x,type:"area",height:"60px"}),children:e.jsxs(e.Fragment,{children:[e.jsxs(o,{variant:"h4",fontWeight:"700",mt:"-20px",children:["Formations du mois courant : ",t.monthlycount]}),e.jsxs(C,{direction:"row",spacing:1,my:1,alignItems:"center",children:[e.jsx(D,{sx:{bgcolor:l,width:27,height:27},children:e.jsx(Ft,{width:20,color:"#FA896B"})}),e.jsxs(o,{variant:"subtitle2",fontWeight:"600",children:[t.monthlycount," nouvelle",t.monthlycount>1?"(s)":""," session",t.monthlycount>1?"(s)":""," de formation",t.monthlycount>1?"(s)":""]}),e.jsx(o,{variant:"subtitle2",color:"textSecondary",children:"depuis le mois dernier"})]})]})})})},Ct=I(ae)(({theme:t})=>({borderRadius:16,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",transition:"all 0.3s ease-in-out",border:`1px solid ${F(t.palette.primary.main,.1)}`,"&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 25px rgba(0, 0, 0, 0.12)"}})),It=I(D)(({theme:t,bgcolor:r})=>({background:`linear-gradient(135deg, ${r}, ${F(r,.7)})`,width:64,height:64,boxShadow:`0 4px 15px ${F(r,.3)}`})),zt=I(s)(({theme:t})=>({borderRadius:20,color:"#26449dff",marginBottom:t.spacing(3)})),At=I(s)(({theme:t})=>({background:"linear-gradient(135deg, #c9d8ed, #ffffff)",padding:t.spacing(3),borderRadius:20,minHeight:"100px",width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:t.spacing(2)})),$t=()=>{const t=q(),[r,i]=u.useState(!0),[n,l]=u.useState([]),[a,x]=u.useState(0),[h,b]=u.useState(0),[j,f]=u.useState(null),[v,S]=u.useState(!1),[g,y]=u.useState(new Date().getFullYear()),[R,J]=u.useState([]),X="";u.useEffect(()=>{const c=new Date().getFullYear(),p=[];for(let k=2024;k<=c;k++)p.push(k);J(p)},[]);const _=async()=>{const c=localStorage.getItem("token");try{i(!0);const p=await De.get(`${X}/formationstructure`,{headers:{Authorization:`Bearer ${c}`},params:{year:g}}),{structures:k=[],totalFormations:Z=0,totalStructures:ee=0}=p.data||{};l(k),x(Z),b(ee),f(null)}catch(p){f("Erreur lors du chargement des données"),console.error("Erreur:",p),l([]),x(0),b(0)}finally{i(!1),S(!1)}};u.useEffect(()=>{_()},[g]);const K=()=>{S(!0),_()},Q=c=>{y(c.target.value)},B=(c,p)=>{if(p===0)return t.palette.info.main;const k=c/p;return k>=.8?t.palette.success.main:k>=.5?t.palette.warning.main:t.palette.info.main},A=c=>{const p=[t.palette.primary.main,t.palette.secondary.main,t.palette.success.main,t.palette.warning.main,t.palette.info.main,t.palette.error.main];return p[c%p.length]},d=n&&n.length>0?Math.max(...n.map(c=>c.nombreFormations)):0;return r&&!v?e.jsx(s,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh",children:e.jsx(_e,{size:60,thickness:4})}):e.jsxs(s,{sx:{p:3,width:"100%",mx:"auto"},children:[e.jsx(s,{sx:{mb:4},children:e.jsxs(At,{children:[e.jsxs(s,{display:"flex",alignItems:"center",children:[e.jsx(Ee,{sx:{fontSize:40,color:"primary.main",mr:2}}),e.jsxs(s,{children:[e.jsx(o,{variant:"h4",fontWeight:"bold",color:"primary.main",children:"Vue d'ensemble des spécialisations fonctionnelles (Formations Métiers)"}),e.jsx(o,{variant:"body1",color:"text.secondary",children:"Formations fonctionnelles réalisées"})]})]}),e.jsxs(s,{display:"flex",alignItems:"center",gap:2,children:[e.jsxs(ie,{variant:"outlined",size:"small",sx:{minWidth:120},children:[e.jsx(le,{id:"year-select-label",children:e.jsxs(s,{display:"flex",alignItems:"center",children:[e.jsx(G,{sx:{fontSize:20,mr:1}})," Année"]})}),e.jsx(oe,{labelId:"year-select-label",value:g,onChange:Q,label:e.jsxs(s,{display:"flex",alignItems:"center",children:[e.jsx(G,{sx:{fontSize:20,mr:1}})," Année"]}),children:R.map(c=>e.jsx(ce,{value:c,children:c},c))})]}),e.jsx(ze,{title:"Actualiser les données",children:e.jsx(Ae,{onClick:K,disabled:v,sx:{bgcolor:"primary.main",color:"white","&:hover":{bgcolor:"primary.dark"}},children:e.jsx(Le,{sx:{animation:v?"spin 1s linear infinite":"none","@keyframes spin":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}}})})})]})]})}),e.jsx(zt,{children:e.jsxs(m,{container:!0,spacing:3,children:[e.jsx(m,{item:!0,xs:12,md:6,children:e.jsxs(s,{display:"flex",alignItems:"center",sx:{background:"#009dff0a",borderRadius:3,padding:2},children:[e.jsx(U,{sx:{fontSize:48,mr:2,opacity:.9}}),e.jsxs(s,{children:[e.jsx(o,{variant:"h3",fontWeight:"bold",children:a}),e.jsx(o,{variant:"h6",sx:{opacity:.9},children:"Formations de type spécialisation fonctionnelle déjà effectuées"})]})]})}),e.jsx(m,{item:!0,xs:12,md:6,children:e.jsxs(s,{display:"flex",alignItems:"center",sx:{background:"#ffa60016",borderRadius:3,padding:2},children:[e.jsx(he,{sx:{fontSize:48,mr:2,opacity:.9}}),e.jsxs(s,{children:[e.jsx(o,{variant:"h3",fontWeight:"bold",children:h}),e.jsx(o,{variant:"h6",sx:{opacity:.9},children:"Structures concernées"})]})]})})]})}),j&&e.jsx(Pe,{severity:"error",sx:{mb:3,borderRadius:2},children:j}),n&&n.length>0?e.jsx(m,{container:!0,spacing:3,children:n.map((c,p)=>e.jsx(m,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsx(Ct,{children:e.jsxs(V,{sx:{p:3},children:[e.jsxs(s,{display:"flex",alignItems:"center",mb:2,children:[e.jsx(It,{bgcolor:A(p),children:e.jsx(he,{sx:{fontSize:32}})}),e.jsxs(s,{ml:2,flex:1,children:[e.jsx(o,{variant:"h3",fontWeight:"bold",children:e.jsx(se,{label:c.abbreviation,size:"big",variant:"outlined",sx:{mt:.5}})}),c.abbreviation&&e.jsx("span",{style:{fontSize:"10px",lineHeight:"1.2",padding:"0px"},children:c.nom})]})]}),e.jsx($e,{sx:{my:2}}),e.jsxs(s,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Formations réalisées"}),e.jsxs(s,{display:"flex",alignItems:"center",children:[e.jsx(We,{sx:{fontSize:20,color:B(c.nombreFormations,d),mr:1}}),e.jsx(o,{variant:"h4",fontWeight:"bold",color:"primary.main",children:c.nombreFormations})]})]}),e.jsx(Oe,{variant:"determinate",value:d>0?c.nombreFormations/d*100:0,sx:{height:8,borderRadius:4,bgcolor:F(t.palette.primary.main,.1),"& .MuiLinearProgress-bar":{bgcolor:B(c.nombreFormations,d),borderRadius:4}}}),e.jsx(o,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:a>0&&c.nombreFormations/a*100>=.1?`${(c.nombreFormations/a*100).toFixed(1)}% du total`:"Moins de 0.1%"})]})})},c.id))}):e.jsxs(Me,{elevation:0,sx:{p:6,textAlign:"center",bgcolor:F(t.palette.info.main,.05),borderRadius:3,border:`1px solid ${F(t.palette.info.main,.2)}`},children:[e.jsx(qe,{sx:{fontSize:64,color:"info.main",mb:2}}),e.jsxs(o,{variant:"h6",color:"info.main",gutterBottom:!0,children:["Aucune formation de type spécialisation fonctionnelle réalisée en ",g]}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"Aucune donnée disponible pour cette période."})]}),e.jsx(s,{sx:{mt:4,p:2,bgcolor:F(t.palette.primary.main,.05),borderRadius:2},children:e.jsxs(o,{variant:"body2",color:"text.secondary",align:"center",children:[e.jsx(Be,{sx:{fontSize:16,mr:1,verticalAlign:"middle"}}),"Structures avec formations de type spécialisation fonctionnelle réalisées en ",g]})})]})},Ot=I(ae)(({theme:t})=>({borderRadius:16,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",transition:"all 0.3s ease-in-out",border:`1px solid ${F(t.palette.primary.main,.1)}`,"&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 25px rgba(0, 0, 0, 0.12)"}})),Mt=I(D)(({theme:t,bgcolor:r})=>({background:`linear-gradient(135deg, ${r}, ${F(r,.7)})`,width:64,height:64,boxShadow:`0 4px 15px ${F(r,.3)}`})),Dt=I(s)(({theme:t})=>({borderRadius:20,color:"#26449dff",marginBottom:t.spacing(3)})),_t=I(s)(({theme:t})=>({background:"linear-gradient(135deg, #c9d8ed, #ffffff)",padding:t.spacing(3),borderRadius:20,minHeight:"100px",width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:t.spacing(2)})),Et=()=>{const t=q(),[r,i]=u.useState(!0),[n,l]=u.useState([]),[a,x]=u.useState(0),[h,b]=u.useState(0),[j,f]=u.useState(null),[v,S]=u.useState(!1),[g,y]=u.useState(new Date().getFullYear()),[R,J]=u.useState([]),X="";u.useEffect(()=>{const d=new Date().getFullYear(),c=[];for(let p=2024;p<=d;p++)c.push(p);J(c)},[]);const _=async()=>{const d=localStorage.getItem("token");try{i(!0);const c=await De.get(`${X}/formationcategorie`,{headers:{Authorization:`Bearer ${d}`},params:{year:g}}),{formations:p,total:k,totalSessions:Z}=c.data,ee=p.map(te=>{let $,O,M;switch(te.type){case"centreexcellence":$=rt,O=t.palette.primary.main,M="Formations de transition entre différents niveaux ou domaines";break;case"autoFormation":$=tt,O=t.palette.success.main,M="Formations en autonomie et apprentissage individuel";break;case"transversales":$=et,O=t.palette.warning.main,M="Formations multi-disciplinaires et compétences générales";break;case"metier":$=Ze,O=t.palette.info.main,M="Formations spécialisées dans un domaine fonctionnelle";break;case"individuelles":$=st,O=t.palette.secondary.main,M="Formations personnalisées selon les besoins individuels";break;default:$=U,O=t.palette.grey[500],M="Type de formation inconnu"}return{...te,id:te.type,icon:$,color:O,description:M}});l(ee),x(k),b(Z||0),f(null)}catch(c){f("Erreur lors du chargement des données"),console.error("Erreur:",c),l([]),x(0),b(0)}finally{i(!1),S(!1)}};u.useEffect(()=>{_()},[g]);const K=()=>{S(!0),_()},Q=d=>{y(d.target.value)},B=(d,c)=>{if(c===0)return t.palette.info.main;const p=d/c;return p>=.8?t.palette.success.main:p>=.5?t.palette.warning.main:t.palette.info.main},A=n.length>0?Math.max(...n.map(d=>d.count)):0;return r&&!v?e.jsx(s,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh",children:e.jsx(_e,{size:60,thickness:4})}):e.jsxs(s,{sx:{p:3,width:"100%",mx:"auto"},children:[e.jsx(s,{sx:{mb:4},children:e.jsxs(_t,{children:[e.jsxs(s,{display:"flex",alignItems:"center",children:[e.jsx(Ee,{sx:{fontSize:40,color:"primary.main",mr:2}}),e.jsxs(s,{children:[e.jsx(o,{variant:"h4",fontWeight:"bold",color:"primary.main",children:"Répartition par type de formation"}),e.jsx(o,{variant:"body1",color:"text.secondary",children:"Nombre de formations réalisées pour chaque type"})]})]}),e.jsxs(s,{display:"flex",alignItems:"center",gap:2,children:[e.jsxs(ie,{variant:"outlined",size:"small",sx:{minWidth:120},children:[e.jsx(le,{id:"year-select-label",children:e.jsxs(s,{display:"flex",alignItems:"center",children:[e.jsx(G,{sx:{fontSize:20,mr:1}})," Année"]})}),e.jsx(oe,{labelId:"year-select-label",value:g,onChange:Q,label:e.jsxs(s,{display:"flex",alignItems:"center",children:[e.jsx(G,{sx:{fontSize:20,mr:1}})," Année"]}),children:R.map(d=>e.jsx(ce,{value:d,children:d},d))})]}),e.jsx(ze,{title:"Actualiser les données",children:e.jsx(Ae,{onClick:K,disabled:v,sx:{bgcolor:"primary.main",color:"white","&:hover":{bgcolor:"primary.dark"}},children:e.jsx(Le,{sx:{animation:v?"spin 1s linear infinite":"none","@keyframes spin":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}}})})})]})]})}),e.jsx(Dt,{children:e.jsxs(m,{container:!0,spacing:3,children:[e.jsx(m,{item:!0,xs:12,md:4,children:e.jsxs(s,{display:"flex",alignItems:"center",sx:{background:"#009dff0a",borderRadius:3,padding:2},children:[e.jsx(U,{sx:{fontSize:48,mr:2,opacity:.9}}),e.jsxs(s,{children:[e.jsx(o,{variant:"h3",fontWeight:"bold",children:a}),e.jsx(o,{variant:"h6",sx:{opacity:.9},children:"Total formations réalisées"})]})]})}),e.jsx(m,{item:!0,xs:12,md:4,children:e.jsxs(s,{display:"flex",alignItems:"center",sx:{background:"#ffa60016",borderRadius:3,padding:2},children:[e.jsx(Be,{sx:{fontSize:48,mr:2,opacity:.9}}),e.jsxs(s,{children:[e.jsx(o,{variant:"h3",fontWeight:"bold",children:n.length}),e.jsx(o,{variant:"h6",sx:{opacity:.9},children:"Types de formations actifs"})]})]})}),e.jsx(m,{item:!0,xs:12,md:4,children:e.jsxs(s,{display:"flex",alignItems:"center",sx:{background:"#4caf5014",borderRadius:3,padding:2},children:[e.jsx(Qe,{sx:{fontSize:48,mr:2,opacity:.9}}),e.jsxs(s,{children:[e.jsx(o,{variant:"h3",fontWeight:"bold",children:h}),e.jsx(o,{variant:"h6",sx:{opacity:.9},children:"Total sessions organisées"})]})]})})]})}),j&&e.jsx(Pe,{severity:"error",sx:{mb:3,borderRadius:2},children:j}),n.length>0?e.jsx(m,{container:!0,spacing:3,children:n.map(d=>{const c=d.icon;return e.jsx(m,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsx(Ot,{children:e.jsxs(V,{sx:{p:3},children:[e.jsxs(s,{display:"flex",alignItems:"center",mb:2,children:[e.jsx(Mt,{bgcolor:d.color,children:e.jsx(c,{sx:{fontSize:32}})}),e.jsxs(s,{ml:2,flex:1,children:[e.jsx(o,{variant:"h6",fontWeight:"bold",children:d.label}),e.jsx(o,{variant:"caption",color:"text.secondary",sx:{lineHeight:1.2},children:d.description})]})]}),e.jsx($e,{sx:{my:2}}),e.jsxs(s,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Nombre de formations"}),e.jsxs(s,{display:"flex",alignItems:"center",children:[e.jsx(We,{sx:{fontSize:20,color:B(d.count,A),mr:1}}),e.jsx(o,{variant:"h4",fontWeight:"bold",color:"primary.main",children:d.count})]})]}),e.jsx(Oe,{variant:"determinate",value:A>0?d.count/A*100:0,sx:{height:8,borderRadius:4,bgcolor:F(d.color,.1),"& .MuiLinearProgress-bar":{bgcolor:d.color,borderRadius:4}}}),e.jsx(o,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:a>0&&d.count/a*100>=.1?`${(d.count/a*100).toFixed(1)}% du total`:"Moins de 0.1%"}),e.jsx(s,{sx:{mt:2},children:e.jsx(se,{label:d.count===A?"Type le plus utilisé":d.count>a*.2?"Usage élevé":"Usage modéré",size:"small",color:d.count===A?"success":d.count>a*.2?"warning":"default",variant:"outlined"})})]})})},d.id)})}):e.jsxs(Me,{elevation:0,sx:{p:6,textAlign:"center",bgcolor:F(t.palette.info.main,.05),borderRadius:3,border:`1px solid ${F(t.palette.info.main,.2)}`},children:[e.jsx(qe,{sx:{fontSize:64,color:"info.main",mb:2}}),e.jsxs(o,{variant:"h6",color:"info.main",gutterBottom:!0,children:["Aucune formation réalisée en ",g]}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"Aucune donnée disponible pour cette période."})]}),e.jsx(s,{sx:{mt:4,p:2,bgcolor:F(t.palette.primary.main,.05),borderRadius:2},children:e.jsxs(o,{variant:"body2",color:"text.secondary",align:"center",children:[e.jsx(U,{sx:{fontSize:16,mr:1,verticalAlign:"middle"}}),"Répartition des formations par type pour l'année ",g]})})]})},w=t=>t.toString().padStart(4,"0");function sr(){const[t,r]=u.useState({totalFormations:0,formationsEffectuees:0,totalHommesFormes:0,totalFemmesFormes:0,totalformationsmoisactuel:0});return u.useEffect(()=>{(async()=>{const n=localStorage.getItem("token"),l="";try{const a=await fetch(`${l}/dashvalues`,{headers:{Authorization:`Bearer ${n}`}});if(!a.ok)throw new Error("Erreur lors de la récupération des données du tableau de bord");const x=await a.json();r(x)}catch(a){console.error(a)}})()},[]),e.jsxs(m,{container:!0,rowSpacing:4.5,columnSpacing:2,children:[e.jsx(m,{item:!0,xs:12,sx:{mb:-3},children:e.jsx(o,{variant:"h5",children:"Dashboard"})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(s,{sx:{height:"5px",background:"linear-gradient(45deg, blue, yellow)",borderRadius:"5px",mb:-30}})}),e.jsx(m,{item:!0,xs:12,sm:6,md:4,lg:3,mt:-3,children:e.jsxs(s,{sx:{borderRadius:1.5,mt:0},children:[" ",e.jsx(P,{title:"Total personnels formés",count:w(Number(w(t.totalHommesFormes))+Number(w(t.totalFemmesFormes))),percentage:5.3,extra:w(Number(w(t.totalHommesFormes))+Number(w(t.totalFemmesFormes)))})]})}),e.jsx(m,{item:!0,xs:12,sm:6,md:4,lg:3,mt:-3,children:e.jsx(s,{sx:{borderRadius:2,mt:0},children:e.jsx(P,{title:"Formations déjà effectuées",count:w(t.formationsEffectuees),percentage:7.5,extra:w(t.formationsEffectuees)})})}),e.jsx(m,{item:!0,xs:12,sm:6,md:4,lg:3,mt:-3,children:e.jsx(s,{sx:{borderRadius:2,mt:0},children:e.jsx(P,{title:"Nombre d'hommes formés",count:w(t.totalHommesFormes),percentage:2.4,isLoss:!0,color:"warning",extra:w(t.totalHommesFormes)})})}),e.jsx(m,{item:!0,xs:12,sm:6,md:4,lg:3,mt:-3,children:e.jsx(s,{sx:{borderRadius:2,mt:0},children:e.jsx(P,{title:"Nombre de femmes formées",count:w(t.totalFemmesFormes),percentage:7.4,isLoss:!0,color:"warning",extra:w(t.totalFemmesFormes)})})}),e.jsx(m,{item:!0,xs:12,md:7,lg:8,mt:-2,children:e.jsx(vt,{})}),e.jsxs(m,{item:!0,xs:12,md:5,lg:4,mt:-3,children:[e.jsx(Rt,{totalFormations:w(t.totalFormations),formationsEffectuees:w(t.formationsEffectuees)}),e.jsx(kt,{monthlycount:t.totalformationsmoisactuel})]}),e.jsx(m,{style:{width:"100%"},children:e.jsx(Et,{})}),e.jsx(m,{style:{width:"100%"},children:e.jsx($t,{})})]})}export{sr as default};
