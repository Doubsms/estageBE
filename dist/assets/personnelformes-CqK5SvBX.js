import{n as z,aD as U,aE as _,t as F,u as X,r as o,j as e,J as w,O as ee,aY as re,aZ as te,a_ as se,aM as ie,G as a,z as b,B as n,A as T,T as l,v as h,N as ne,a$ as oe,U as ae,F as le,b0 as ce}from"./index-zHPv1lze.js";import{S as de}from"./Snackbar-XurLPfxZ.js";import{A as ue}from"./Alert-D6te_eKs.js";import{P as O}from"./People-RwhYgLWm.js";import{F as xe}from"./FilterList-tzX0eq5I.js";import{A as me}from"./Autocomplete-DkJdCr17.js";import{T as L}from"./TextField-DNVhVnCv.js";import{C as D}from"./CalendarToday-BYxDq_1X.js";import{F as he,S as fe}from"./Select-DCG_CkE0.js";import{I as pe}from"./OutlinedInput-C5vYvqQm.js";import{M as y}from"./MenuItem-D-1uk7AZ.js";import{I as je}from"./InputAdornment-BgDE6Kz5.js";import{B as ge}from"./Button-0T1tR8_c.js";import{R as be}from"./RestartAlt-Ft-AlI1n.js";import{C as ve}from"./CircularProgress-BHFhENdB.js";import{L as Se}from"./ListItem-CSuwil7H.js";import{b as ye,A as Ee,a as Ie}from"./AccordionSummary-2JcKKmJQ.js";import"./Close-DS868zx3.js";import"./FormHelperText-BXMwkblB.js";import"./useFormControl-BwsGWz84.js";import"./ButtonGroupButtonContext-BYVHV5Ft.js";var f={},N;function Ce(){if(N)return f;N=1;var i=z();Object.defineProperty(f,"__esModule",{value:!0}),f.default=void 0;var d=i(U()),x=_();return f.default=(0,d.default)((0,x.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search"),f}var Re=Ce();const Me=F(Re);var p={},P;function Ae(){if(P)return p;P=1;var i=z();Object.defineProperty(p,"__esModule",{value:!0}),p.default=void 0;var d=i(U()),x=_();return p.default=(0,d.default)((0,x.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person"),p}var we=Ae();const Te=F(we),Xe=()=>{const i=X(),[d,x]=o.useState([]),[v,E]=o.useState([]),[k,Q]=o.useState(!0),[c,I]=o.useState({open:!1,message:"",severity:"success"}),[j,C]=o.useState(""),[m,R]=o.useState(""),[g,M]=o.useState(""),[W,q]=o.useState([]),$="",H={headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}},Y=(r,t="success")=>{I({open:!0,message:r,severity:t})},A=(r,t)=>{t!=="clickaway"&&I(s=>({...s,open:!1}))},B=async()=>{try{const r=await fetch(`${$}/listepersonelformescentreexcellence`,{method:"GET",headers:H.headers});if(r.ok){const t=await r.json();x(t),E(t);const s=new Date().getFullYear(),u=[];for(let S=2025;S<=s;S++)u.push(String(S));q(u)}else throw new Error("Échec du chargement des données")}catch{Y("Erreur de chargement du personnel formé","error")}finally{Q(!1)}},G=()=>{let r=d;if(g){const t=g.toLowerCase();r=r.filter(s=>s.NOM&&s.NOM.toLowerCase().includes(t)||s.PRENOM&&s.PRENOM.toLowerCase().includes(t)||s.MATRICULE&&s.MATRICULE.toLowerCase().includes(t)||s.FONCTION&&s.FONCTION.toLowerCase().includes(t)||s.GRADE&&s.GRADE.toLowerCase().includes(t)||s.CATEGORIE&&s.CATEGORIE.toLowerCase().includes(t)||s.STRUCTURE_HIERARCHY&&s.STRUCTURE_HIERARCHY.toLowerCase().includes(t))}j&&(r=r.filter(t=>t.DATE_DEB?t.DATE_DEB.split(", ").map(u=>u.trim()).some(u=>u.startsWith(j)):!1)),m&&(m==="Q1"?r=r.filter(t=>t.MODULES_QUADRIMESTRE1&&t.MODULES_QUADRIMESTRE1.split(", ").includes("1")):m==="Q2"&&(r=r.filter(t=>t.MODULES_QUADRIMESTRE2&&t.MODULES_QUADRIMESTRE2.split(", ").includes("1")))),E(r)},J=()=>{C(""),R(""),M("")};o.useEffect(()=>{B()},[]),o.useEffect(()=>{G()},[j,m,g]);const Z=r=>r?r.split(" / ").join(" > "):"Structure non définie",K=r=>r?r.split(" | ").map((t,s)=>e.jsx(h,{label:t,size:"small",sx:{m:.5},color:"primary",variant:"outlined"},s)):"Aucun module",V=r=>r?r.split(", ").join(" | "):"Dates non disponibles";return e.jsxs(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsx(de,{open:c.open,autoHideDuration:4e3,onClose:A,anchorOrigin:{vertical:"top",horizontal:"center"},TransitionComponent:ee,TransitionProps:{direction:"down"},sx:{mt:"20px",zIndex:9999},children:e.jsx(ue,{onClose:A,severity:c.severity,sx:{fontWeight:500,fontSize:"1.05rem",borderRadius:2,minWidth:300,textAlign:"center",justifyContent:"center",backgroundColor:c.severity==="success"?"#e8f5e9":c.severity==="error"?"#ffebee":c.severity==="warning"?"#fff8e1":"#e3f2fd",color:c.severity==="success"?"#2e7d32":c.severity==="error"?"#c62828":c.severity==="warning"?"#f57f17":"#0277bd",boxShadow:2,"& .MuiAlert-icon":{color:"inherit"},"& .MuiAlert-message":{width:"100%"}},iconMapping:{success:e.jsx(ie,{size:24}),error:e.jsx(se,{size:24}),warning:e.jsx(te,{size:24}),info:e.jsx(re,{size:24})},children:c.message})}),e.jsxs(a,{container:!0,spacing:3,p:3,children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(b,{sx:{p:0,borderRadius:4,background:"linear-gradient(45deg, #c6daf767, #91adf36f)",color:"black",boxShadow:i.shadows[3]},children:e.jsxs(n,{display:"flex",alignItems:"center",padding:1,children:[e.jsx(T,{sx:{bgcolor:"rgba(244, 247, 249, 0.93)",mr:2,width:60,height:60},children:e.jsx(O,{sx:{fontSize:32,color:"blue"}})}),e.jsxs(n,{children:[e.jsx(l,{variant:"h4",fontWeight:700,sx:{color:"blue"},children:"Personnels Formés au Centre d'Excellence"}),e.jsx(l,{variant:"body1",sx:{opacity:.9},children:"Liste des personnels ayant suivi des formations au centre d'excellence"})]})]})})}),e.jsx(a,{item:!0,xs:12,children:e.jsxs(b,{sx:{p:3,borderRadius:4,boxShadow:i.shadows[5],borderLeft:`5px solid ${i.palette.primary.main}`,backgroundColor:"#fff",transition:"box-shadow 0.3s ease","&:hover":{boxShadow:i.shadows[8]}},children:[e.jsxs(n,{display:"flex",alignItems:"center",mb:3,children:[e.jsx(xe,{sx:{mr:1,color:i.palette.primary.main,fontSize:24}}),e.jsx(l,{variant:"h6",fontWeight:700,color:"text.primary",children:"Filtres"})]}),e.jsxs(a,{container:!0,spacing:2,alignItems:"flex-end",children:[e.jsxs(a,{item:!0,xs:12,md:4,container:!0,spacing:0,children:[e.jsx(a,{item:!0,xs:6,sx:{pr:{xs:0,sm:.5}},children:e.jsx(me,{options:W,value:j,onChange:(r,t)=>C(t),noOptionsText:"Aucune année disponible",renderInput:r=>e.jsx(L,{...r,label:"Année de formation",variant:"outlined",fullWidth:!0,InputProps:{...r.InputProps,startAdornment:e.jsx(D,{sx:{color:i.palette.primary.main,mr:1}})},sx:{"& .MuiOutlinedInput-root":{borderRadius:3,height:45,width:150},"& .MuiInputBase-input":{fontSize:14}}})})}),e.jsx(a,{item:!0,xs:6,sx:{pl:{xs:0,sm:.5}},children:e.jsxs(he,{children:[e.jsx(pe,{id:"quadrimestre-label",children:"Quadrimestre"}),e.jsxs(fe,{labelId:"quadrimestre-label",value:m,onChange:r=>R(r.target.value),label:"Quadrimestre",sx:{borderRadius:3,height:45,width:150,"& .MuiOutlinedInput-notchedOutline":{borderColor:"divider"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:i.palette.primary.main}},children:[e.jsx(y,{value:"",children:e.jsx("em",{children:"Tous les quadrimestres"})}),e.jsx(y,{value:"Q1",children:"Quadrimestre 1"}),e.jsx(y,{value:"Q2",children:"Quadrimestre 2"})]})]})})]}),e.jsx(a,{item:!0,sx:{marginLeft:"35%"},children:e.jsx(L,{label:"Rechercher un personnel",variant:"outlined",fullWidth:!0,value:g,onChange:r=>M(r.target.value),placeholder:"Nom, matricule...",InputProps:{startAdornment:e.jsx(je,{position:"start",children:e.jsx(Me,{sx:{color:"action.active"}})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:3,height:45,width:320}}})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(ge,{variant:"outlined",onClick:J,startIcon:e.jsx(be,{}),sx:{width:"30%",height:35,borderRadius:3,fontWeight:600,textTransform:"none",fontSize:16,borderColor:"#bfc9dcc4",color:"primary.main","&:hover":{backgroundColor:"#a2b6ed22",color:"#0f2b59ff",borderColor:"primary.main"},transition:"all 0.2s ease-in-out"},children:"Réinitialiser les filtres"})})]}),e.jsx(n,{display:"flex",justifyContent:"flex-end",mt:2,children:e.jsx(h,{icon:e.jsx(Te,{sx:{fontSize:18}}),label:`${v.length} personnels trouvés`,sx:{fontWeight:500,fontSize:14,backgroundColor:"white",border:"solid 1px #bfc9dcc4",px:1,"& .MuiChip-icon":{ml:.5,mr:.5}}})})]})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(b,{sx:{p:3,borderRadius:4,boxShadow:i.shadows[3],display:"flex",flexDirection:"column"},children:k?e.jsx(n,{display:"flex",justifyContent:"center",alignItems:"center",height:300,children:e.jsx(ve,{size:60})}):v.length===0?e.jsxs(n,{sx:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",p:4},children:[e.jsx(O,{sx:{fontSize:60,color:"action.disabled",mb:2}}),e.jsx(l,{variant:"h6",color:"textSecondary",gutterBottom:!0,children:"Aucun personnel trouvé"}),e.jsx(l,{variant:"body1",color:"textSecondary",children:d.length===0?"Aucun personnel formé n'a été trouvé dans le système":"Aucun résultat ne correspond à vos critères de filtrage"})]}):e.jsx(ne,{sx:{flex:1,overflow:"auto",maxHeight:"60vh",pr:1},children:v.map(r=>e.jsx(n,{component:w.div,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsx(b,{sx:{mb:3,borderRadius:3,overflow:"hidden",boxShadow:i.shadows[1],transition:"transform 0.3s, box-shadow 0.3s","&:hover":{transform:"translateY(-3px)",boxShadow:i.shadows[4]}},children:e.jsxs(Se,{sx:{py:2,alignItems:"flex-start"},children:[e.jsx(oe,{children:e.jsx(T,{sx:{bgcolor:i.palette.primary.light,color:i.palette.primary.contrastText,width:56,height:56,mt:1},children:r.NOM.charAt(0).toUpperCase()})}),e.jsx(ae,{primary:e.jsxs(l,{variant:"h6",fontWeight:600,children:[r.NOM," ",r.PRENOM,r.NOMMARI&&` (${r.NOMMARI})`]}),secondary:e.jsxs(n,{sx:{mt:1},children:[e.jsxs(n,{display:"flex",flexWrap:"wrap",alignItems:"center",mb:1,children:[e.jsx(h,{label:`Matricule: ${r.MATRICULE}`,size:"small",sx:{mr:1,mb:1}}),e.jsx(h,{label:`Fonction: ${r.FONCTION}`,size:"small",sx:{mr:1,mb:1}})]}),e.jsxs(l,{variant:"body2",sx:{mb:1},children:[e.jsx("strong",{children:"Structure:"})," ",Z(r.STRUCTURE_HIERARCHY)]}),e.jsxs(l,{variant:"body2",sx:{mb:1},children:[e.jsx("strong",{children:"Téléphone:"})," ",r.TELEPHONE||"Non renseigné"]}),e.jsx(n,{sx:{mb:1},children:e.jsxs(ye,{sx:{borderRadius:2,boxShadow:"0px 1px 3px rgba(0,0,0,0.1)","&:before":{display:"none"},"&.Mui-expanded":{margin:0}},children:[e.jsx(Ee,{expandIcon:e.jsx(ce,{}),"aria-controls":`panel-modules-${r.IDPERSONNEL}`,id:`panel-modules-${r.IDPERSONNEL}`,sx:{minHeight:40,"& .MuiAccordionSummary-content":{margin:"10px 0"}},children:e.jsxs(l,{variant:"body2",sx:{fontWeight:500,display:"flex",alignItems:"center"},children:[e.jsx(le,{sx:{fontSize:18,mr:1}}),"Modules suivis (",r.MODULES_INTITULE?.split(" | ").length||0,")"]})}),e.jsx(Ie,{sx:{pt:0,pb:1},children:e.jsx(n,{children:K(r.MODULES_INTITULE)})})]})}),e.jsxs(l,{variant:"body2",sx:{mb:1},children:[e.jsx("strong",{children:"Enseignants:"})," ",r.NOMS_ENSEIGNANTS||"Non renseigné"]}),e.jsx(n,{display:"flex",flexWrap:"wrap",alignItems:"center",children:e.jsx(h,{label:`Dates: ${V(r.DATE_DEB)}`,size:"small",sx:{mr:1,mb:1},color:"info",icon:e.jsx(D,{fontSize:"small"})})})]})})]})})},r.IDPERSONNEL))})})})]})]})};export{Xe as default};
