import{l as F,j as e,r as n,u as ae,E as ie,B as i,H as se,J as b,z as ne,A as P,T as s,K as le,L as ce,N as de,O as pe,s as p,C as Y,Q as xe,R as ue,U as fe,x as R,V as he,I as me,W as ge,X as L,Y as I,v as be}from"./index-zHPv1lze.js";import{a as T}from"./index-C3O71W1x.js";import{T as Ie}from"./TextField-DNVhVnCv.js";import{D as v}from"./Description-Dd72SfDg.js";import{L as ve}from"./ListItem-CSuwil7H.js";import{A as B}from"./Assignment-jETtBEfQ.js";import{C as V}from"./CheckCircle-BB09QyVE.js";import{U as j}from"./Upload-C6xz4iyc.js";import{A as je}from"./Archive-D2QOqqZQ.js";import{P as Ce}from"./Pagination-BeHNtj-4.js";import{D as ye}from"./DialogTitle-CCgKuUmv.js";import{C as Oe}from"./Close-B5GqWx1j.js";import{D as Te,a as Re}from"./DialogContent-COvIddmc.js";import{B as x}from"./Button-0T1tR8_c.js";import{C as W}from"./CircularProgress-BHFhENdB.js";import{D as Fe}from"./DialogActions-CZ9LuKoL.js";import"./OutlinedInput-C5vYvqQm.js";import"./useFormControl-BwsGWz84.js";import"./Select-DCG_CkE0.js";import"./FormHelperText-BXMwkblB.js";import"./LastPage-aHJdqG80.js";import"./ButtonGroupButtonContext-BYVHV5Ft.js";const Ae=F(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-5 14H7v-2h7zm3-4H7v-2h10zm0-4H7V7h10z"}),"Article"),ke=F(e.jsx("path",{d:"M19 3H4.99c-1.11 0-1.98.9-1.98 2L3 19c0 1.1.88 2 1.99 2H19c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 12h-4c0 1.66-1.35 3-3 3s-3-1.34-3-3H4.99V5H19zm-3-5h-2V7h-4v3H8l4 4z"}),"MoveToInbox"),$=F(e.jsx("path",{d:"m15 3 2.3 2.3-2.89 2.87 1.42 1.42L18.7 6.7 21 9V3zM3 9l2.3-2.3 2.87 2.89 1.42-1.42L6.7 5.3 9 3H3zm6 12-2.3-2.3 2.89-2.87-1.42-1.42L5.3 17.3 3 15v6zm12-6-2.3 2.3-2.87-2.89-1.42 1.42 2.89 2.87L15 21h6z"}),"ZoomOutMap"),we=p(Re)(({theme:r})=>({"& .MuiDialog-paper":{borderRadius:24,overflow:"hidden",boxShadow:r.shadows[10],maxWidth:"90vw",maxHeight:"90vh"}}));p(Y)(({theme:r})=>({transition:"all 0.3s ease",border:`1px solid ${r.palette.divider}`,borderRadius:16,overflow:"hidden","&:hover":{transform:"translateY(-5px)",boxShadow:r.shadows[6],borderColor:r.palette.primary.main}}));p("div")({height:"50vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f8f9fa",position:"relative",overflow:"hidden",borderRadius:12});const U=p("div")(({theme:r})=>({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:r.spacing(4),textAlign:"center",backgroundColor:r.palette.grey[100],borderRadius:16,height:"100%"})),Q=p(be)(({theme:r})=>({borderRadius:12,padding:r.spacing(.5),transition:"all 0.2s","&:hover":{transform:"scale(1.05)",boxShadow:r.shadows[2]}})),Me=p(({className:r,...u})=>e.jsx(R,{...u,classes:{popper:r}}))(({theme:r})=>({"& .MuiTooltip-tooltip":{backgroundColor:r.palette.primary.main,color:r.palette.primary.contrastText,fontSize:"0.875rem",fontWeight:500,padding:r.spacing(1,1.5),borderRadius:8,boxShadow:r.shadows[3],border:`1px solid ${r.palette.primary.dark}`,maxWidth:220},"& .MuiTooltip-arrow":{color:r.palette.primary.main}})),ro=()=>{const[r,u]=n.useState(!1),[l,A]=n.useState(null),[G,Z]=n.useState([]),[f,_]=n.useState(""),[k,w]=n.useState(!1),[d,M]=n.useState(0),[h,S]=n.useState(!1),[D,N]=n.useState(""),J=ae();ie(J.breakpoints.down("sm"));const[z,K]=n.useState(1),m=5,C="",y=async()=>{w(!0);const o=localStorage.getItem("token");try{const a=await T.get(`${C}/listeformationeffectuees`,{headers:{Authorization:`Bearer ${o}`}});Z(a.data)}catch{I.error("Erreur lors de la récupération des formations.")}finally{w(!1)}};n.useEffect(()=>{y()},[]);const X=o=>{A(o),u(!0),M(0)},O=()=>{u(!1),A(null)},H=async(o,a,t)=>{const c=o.target.files[0];if(c)if(q(c)){S(!0),N(a);try{a==="convocation"?await ee(c,t):await oe(c,t),I.success("Fichier téléversé avec succès !")}catch{I.error("Erreur lors du téléversement du fichier.")}finally{S(!1),N("")}}else I.error("Format de fichier non valide. Veuillez téléverser un PDF ou un document Word.")},q=o=>["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(o.type),ee=async(o,a)=>{const t=new FormData;t.append("FICHIERCONVOCATION",o),t.append("IDFORMATIONM",a);const c=localStorage.getItem("token");await T.patch(`${C}/updateconvocation`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${c}`}}),y()},oe=async(o,a)=>{const t=new FormData;t.append("FICHIERRAPPORTFORMATION",o),t.append("IDFORMATIONM",a);const c=localStorage.getItem("token");await T.patch(`${C}/updaterapport`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${c}`}}),y()},g=G.filter(o=>o.INTITULE.toLowerCase().includes(f.toLowerCase())),E=z*m,re=E-m,te=g.slice(re,E);return e.jsxs(i,{sx:{padding:3,minHeight:"100vh",backgroundColor:"#f5f5f5",backgroundImage:"linear-gradient(120deg, #e0f7fa 0%, #f3e5f5 100%)"},children:[e.jsx(se,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0}),e.jsx(b.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs(ne,{sx:{p:4,borderRadius:4,boxShadow:3,bgcolor:"background.paper",minHeight:"70vh",background:"linear-gradient(145deg, #ffffff, #f5f5f5)",border:"1px solid rgba(25, 118, 210, 0.1)"},children:[e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,flexWrap:"wrap",gap:2},children:[e.jsxs(i,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(P,{sx:{bgcolor:"primary.main",width:56,height:56,boxShadow:2},children:e.jsx(ke,{fontSize:"large"})}),e.jsx(s,{variant:"h4",sx:{color:"primary.main",fontWeight:"bold",fontSize:{xs:"1.5rem",sm:"2rem"}},children:"Formations Effectuées"})]}),e.jsx(Ie,{variant:"outlined",placeholder:"Rechercher une formation...",value:f,onChange:o=>_(o.target.value),sx:{width:{xs:"100%",sm:"40%"},"& .MuiOutlinedInput-root":{borderRadius:8}},InputProps:{startAdornment:e.jsx(le,{sx:{mr:1,color:"action.active"}})}})]}),k&&e.jsx(ce,{sx:{mb:3,height:6,borderRadius:3,bgcolor:"grey.200","& .MuiLinearProgress-bar":{bgcolor:"primary.main",borderRadius:3}}}),g.length===0&&!k?e.jsxs(i,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"40vh",textAlign:"center",p:4},children:[e.jsx(b.div,{animate:{rotate:[0,10,0]},transition:{repeat:1/0,duration:2},children:e.jsx(v,{sx:{fontSize:80,color:"text.disabled",opacity:.7}})}),e.jsx(s,{variant:"h6",color:"textSecondary",gutterBottom:!0,sx:{mt:2},children:"Aucune formation trouvée"}),e.jsx(s,{variant:"body2",color:"textSecondary",children:f?`Aucun résultat pour "${f}"`:"Vous n'avez effectué aucune formation pour le moment"})]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{sx:{mb:2},children:te.map((o,a)=>e.jsx(pe,{direction:"up",in:!0,timeout:300,style:{transitionDelay:`${a*50}ms`},children:e.jsx(i,{sx:{mb:2},children:e.jsx(Me,{title:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(je,{sx:{fontSize:16}}),e.jsx("span",{children:"Consulter les archives de cette formation"})]}),placement:"top",arrow:!0,enterDelay:500,leaveDelay:200,children:e.jsx(Y,{sx:{borderRadius:3,boxShadow:2,transition:"all 0.3s",background:"linear-gradient(to right, #ffffff, #f8fbff)","&:hover":{boxShadow:4,transform:"translateY(-3px)",cursor:"pointer"}},children:e.jsxs(ve,{button:!0,onClick:()=>X(o),sx:{py:2},children:[e.jsx(xe,{sx:{minWidth:40},children:e.jsx(ue,{color:"success",overlap:"circular",badgeContent:a+1,children:e.jsx(P,{sx:{bgcolor:"primary.light"},children:e.jsx(B,{})})})}),e.jsx(fe,{primary:e.jsx(s,{variant:"subtitle1",fontWeight:"medium",children:o.INTITULE}),secondary:e.jsx(s,{variant:"body2",color:"text.secondary",children:new Date(o.DATE).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})}),sx:{flexGrow:1}}),e.jsxs(i,{sx:{display:"flex",gap:1},children:[e.jsx(R,{title:o.FICHIERCONVOCATION?"Convocation téléversée":"Téléverser convocation",children:e.jsx(Q,{label:"Convocation",icon:o.FICHIERCONVOCATION?e.jsx(V,{fontSize:"small"}):e.jsx(j,{fontSize:"small"}),color:o.FICHIERCONVOCATION?"success":"default",variant:"outlined",onClick:t=>{t.stopPropagation(),document.getElementById(`convocation-${o.IDFORMATIONM}`).click()},sx:{cursor:"pointer"}})}),e.jsx(R,{title:o.FICHIERRAPPORTFORMATION?"Rapport téléversé":"Téléverser rapport",children:e.jsx(Q,{label:"Rapport",icon:o.FICHIERRAPPORTFORMATION?e.jsx(V,{fontSize:"small"}):e.jsx(j,{fontSize:"small"}),color:o.FICHIERRAPPORTFORMATION?"success":"default",variant:"outlined",onClick:t=>{t.stopPropagation(),document.getElementById(`rapport-${o.IDFORMATIONM}`).click()},sx:{cursor:"pointer"}})})]}),e.jsx("input",{id:`convocation-${o.IDFORMATIONM}`,type:"file",accept:".pdf,.doc,.docx",onChange:t=>H(t,"convocation",o.IDFORMATIONM),style:{display:"none"}}),e.jsx("input",{id:`rapport-${o.IDFORMATIONM}`,type:"file",accept:".pdf,.doc,.docx",onChange:t=>H(t,"rapport",o.IDFORMATIONM),style:{display:"none"}})]})})})})},o.IDFORMATIONM))}),g.length>m&&e.jsx(Ce,{count:Math.ceil(g.length/m),page:z,onChange:(o,a)=>K(a),color:"primary",shape:"rounded",sx:{display:"flex",justifyContent:"center",mt:3,"& .MuiPaginationItem-root":{borderRadius:10}}})]})]})}),e.jsxs(we,{open:r,onClose:O,maxWidth:"xl",fullWidth:!0,TransitionComponent:he,transitionDuration:300,children:[e.jsxs(ye,{sx:{bgcolor:"#f8f9fa",color:"#4a5568",fontWeight:"bold",fontSize:"1.25rem",display:"flex",justifyContent:"space-between",alignItems:"center",py:2,borderBottom:"1px solid #e2e8f0"},children:[e.jsxs(i,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(B,{sx:{fontSize:28,color:"#718096"}}),e.jsx(s,{variant:"h6",sx:{fontWeight:600,color:"#2d3748"},children:l?.INTITULE})]}),e.jsx(me,{onClick:O,sx:{color:"#718096","&:hover":{backgroundColor:"#edf2f7"}},children:e.jsx(Oe,{})})]}),e.jsxs(ge,{value:d,onChange:(o,a)=>M(a),variant:"fullWidth",sx:{bgcolor:"#f8f9fa",borderBottom:"1px solid #e2e8f0","& .MuiTabs-indicator":{height:3,backgroundColor:"#4299e1"}},children:[e.jsx(L,{label:e.jsxs(i,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Ae,{sx:{color:d===0?"#4299e1":"#a0aec0"}}),e.jsx(s,{fontWeight:"medium",sx:{color:d===0?"#2d3748":"#718096"},children:"Convocation"})]}),sx:{py:2,minHeight:"auto"}}),e.jsx(L,{label:e.jsxs(i,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(v,{sx:{color:d===1?"#4299e1":"#a0aec0"}}),e.jsx(s,{fontWeight:"medium",sx:{color:d===1?"#2d3748":"#718096"},children:"Rapport"})]}),sx:{py:2,minHeight:"auto"}})]}),e.jsx(Te,{sx:{p:0,bgcolor:"#ffffff",display:"flex",flexDirection:"column",overflow:"hidden",position:"relative"},children:e.jsx(i,{sx:{p:3,flex:1,overflow:"auto",height:"100%"},children:d===0?l?.FICHIERCONVOCATION?e.jsxs(i,{sx:{height:"500vh",display:"flex",flexDirection:"column",border:"1px solid #e2e8f0",borderRadius:"8px"},children:[e.jsx(i,{sx:{flex:1,overflow:"hidden",bgcolor:"#f8f9fa",p:1},children:e.jsx("iframe",{src:l.FICHIERCONVOCATION,style:{width:"100%",height:"100%",minHeight:"500px",border:"none",backgroundColor:"#ffffff"},title:"Fiche de Convocation",scrolling:"no"})}),e.jsx(x,{variant:"outlined",startIcon:e.jsx($,{}),onClick:()=>window.open(l.FICHIERCONVOCATION,"_blank"),sx:{position:"absolute",bottom:16,right:56,borderRadius:"4px",color:"#4a5568",borderColor:"#cbd5e0",backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(4px)",zIndex:10,"&:hover":{borderColor:"#a0aec0",backgroundColor:"rgba(255, 255, 255, 1)"}},children:"Agrandir"})]}):e.jsxs(U,{children:[e.jsx(b.div,{animate:{y:[0,-5,0]},transition:{repeat:1/0,duration:3},children:e.jsx(v,{sx:{fontSize:60,color:"#cbd5e0",mb:2}})}),e.jsx(s,{variant:"h6",color:"#718096",gutterBottom:!0,children:"Aucun fichier de convocation disponible"}),e.jsx(s,{variant:"body2",color:"#a0aec0",sx:{mb:3},children:"Téléversez un fichier pour le visualiser ici"}),e.jsx(x,{variant:"outlined",startIcon:h&&D==="convocation"?e.jsx(W,{size:20,color:"inherit"}):e.jsx(j,{}),onClick:()=>document.getElementById(`convocation-${l?.IDFORMATIONM}`).click(),disabled:h,sx:{borderRadius:"4px",color:"#4a5568",borderColor:"#cbd5e0","&:hover":{borderColor:"#a0aec0",backgroundColor:"#edf2f7"}},children:"Téléverser un fichier"})]}):l?.FICHIERRAPPORTFORMATION?e.jsxs(i,{sx:{height:"100%",display:"flex",flexDirection:"column",border:"1px solid #e2e8f0",borderRadius:"8px",overflow:"hidden",position:"relative"},children:[e.jsx(i,{sx:{flex:1,overflow:"hidden",bgcolor:"#f8f9fa",p:1},children:e.jsx("iframe",{src:l.FICHIERRAPPORTFORMATION,style:{width:"100%",height:"100%",minHeight:"500px",border:"none",backgroundColor:"#ffffff"},title:"Rapport de Formation",scrolling:"no"})}),e.jsx(x,{variant:"outlined",startIcon:e.jsx($,{}),onClick:()=>window.open(l.FICHIERRAPPORTFORMATION,"_blank"),sx:{position:"absolute",top:16,right:16,borderRadius:"4px",color:"#4a5568",borderColor:"#cbd5e0",backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(4px)",zIndex:10,"&:hover":{borderColor:"#a0aec0",backgroundColor:"rgba(255, 255, 255, 1)"}},children:"Agrandir"})]}):e.jsxs(U,{children:[e.jsx(b.div,{animate:{y:[0,-5,0]},transition:{repeat:1/0,duration:3},children:e.jsx(v,{sx:{fontSize:60,color:"#cbd5e0",mb:2}})}),e.jsx(s,{variant:"h6",color:"#718096",gutterBottom:!0,children:"Aucun rapport de formation disponible"}),e.jsx(s,{variant:"body2",color:"#a0aec0",sx:{mb:3},children:"Téléversez un fichier pour le visualiser ici"}),e.jsx(x,{variant:"outlined",startIcon:h&&D==="rapport"?e.jsx(W,{size:20,color:"inherit"}):e.jsx(j,{}),onClick:()=>document.getElementById(`rapport-${l?.IDFORMATIONM}`).click(),disabled:h,sx:{borderRadius:"4px",color:"#4a5568",borderColor:"#cbd5e0","&:hover":{borderColor:"#a0aec0",backgroundColor:"#edf2f7"}},children:"Téléverser un fichier"})]})})}),e.jsx(Fe,{sx:{bgcolor:"#f8f9fa",p:2,borderTop:"1px solid #e2e8f0"},children:e.jsx(x,{onClick:O,variant:"text",sx:{color:"#718096","&:hover":{backgroundColor:"transparent",color:"#4a5568"}},children:"Fermer"})})]})]})};export{ro as default};
